<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>MitosEHR: phpthumb_filters Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="logo_medium.png"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">MitosEHR
   &#160;<span id="projectnumber">Vega v1.0</span>
   </div>
   <div id="projectbrief">Electronic Health Record</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="classes.html"><span>Data&#160;Structure&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Data&#160;Fields</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('classphpthumb__filters.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Data Fields</a>  </div>
  <div class="headertitle">
<div class="title">phpthumb_filters Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="phpthumb_filters" --><table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphpthumb__filters.html#afe54edab829027ca0b158c96bdd83ef1">phpthumb_filters</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphpthumb__filters.html#a1d26d503a63b41fe2f6d6c6c22c2f977">ApplyMask</a> (&amp;$gdimg_mask, &amp;$gdimg_image)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphpthumb__filters.html#a868bce98d95b20ca5980df7009b2e97a">Bevel</a> (&amp;$gdimg, $width, $hexcolor1, $hexcolor2)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphpthumb__filters.html#aaf1d4082bd342e968fb30be03eec2b0c">Blur</a> (&amp;$gdimg, $radius=0.5)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphpthumb__filters.html#affaf729b5b0bf97eb74d20afe296f93b">BlurGaussian</a> (&amp;$gdimg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphpthumb__filters.html#aacd477f983de3a272356a0982a7aa32b">BlurSelective</a> (&amp;$gdimg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphpthumb__filters.html#a4c5e389a0bf845cbde9c9a2b68235350">Brightness</a> (&amp;$gdimg, $amount=0)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphpthumb__filters.html#ab363c0f8552a6dfdd679cb0ce80d36c0">Contrast</a> (&amp;$gdimg, $amount=0)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphpthumb__filters.html#a0fd131013d15acb0563517913421f06e">Colorize</a> (&amp;$gdimg, $amount, $targetColor)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphpthumb__filters.html#a30486e42d7dc5476cc4c8780827f35e5">Crop</a> (&amp;$gdimg, $left=0, $right=0, $top=0, $bottom=0)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphpthumb__filters.html#ad3b8f01262de4fbbcfd011e3e5beeb6b">Desaturate</a> (&amp;$gdimg, $amount, $color='')</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphpthumb__filters.html#af3f3dbf7cf23ec5a82650733f7aa1a35">DropShadow</a> (&amp;$gdimg, $distance, $width, $hexcolor, $angle, $fade)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphpthumb__filters.html#af13f740be9d44366c26925374e90b8b9">EdgeDetect</a> (&amp;$gdimg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphpthumb__filters.html#abd40d19047d10673ea2670ce5ae69f6c">Elipse</a> ($gdimg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphpthumb__filters.html#af56f3a0df7361a69fc4b006f9a0e2f98">Emboss</a> (&amp;$gdimg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphpthumb__filters.html#a9361be25a234723bef65039b7d7bb4da">Flip</a> (&amp;$gdimg, $x=false, $y=false)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphpthumb__filters.html#a61bd8c7eadd58f7eff3cfaf5888ce18d">Frame</a> (&amp;$gdimg, $frame_width, $edge_width, $hexcolor_frame, $hexcolor1, $hexcolor2)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphpthumb__filters.html#a8f8fb8f6b7b2aa1ccb9012de29322c89">Gamma</a> (&amp;$gdimg, $amount)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphpthumb__filters.html#ac964ed4e79cc312837da27572426e6b6">Grayscale</a> (&amp;$gdimg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphpthumb__filters.html#ada0752b5c2e587088c61e8c18ba21514">HistogramAnalysis</a> (&amp;$gdimg, $calculateGray=false)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphpthumb__filters.html#ad49d6352f0a22c3c875fd0c59480ce7f">HistogramStretch</a> (&amp;$gdimg, $band='*', $method=0, $threshold=0.1)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphpthumb__filters.html#a6419068818fbc8d1a371b6c169faa134">HistogramOverlay</a> (&amp;$gdimg, $bands='*', $colors='', $width=0.25, $height=0.25, $alignment='BR', $opacity=50, $margin_x=5, $margin_y=null)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphpthumb__filters.html#adc2f01e3ad3f01f0204da6f10bad427c">ImageBorder</a> (&amp;$gdimg, $border_width, $radius_x, $radius_y, $hexcolor_border)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphpthumb__filters.html#aa3a158b5772eeb4fb28f13973a9e82f5">ImprovedImageRotate</a> (&amp;$gdimg_source, $rotate_angle=0, $config_background_hexcolor='FFFFFF', $bg=null)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphpthumb__filters.html#aaf6375de63265e2d032d90ef2d7771df">MeanRemoval</a> (&amp;$gdimg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphpthumb__filters.html#a62cc8b7f2263af3eeefd434659c84ff8">Negative</a> (&amp;$gdimg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphpthumb__filters.html#a8425970ef696ae1c8e420cc7718e7c9f">RoundedImageCorners</a> (&amp;$gdimg, $radius_x, $radius_y)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphpthumb__filters.html#a861290ddb5fcd73734a327fbd883fa9d">Saturation</a> (&amp;$gdimg, $amount, $color='')</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphpthumb__filters.html#aebd2067d17409638a17de18089628f6d">Sepia</a> (&amp;$gdimg, $amount, $targetColor)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphpthumb__filters.html#a7b9388a8ff19eb5a2b441aba78fabf57">Smooth</a> (&amp;$gdimg, $amount=6)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphpthumb__filters.html#ad4c44b13cfa064b7b1adcc14db883745">SourceTransparentColorMask</a> (&amp;$gdimg, $hexcolor, $min_limit=5, $max_limit=10)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphpthumb__filters.html#ae3154ed46062f29561e7be86f2559b1c">Threshold</a> (&amp;$gdimg, $cutoff)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphpthumb__filters.html#a64db4cefe2b067a8d7b684356b6c7c14">ImageTrueColorToPalette2</a> (&amp;$image, $dither, $ncolors)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphpthumb__filters.html#a6a911baba07ff5d63b8f1c6718e0ed28">ReduceColorDepth</a> (&amp;$gdimg, $colors=256, $dither=true)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphpthumb__filters.html#a825ce270b0defc94f2ccb5baa07e7303">WhiteBalance</a> (&amp;$gdimg, $targetColor='')</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphpthumb__filters.html#aa7c3c6393587a04c965fca12a81163c6">WatermarkText</a> (&amp;$gdimg, $text, $size, $alignment, $hex_color='000000', $ttffont='', $opacity=100, $margin=5, $angle=0, $bg_color=false, $bg_opacity=0, $fillextend='')</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphpthumb__filters.html#a31079a470f5697b85aad5855f5c614fc">WatermarkOverlay</a> (&amp;$gdimg_dest, &amp;$img_watermark, $alignment='*', $opacity=50, $margin_x=5, $margin_y=null)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a> ($message, $file='', $line='')</td></tr>
<tr><td colspan="2"><h2><a name="pub-attribs"></a>
Data Fields</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphpthumb__filters.html#ac10166ea697629d5f86fe09b118abd03">$phpThumbObject</a> = null</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>phpThumb() by James Heinrich &lt;<a href="mailto:info@silisoftware.com">info@silisoftware.com</a>&gt; // </p>

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l00011">11</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>
</div><hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a1d26d503a63b41fe2f6d6c6c22c2f977"></a><!-- doxytag: member="phpthumb_filters::ApplyMask" ref="a1d26d503a63b41fe2f6d6c6c22c2f977" args="(&amp;$gdimg_mask, &amp;$gdimg_image)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphpthumb__filters.html#a1d26d503a63b41fe2f6d6c6c22c2f977">ApplyMask</a> </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>gdimg_mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>gdimg_image</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l00019">19</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>
<div class="fragment"><pre class="fragment">                                                        {
                <span class="keywordflow">if</span> (<a class="code" href="classphpthumb__functions.html#aaaad487d4c5a61befc88ae061f8a64fe">phpthumb_functions::gd_version</a>() &lt; 2) {
                        $this-&gt;<a class="code" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a>(<span class="stringliteral">&#39;Skipping ApplyMask() because gd_version is &quot;&#39;</span>.<a class="code" href="classphpthumb__functions.html#aaaad487d4c5a61befc88ae061f8a64fe">phpthumb_functions::gd_version</a>().<span class="charliteral">&#39;&quot;&#39;</span>, __FILE__, __LINE__);
                        <span class="keywordflow">return</span> <span class="keyword">false</span>;
                }
                <span class="keywordflow">if</span> (<a class="code" href="classphpthumb__functions.html#af53f41b3482e6bed2082daa0ebfd96c0">phpthumb_functions::version_compare_replacement</a>(phpversion(), <span class="stringliteral">&#39;4.3.2&#39;</span>, <span class="stringliteral">&#39;&gt;=&#39;</span>)) {

                        $this-&gt;<a class="code" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a>(<span class="stringliteral">&#39;Using alpha ApplyMask() technique&#39;</span>, __FILE__, __LINE__);
                        <span class="keywordflow">if</span> ($gdimg_mask_resized = <a class="code" href="classphpthumb__functions.html#a02caac9e703a9c106e3fea3a6215130d">phpthumb_functions::ImageCreateFunction</a>(ImageSX($gdimg_image), ImageSY($gdimg_image))) {

                                ImageCopyResampled($gdimg_mask_resized, $gdimg_mask, 0, 0, 0, 0, ImageSX($gdimg_image), ImageSY($gdimg_image), ImageSX($gdimg_mask), ImageSY($gdimg_mask));
                                <span class="keywordflow">if</span> ($gdimg_mask_blendtemp = <a class="code" href="classphpthumb__functions.html#a02caac9e703a9c106e3fea3a6215130d">phpthumb_functions::ImageCreateFunction</a>(ImageSX($gdimg_image), ImageSY($gdimg_image))) {

                                        $color_background = ImageColorAllocate($gdimg_mask_blendtemp, 0, 0, 0);
                                        ImageFilledRectangle($gdimg_mask_blendtemp, 0, 0, ImageSX($gdimg_mask_blendtemp), ImageSY($gdimg_mask_blendtemp), $color_background);
                                        ImageAlphaBlending($gdimg_mask_blendtemp, <span class="keyword">false</span>);
                                        ImageSaveAlpha($gdimg_mask_blendtemp, <span class="keyword">true</span>);
                                        <span class="keywordflow">for</span> ($x = 0; $x &lt; ImageSX($gdimg_image); $x++) {
                                                <span class="keywordflow">for</span> ($y = 0; $y &lt; ImageSY($gdimg_image); $y++) {
                                                        <span class="comment">//$RealPixel = phpthumb_functions::GetPixelColor($gdimg_mask_blendtemp, $x, $y);</span>
                                                        $RealPixel = <a class="code" href="classphpthumb__functions.html#ac73caf77553f599f9bdb88c03281b33b">phpthumb_functions::GetPixelColor</a>($gdimg_image, $x, $y);
                                                        $MaskPixel = <a class="code" href="classphpthumb__functions.html#a5f3d1f38c5a6c3a5b83a8f96042ffef5">phpthumb_functions::GrayscalePixel</a>(<a class="code" href="classphpthumb__functions.html#ac73caf77553f599f9bdb88c03281b33b">phpthumb_functions::GetPixelColor</a>($gdimg_mask_resized, $x, $y));
                                                        $MaskAlpha = 127 - (floor($MaskPixel[<span class="stringliteral">&#39;red&#39;</span>] / 2) * (1 - ($RealPixel[<span class="stringliteral">&#39;alpha&#39;</span>] / 127)));
                                                        $newcolor = <a class="code" href="classphpthumb__functions.html#ab43fe1af0d0c46288c2ffcf3905a7b42">phpthumb_functions::ImageColorAllocateAlphaSafe</a>($gdimg_mask_blendtemp, $RealPixel[<span class="stringliteral">&#39;red&#39;</span>], $RealPixel[<span class="stringliteral">&#39;green&#39;</span>], $RealPixel[<span class="stringliteral">&#39;blue&#39;</span>], $MaskAlpha);
                                                        ImageSetPixel($gdimg_mask_blendtemp, $x, $y, $newcolor);
                                                }
                                        }
                                        ImageAlphaBlending($gdimg_image, <span class="keyword">false</span>);
                                        ImageSaveAlpha($gdimg_image, <span class="keyword">true</span>);
                                        ImageCopy($gdimg_image, $gdimg_mask_blendtemp, 0, 0, 0, 0, ImageSX($gdimg_mask_blendtemp), ImageSY($gdimg_mask_blendtemp));
                                        ImageDestroy($gdimg_mask_blendtemp);

                                } <span class="keywordflow">else</span> {
                                        $this-&gt;<a class="code" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a>(<span class="stringliteral">&#39;ImageCreateFunction() failed&#39;</span>, __FILE__, __LINE__);
                                }
                                ImageDestroy($gdimg_mask_resized);

                        } <span class="keywordflow">else</span> {
                                $this-&gt;<a class="code" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a>(<span class="stringliteral">&#39;ImageCreateFunction() failed&#39;</span>, __FILE__, __LINE__);
                        }

                } <span class="keywordflow">else</span> {
                        <span class="comment">// alpha merging requires PHP v4.3.2+</span>
                        $this-&gt;<a class="code" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a>(<span class="stringliteral">&#39;Skipping ApplyMask() technique because PHP is v&quot;&#39;</span>.phpversion().<span class="charliteral">&#39;&quot;&#39;</span>, __FILE__, __LINE__);
                }
                <span class="keywordflow">return</span> <span class="keyword">true</span>;
        }
</pre></div>
</div>
</div>
<a class="anchor" id="a868bce98d95b20ca5980df7009b2e97a"></a><!-- doxytag: member="phpthumb_filters::Bevel" ref="a868bce98d95b20ca5980df7009b2e97a" args="(&amp;$gdimg, $width, $hexcolor1, $hexcolor2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphpthumb__filters.html#a868bce98d95b20ca5980df7009b2e97a">Bevel</a> </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>gdimg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>hexcolor1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>hexcolor2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l00068">68</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>
<div class="fragment"><pre class="fragment">                                                            {
        $width     = ($width     ? $width     : 5);
        $hexcolor1 = ($hexcolor1 ? $hexcolor1 : <span class="stringliteral">&#39;FFFFFF&#39;</span>);
        $hexcolor2 = ($hexcolor2 ? $hexcolor2 : <span class="stringliteral">&#39;000000&#39;</span>);

        ImageAlphaBlending($gdimg, <span class="keyword">true</span>);
        <span class="keywordflow">for</span> ($i = 0; $i &lt; $width; $i++) {
            $alpha = round(($i / $width) * 127);
            $color1 = <a class="code" href="classphpthumb__functions.html#a9a63d0b70df4136de64ab0cd351e7ff3">phpthumb_functions::ImageHexColorAllocate</a>($gdimg, $hexcolor1, <span class="keyword">false</span>, $alpha);
            $color2 = <a class="code" href="classphpthumb__functions.html#a9a63d0b70df4136de64ab0cd351e7ff3">phpthumb_functions::ImageHexColorAllocate</a>($gdimg, $hexcolor2, <span class="keyword">false</span>, $alpha);

            ImageLine($gdimg,                   $i,                   $i + 1,                   $i, ImageSY($gdimg) - $i - 1, $color1); <span class="comment">// left</span>
            ImageLine($gdimg,                   $i,                   $i    , ImageSX($gdimg) - $i,                   $i    , $color1); <span class="comment">// top</span>
            ImageLine($gdimg, ImageSX($gdimg) - $i, ImageSY($gdimg) - $i - 1, ImageSX($gdimg) - $i,                   $i + 1, $color2); <span class="comment">// right</span>
            ImageLine($gdimg, ImageSX($gdimg) - $i, ImageSY($gdimg) - $i    ,                   $i, ImageSY($gdimg) - $i    , $color2); <span class="comment">// bottom</span>
        }
        <span class="keywordflow">return</span> <span class="keyword">true</span>;
    }
</pre></div>
</div>
</div>
<a class="anchor" id="aaf1d4082bd342e968fb30be03eec2b0c"></a><!-- doxytag: member="phpthumb_filters::Blur" ref="aaf1d4082bd342e968fb30be03eec2b0c" args="(&amp;$gdimg, $radius=0.5)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphpthumb__filters.html#aaf1d4082bd342e968fb30be03eec2b0c">Blur</a> </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>gdimg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>radius</em> = <code>0.5</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l00088">88</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>
<div class="fragment"><pre class="fragment">                                            {
                <span class="comment">// Taken from Torstein Hønsi&#39;s phpUnsharpMask (see phpthumb.unsharp.php)</span>

                $radius = round(max(0, min($radius, 50)) * 2);
                <span class="keywordflow">if</span> (!$radius) {
                        <span class="keywordflow">return</span> <span class="keyword">false</span>;
                }

                $w = ImageSX($gdimg);
                $h = ImageSY($gdimg);
                <span class="keywordflow">if</span> ($imgBlur = ImageCreateTrueColor($w, $h)) {
                        <span class="comment">// Gaussian blur matrix:</span>
                        <span class="comment">//      1       2       1</span>
                        <span class="comment">//      2       4       2</span>
                        <span class="comment">//      1       2       1</span>

                        <span class="comment">// Move copies of the image around one pixel at the time and merge them with weight</span>
                        <span class="comment">// according to the matrix. The same matrix is simply repeated for higher radii.</span>
                        <span class="keywordflow">for</span> ($i = 0; $i &lt; $radius; $i++)        {
                                ImageCopy     ($imgBlur, $gdimg, 0, 0, 1, 1, $w - 1, $h - 1);            <span class="comment">// up left</span>
                                ImageCopyMerge($imgBlur, $gdimg, 1, 1, 0, 0, $w,     $h,     50.00000);  <span class="comment">// down right</span>
                                ImageCopyMerge($imgBlur, $gdimg, 0, 1, 1, 0, $w - 1, $h,     33.33333);  <span class="comment">// down left</span>
                                ImageCopyMerge($imgBlur, $gdimg, 1, 0, 0, 1, $w,     $h - 1, 25.00000);  <span class="comment">// up right</span>
                                ImageCopyMerge($imgBlur, $gdimg, 0, 0, 1, 0, $w - 1, $h,     33.33333);  <span class="comment">// left</span>
                                ImageCopyMerge($imgBlur, $gdimg, 1, 0, 0, 0, $w,     $h,     25.00000);  <span class="comment">// right</span>
                                ImageCopyMerge($imgBlur, $gdimg, 0, 0, 0, 1, $w,     $h - 1, 20.00000);  <span class="comment">// up</span>
                                ImageCopyMerge($imgBlur, $gdimg, 0, 1, 0, 0, $w,     $h,     16.666667); <span class="comment">// down</span>
                                ImageCopyMerge($imgBlur, $gdimg, 0, 0, 0, 0, $w,     $h,     50.000000); <span class="comment">// center</span>
                                ImageCopy     ($gdimg, $imgBlur, 0, 0, 0, 0, $w,     $h);
                        }
                        <span class="keywordflow">return</span> <span class="keyword">true</span>;
                }
                <span class="keywordflow">return</span> <span class="keyword">false</span>;
        }
</pre></div>
</div>
</div>
<a class="anchor" id="affaf729b5b0bf97eb74d20afe296f93b"></a><!-- doxytag: member="phpthumb_filters::BlurGaussian" ref="affaf729b5b0bf97eb74d20afe296f93b" args="(&amp;$gdimg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphpthumb__filters.html#affaf729b5b0bf97eb74d20afe296f93b">BlurGaussian</a> </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>gdimg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l00124">124</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>
<div class="fragment"><pre class="fragment">                                       {
                <span class="keywordflow">if</span> (<a class="code" href="classphpthumb__functions.html#af53f41b3482e6bed2082daa0ebfd96c0">phpthumb_functions::version_compare_replacement</a>(phpversion(), <span class="stringliteral">&#39;5.0.0&#39;</span>, <span class="stringliteral">&#39;&gt;=&#39;</span>) &amp;&amp; <a class="code" href="classphpthumb__functions.html#adfd72c199df2f74f6daeda7c06a18cae">phpthumb_functions::gd_is_bundled</a>()) {
                        <span class="keywordflow">if</span> (ImageFilter($gdimg, IMG_FILTER_GAUSSIAN_BLUR)) {
                                <span class="keywordflow">return</span> <span class="keyword">true</span>;
                        }
                        $this-&gt;<a class="code" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a>(<span class="stringliteral">&#39;FAILED: ImageFilter($gdimg, IMG_FILTER_GAUSSIAN_BLUR)&#39;</span>, __FILE__, __LINE__);
                        <span class="comment">// fall through and try it the hard way</span>
                }
                $this-&gt;<a class="code" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a>(<span class="stringliteral">&#39;FAILED: phpthumb_filters::BlurGaussian($gdimg) [using phpthumb_filters::Blur() instead]&#39;</span>, __FILE__, __LINE__);
                <span class="keywordflow">return</span> <a class="code" href="classphpthumb__filters.html#aaf1d4082bd342e968fb30be03eec2b0c">phpthumb_filters::Blur</a>($gdimg, 0.5);
        }
</pre></div>
</div>
</div>
<a class="anchor" id="aacd477f983de3a272356a0982a7aa32b"></a><!-- doxytag: member="phpthumb_filters::BlurSelective" ref="aacd477f983de3a272356a0982a7aa32b" args="(&amp;$gdimg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphpthumb__filters.html#aacd477f983de3a272356a0982a7aa32b">BlurSelective</a> </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>gdimg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l00137">137</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>
<div class="fragment"><pre class="fragment">                                        {
                <span class="keywordflow">if</span> (<a class="code" href="classphpthumb__functions.html#af53f41b3482e6bed2082daa0ebfd96c0">phpthumb_functions::version_compare_replacement</a>(phpversion(), <span class="stringliteral">&#39;5.0.0&#39;</span>, <span class="stringliteral">&#39;&gt;=&#39;</span>) &amp;&amp; <a class="code" href="classphpthumb__functions.html#adfd72c199df2f74f6daeda7c06a18cae">phpthumb_functions::gd_is_bundled</a>()) {
                        <span class="keywordflow">if</span> (ImageFilter($gdimg, IMG_FILTER_SELECTIVE_BLUR)) {
                                <span class="keywordflow">return</span> <span class="keyword">true</span>;
                        }
                        $this-&gt;<a class="code" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a>(<span class="stringliteral">&#39;FAILED: ImageFilter($gdimg, IMG_FILTER_SELECTIVE_BLUR)&#39;</span>, __FILE__, __LINE__);
                        <span class="comment">// fall through and try it the hard way</span>
                }
                <span class="comment">// currently not implemented &quot;the hard way&quot;</span>
                $this-&gt;<a class="code" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a>(<span class="stringliteral">&#39;FAILED: phpthumb_filters::BlurSelective($gdimg) [function not implemented]&#39;</span>, __FILE__, __LINE__);
                <span class="keywordflow">return</span> <span class="keyword">false</span>;
        }
</pre></div>
</div>
</div>
<a class="anchor" id="a4c5e389a0bf845cbde9c9a2b68235350"></a><!-- doxytag: member="phpthumb_filters::Brightness" ref="a4c5e389a0bf845cbde9c9a2b68235350" args="(&amp;$gdimg, $amount=0)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphpthumb__filters.html#a4c5e389a0bf845cbde9c9a2b68235350">Brightness</a> </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>gdimg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>amount</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l00151">151</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>
<div class="fragment"><pre class="fragment">                                                {
                <span class="keywordflow">if</span> ($amount == 0) {
                        <span class="keywordflow">return</span> <span class="keyword">true</span>;
                }
                $amount = max(-255, min(255, $amount));

                <span class="keywordflow">if</span> (<a class="code" href="classphpthumb__functions.html#af53f41b3482e6bed2082daa0ebfd96c0">phpthumb_functions::version_compare_replacement</a>(phpversion(), <span class="stringliteral">&#39;5.0.0&#39;</span>, <span class="stringliteral">&#39;&gt;=&#39;</span>) &amp;&amp; <a class="code" href="classphpthumb__functions.html#adfd72c199df2f74f6daeda7c06a18cae">phpthumb_functions::gd_is_bundled</a>()) {
                        <span class="keywordflow">if</span> (ImageFilter($gdimg, IMG_FILTER_BRIGHTNESS, $amount)) {
                                <span class="keywordflow">return</span> <span class="keyword">true</span>;
                        }
                        $this-&gt;<a class="code" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a>(<span class="stringliteral">&#39;FAILED: ImageFilter($gdimg, IMG_FILTER_BRIGHTNESS, &#39;</span>.$amount.<span class="charliteral">&#39;)&#39;</span>, __FILE__, __LINE__);
                        <span class="comment">// fall through and try it the hard way</span>
                }

                $scaling = (255 - abs($amount)) / 255;
                $baseamount = (($amount &gt; 0) ? $amount : 0);
                <span class="keywordflow">for</span> ($x = 0; $x &lt; ImageSX($gdimg); $x++) {
                        <span class="keywordflow">for</span> ($y = 0; $y &lt; ImageSY($gdimg); $y++) {
                                $OriginalPixel = <a class="code" href="classphpthumb__functions.html#ac73caf77553f599f9bdb88c03281b33b">phpthumb_functions::GetPixelColor</a>($gdimg, $x, $y);
                                <span class="keywordflow">foreach</span> ($OriginalPixel as $key =&gt; $value) {
                                        $NewPixel[$key] = round($baseamount + ($OriginalPixel[$key] * $scaling));
                                }
                                $newColor = ImageColorAllocate($gdimg, $NewPixel[<span class="stringliteral">&#39;red&#39;</span>], $NewPixel[<span class="stringliteral">&#39;green&#39;</span>], $NewPixel[<span class="stringliteral">&#39;blue&#39;</span>]);
                                ImageSetPixel($gdimg, $x, $y, $newColor);
                        }
                }
                <span class="keywordflow">return</span> <span class="keyword">true</span>;
        }
</pre></div>
</div>
</div>
<a class="anchor" id="a0fd131013d15acb0563517913421f06e"></a><!-- doxytag: member="phpthumb_filters::Colorize" ref="a0fd131013d15acb0563517913421f06e" args="(&amp;$gdimg, $amount, $targetColor)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphpthumb__filters.html#a0fd131013d15acb0563517913421f06e">Colorize</a> </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>gdimg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>amount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>targetColor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l00215">215</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>
<div class="fragment"><pre class="fragment">                                                          {
                $amount      = (is_numeric($amount)                          ? $amount      : 25);
                $amountPct   = $amount / 100;
                $targetColor = (<a class="code" href="classphpthumb__functions.html#aa88047663adfed917d5fb0bece3913b8">phpthumb_functions::IsHexColor</a>($targetColor) ? $targetColor : <span class="stringliteral">&#39;gray&#39;</span>);

                <span class="keywordflow">if</span> ($amount == 0) {
                        <span class="keywordflow">return</span> <span class="keyword">true</span>;
                }

                <span class="keywordflow">if</span> (<a class="code" href="classphpthumb__functions.html#af53f41b3482e6bed2082daa0ebfd96c0">phpthumb_functions::version_compare_replacement</a>(phpversion(), <span class="stringliteral">&#39;5.0.0&#39;</span>, <span class="stringliteral">&#39;&gt;=&#39;</span>) &amp;&amp; <a class="code" href="classphpthumb__functions.html#adfd72c199df2f74f6daeda7c06a18cae">phpthumb_functions::gd_is_bundled</a>()) {
                        <span class="keywordflow">if</span> ($targetColor == <span class="stringliteral">&#39;gray&#39;</span>) {
                                $targetColor = <span class="stringliteral">&#39;808080&#39;</span>;
                        }
                        $r = round($amountPct * hexdec(substr($targetColor, 0, 2)));
                        $g = round($amountPct * hexdec(substr($targetColor, 2, 2)));
                        $b = round($amountPct * hexdec(substr($targetColor, 4, 2)));
                        <span class="keywordflow">if</span> (ImageFilter($gdimg, IMG_FILTER_COLORIZE, $r, $g, $b)) {
                                <span class="keywordflow">return</span> <span class="keyword">true</span>;
                        }
                        $this-&gt;<a class="code" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a>(<span class="stringliteral">&#39;FAILED: ImageFilter($gdimg, IMG_FILTER_COLORIZE)&#39;</span>, __FILE__, __LINE__);
                        <span class="comment">// fall through and try it the hard way</span>
                }

                <span class="comment">// overridden below for grayscale</span>
                <span class="keywordflow">if</span> ($targetColor != <span class="stringliteral">&#39;gray&#39;</span>) {
                        $TargetPixel[<span class="stringliteral">&#39;red&#39;</span>]   = hexdec(substr($targetColor, 0, 2));
                        $TargetPixel[<span class="stringliteral">&#39;green&#39;</span>] = hexdec(substr($targetColor, 2, 2));
                        $TargetPixel[<span class="stringliteral">&#39;blue&#39;</span>]  = hexdec(substr($targetColor, 4, 2));
                }

                <span class="keywordflow">for</span> ($x = 0; $x &lt; ImageSX($gdimg); $x++) {
                        <span class="keywordflow">for</span> ($y = 0; $y &lt; ImageSY($gdimg); $y++) {
                                $OriginalPixel = <a class="code" href="classphpthumb__functions.html#ac73caf77553f599f9bdb88c03281b33b">phpthumb_functions::GetPixelColor</a>($gdimg, $x, $y);
                                <span class="keywordflow">if</span> ($targetColor == <span class="stringliteral">&#39;gray&#39;</span>) {
                                        $TargetPixel = <a class="code" href="classphpthumb__functions.html#a5f3d1f38c5a6c3a5b83a8f96042ffef5">phpthumb_functions::GrayscalePixel</a>($OriginalPixel);
                                }
                                <span class="keywordflow">foreach</span> ($TargetPixel as $key =&gt; $value) {
                                        $NewPixel[$key] = round(max(0, min(255, ($OriginalPixel[$key] * ((100 - $amount) / 100)) + ($TargetPixel[$key] * $amountPct))));
                                }
                                <span class="comment">//$newColor = phpthumb_functions::ImageColorAllocateAlphaSafe($gdimg, $NewPixel[&#39;red&#39;], $NewPixel[&#39;green&#39;], $NewPixel[&#39;blue&#39;], $OriginalPixel[&#39;alpha&#39;]);</span>
                                $newColor = ImageColorAllocate($gdimg, $NewPixel[<span class="stringliteral">&#39;red&#39;</span>], $NewPixel[<span class="stringliteral">&#39;green&#39;</span>], $NewPixel[<span class="stringliteral">&#39;blue&#39;</span>]);
                                ImageSetPixel($gdimg, $x, $y, $newColor);
                        }
                }
                <span class="keywordflow">return</span> <span class="keyword">true</span>;
        }
</pre></div>
</div>
</div>
<a class="anchor" id="ab363c0f8552a6dfdd679cb0ce80d36c0"></a><!-- doxytag: member="phpthumb_filters::Contrast" ref="ab363c0f8552a6dfdd679cb0ce80d36c0" args="(&amp;$gdimg, $amount=0)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphpthumb__filters.html#ab363c0f8552a6dfdd679cb0ce80d36c0">Contrast</a> </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>gdimg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>amount</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l00181">181</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>
<div class="fragment"><pre class="fragment">                                              {
                <span class="keywordflow">if</span> ($amount == 0) {
                        <span class="keywordflow">return</span> <span class="keyword">true</span>;
                }
                $amount = max(-255, min(255, $amount));

                <span class="keywordflow">if</span> (<a class="code" href="classphpthumb__functions.html#af53f41b3482e6bed2082daa0ebfd96c0">phpthumb_functions::version_compare_replacement</a>(phpversion(), <span class="stringliteral">&#39;5.0.0&#39;</span>, <span class="stringliteral">&#39;&gt;=&#39;</span>) &amp;&amp; <a class="code" href="classphpthumb__functions.html#adfd72c199df2f74f6daeda7c06a18cae">phpthumb_functions::gd_is_bundled</a>()) {
                        <span class="comment">// ImageFilter(IMG_FILTER_CONTRAST) has range +100 to -100 (positive numbers make it darker!)</span>
                        $amount = ($amount / 255) * -100;
                        <span class="keywordflow">if</span> (ImageFilter($gdimg, IMG_FILTER_CONTRAST, $amount)) {
                                <span class="keywordflow">return</span> <span class="keyword">true</span>;
                        }
                        $this-&gt;<a class="code" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a>(<span class="stringliteral">&#39;FAILED: ImageFilter($gdimg, IMG_FILTER_CONTRAST, &#39;</span>.$amount.<span class="charliteral">&#39;)&#39;</span>, __FILE__, __LINE__);
                        <span class="comment">// fall through and try it the hard way</span>
                }

                <span class="keywordflow">if</span> ($amount &gt; 0) {
                        $scaling = 1 + ($amount / 255);
                } <span class="keywordflow">else</span> {
                        $scaling = (255 - abs($amount)) / 255;
                }
                <span class="keywordflow">for</span> ($x = 0; $x &lt; ImageSX($gdimg); $x++) {
                        <span class="keywordflow">for</span> ($y = 0; $y &lt; ImageSY($gdimg); $y++) {
                                $OriginalPixel = <a class="code" href="classphpthumb__functions.html#ac73caf77553f599f9bdb88c03281b33b">phpthumb_functions::GetPixelColor</a>($gdimg, $x, $y);
                                <span class="keywordflow">foreach</span> ($OriginalPixel as $key =&gt; $value) {
                                        $NewPixel[$key] = min(255, max(0, round($OriginalPixel[$key] * $scaling)));
                                }
                                $newColor = ImageColorAllocate($gdimg, $NewPixel[<span class="stringliteral">&#39;red&#39;</span>], $NewPixel[<span class="stringliteral">&#39;green&#39;</span>], $NewPixel[<span class="stringliteral">&#39;blue&#39;</span>]);
                                ImageSetPixel($gdimg, $x, $y, $newColor);
                        }
                }
        }
</pre></div>
</div>
</div>
<a class="anchor" id="a30486e42d7dc5476cc4c8780827f35e5"></a><!-- doxytag: member="phpthumb_filters::Crop" ref="a30486e42d7dc5476cc4c8780827f35e5" args="(&amp;$gdimg, $left=0, $right=0, $top=0, $bottom=0)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphpthumb__filters.html#a30486e42d7dc5476cc4c8780827f35e5">Crop</a> </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>gdimg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>left</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>right</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>top</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>bottom</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l00263">263</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>
<div class="fragment"><pre class="fragment">                                                                     {
                <span class="keywordflow">if</span> (!$left &amp;&amp; !$right &amp;&amp; !$top &amp;&amp; !$bottom) {
                        <span class="keywordflow">return</span> <span class="keyword">true</span>;
                }
                $oldW = ImageSX($gdimg);
                $oldH = ImageSY($gdimg);
                <span class="keywordflow">if</span> (($left   &gt; 0) &amp;&amp; ($left   &lt; 1)) { $left   = round($left   * $oldW); }
                <span class="keywordflow">if</span> (($right  &gt; 0) &amp;&amp; ($right  &lt; 1)) { $right  = round($right  * $oldW); }
                <span class="keywordflow">if</span> (($top    &gt; 0) &amp;&amp; ($top    &lt; 1)) { $top    = round($top    * $oldH); }
                <span class="keywordflow">if</span> (($bottom &gt; 0) &amp;&amp; ($bottom &lt; 1)) { $bottom = round($bottom * $oldH); }
                $right  = min($oldW - $left - 1, $right);
                $bottom = min($oldH - $top  - 1, $bottom);
                $newW = $oldW - $left - $right;
                $newH = $oldH - $top  - $bottom;

                <span class="keywordflow">if</span> ($imgCropped = ImageCreateTrueColor($newW, $newH)) {
                        ImageCopy($imgCropped, $gdimg, 0, 0, $left, $top, $newW, $newH);
                        <span class="keywordflow">if</span> ($gdimg = ImageCreateTrueColor($newW, $newH)) {
                                ImageCopy($gdimg, $imgCropped, 0, 0, 0, 0, $newW, $newH);
                                ImageDestroy($imgCropped);
                                <span class="keywordflow">return</span> <span class="keyword">true</span>;
                        }
                        ImageDestroy($imgCropped);
                }
                <span class="keywordflow">return</span> <span class="keyword">false</span>;
        }
</pre></div>
</div>
</div>
<a class="anchor" id="a31094adc61bf77474247fff1bd98319a"></a><!-- doxytag: member="phpthumb_filters::DebugMessage" ref="a31094adc61bf77474247fff1bd98319a" args="($message, $file='', $line='')" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a> </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>file</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>line</em> = <code>''</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l01529">1529</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>
<div class="fragment"><pre class="fragment">                                                            {
                <span class="keywordflow">if</span> (is_object($this-&gt;phpThumbObject)) {
                        <span class="keywordflow">return</span> $this-&gt;phpThumbObject-&gt;DebugMessage($message, <a class="code" href="tokenizer__test_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>, <a class="code" href="tokenizer__test_8php.html#a52f469b0182d9abac2d0f20548680c9c">$line</a>);
                }
                <span class="keywordflow">return</span> <span class="keyword">false</span>;
        }
</pre></div>
</div>
</div>
<a class="anchor" id="ad3b8f01262de4fbbcfd011e3e5beeb6b"></a><!-- doxytag: member="phpthumb_filters::Desaturate" ref="ad3b8f01262de4fbbcfd011e3e5beeb6b" args="(&amp;$gdimg, $amount, $color='')" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphpthumb__filters.html#ad3b8f01262de4fbbcfd011e3e5beeb6b">Desaturate</a> </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>gdimg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>amount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>color</em> = <code>''</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l00291">291</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>
<div class="fragment"><pre class="fragment">                                                         {
                <span class="keywordflow">if</span> ($amount == 0) {
                        <span class="keywordflow">return</span> <span class="keyword">true</span>;
                }
                <span class="keywordflow">return</span> <a class="code" href="classphpthumb__filters.html#a0fd131013d15acb0563517913421f06e">phpthumb_filters::Colorize</a>($gdimg, $amount, (<a class="code" href="classphpthumb__functions.html#aa88047663adfed917d5fb0bece3913b8">phpthumb_functions::IsHexColor</a>($color) ? $color : <span class="stringliteral">&#39;gray&#39;</span>));
        }
</pre></div>
</div>
</div>
<a class="anchor" id="af3f3dbf7cf23ec5a82650733f7aa1a35"></a><!-- doxytag: member="phpthumb_filters::DropShadow" ref="af3f3dbf7cf23ec5a82650733f7aa1a35" args="(&amp;$gdimg, $distance, $width, $hexcolor, $angle, $fade)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphpthumb__filters.html#af3f3dbf7cf23ec5a82650733f7aa1a35">DropShadow</a> </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>gdimg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>distance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>hexcolor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>fade</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l00299">299</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>
<div class="fragment"><pre class="fragment">                                                                                  {
                <span class="keywordflow">if</span> (<a class="code" href="classphpthumb__functions.html#aaaad487d4c5a61befc88ae061f8a64fe">phpthumb_functions::gd_version</a>() &lt; 2) {
                        <span class="keywordflow">return</span> <span class="keyword">false</span>;
                }
                $distance = ($distance ? $distance : 10);
                $width    = ($width    ? $width    : 10);
                $hexcolor = ($hexcolor ? $hexcolor : <span class="stringliteral">&#39;000000&#39;</span>);
                $angle    = ($angle    ? $angle    : 225);
                $fade     = ($fade     ? $fade     : 1);

                $width_shadow  = cos(deg2rad($angle)) * ($distance + $width);
                $height_shadow = sin(deg2rad($angle)) * ($distance + $width);

                $scaling = min(ImageSX($gdimg) / (ImageSX($gdimg) + abs($width_shadow)), ImageSY($gdimg) / (ImageSY($gdimg) + abs($height_shadow)));

                <span class="keywordflow">for</span> ($i = 0; $i &lt; $width; $i++) {
                        $WidthAlpha[$i] = (abs(($width / 2) - $i) / $width) * $fade;
                        $Offset[<span class="charliteral">&#39;x&#39;</span>] = cos(deg2rad($angle)) * ($distance + $i);
                        $Offset[<span class="charliteral">&#39;y&#39;</span>] = sin(deg2rad($angle)) * ($distance + $i);
                }

                $tempImageWidth  = ImageSX($gdimg)  + abs($Offset[<span class="charliteral">&#39;x&#39;</span>]);
                $tempImageHeight = ImageSY($gdimg) + abs($Offset[<span class="charliteral">&#39;y&#39;</span>]);

                <span class="keywordflow">if</span> ($gdimg_dropshadow_temp = <a class="code" href="classphpthumb__functions.html#a02caac9e703a9c106e3fea3a6215130d">phpthumb_functions::ImageCreateFunction</a>($tempImageWidth, $tempImageHeight)) {

                        ImageAlphaBlending($gdimg_dropshadow_temp, <span class="keyword">false</span>);
                        ImageSaveAlpha($gdimg_dropshadow_temp, <span class="keyword">true</span>);
                        $transparent1 = <a class="code" href="classphpthumb__functions.html#ab43fe1af0d0c46288c2ffcf3905a7b42">phpthumb_functions::ImageColorAllocateAlphaSafe</a>($gdimg_dropshadow_temp, 0, 0, 0, 127);
                        ImageFill($gdimg_dropshadow_temp, 0, 0, $transparent1);

                        <span class="keywordflow">for</span> ($x = 0; $x &lt; ImageSX($gdimg); $x++) {
                                <span class="keywordflow">for</span> ($y = 0; $y &lt; ImageSY($gdimg); $y++) {
                                        $PixelMap[$x][$y] = <a class="code" href="classphpthumb__functions.html#ac73caf77553f599f9bdb88c03281b33b">phpthumb_functions::GetPixelColor</a>($gdimg, $x, $y);
                                }
                        }
                        <span class="keywordflow">for</span> ($x = 0; $x &lt; $tempImageWidth; $x++) {
                                <span class="keywordflow">for</span> ($y = 0; $y &lt; $tempImageHeight; $y++) {
                                        <span class="comment">//for ($i = 0; $i &lt; $width; $i++) {</span>
                                        <span class="keywordflow">for</span> ($i = 0; $i &lt; 1; $i++) {
                                                <span class="keywordflow">if</span> (!isset($PixelMap[$x][$y][<span class="stringliteral">&#39;alpha&#39;</span>]) || ($PixelMap[$x][$y][<span class="stringliteral">&#39;alpha&#39;</span>] &gt; 0)) {
                                                        <span class="keywordflow">if</span> (isset($PixelMap[$x + $Offset[<span class="charliteral">&#39;x&#39;</span>]][$y + $Offset[<span class="charliteral">&#39;y&#39;</span>]][<span class="stringliteral">&#39;alpha&#39;</span>]) &amp;&amp; ($PixelMap[$x + $Offset[<span class="charliteral">&#39;x&#39;</span>]][$y + $Offset[<span class="charliteral">&#39;y&#39;</span>]][<span class="stringliteral">&#39;alpha&#39;</span>] &lt; 127)) {
                                                                $thisColor = <a class="code" href="classphpthumb__functions.html#a9a63d0b70df4136de64ab0cd351e7ff3">phpthumb_functions::ImageHexColorAllocate</a>($gdimg, $hexcolor, <span class="keyword">false</span>, $PixelMap[$x + $Offset[<span class="charliteral">&#39;x&#39;</span>]][$y + $Offset[<span class="charliteral">&#39;y&#39;</span>]][<span class="stringliteral">&#39;alpha&#39;</span>]);
                                                                ImageSetPixel($gdimg_dropshadow_temp, $x, $y, $thisColor);
                                                        }
                                                }
                                        }
                                }
                        }

                        ImageAlphaBlending($gdimg_dropshadow_temp, <span class="keyword">true</span>);
                        <span class="keywordflow">for</span> ($x = 0; $x &lt; ImageSX($gdimg); $x++) {
                                <span class="keywordflow">for</span> ($y = 0; $y &lt; ImageSY($gdimg); $y++) {
                                        <span class="keywordflow">if</span> ($PixelMap[$x][$y][<span class="stringliteral">&#39;alpha&#39;</span>] &lt; 127) {
                                                $thisColor = <a class="code" href="classphpthumb__functions.html#ab43fe1af0d0c46288c2ffcf3905a7b42">phpthumb_functions::ImageColorAllocateAlphaSafe</a>($gdimg_dropshadow_temp, $PixelMap[$x][$y][<span class="stringliteral">&#39;red&#39;</span>], $PixelMap[$x][$y][<span class="stringliteral">&#39;green&#39;</span>], $PixelMap[$x][$y][<span class="stringliteral">&#39;blue&#39;</span>], $PixelMap[$x][$y][<span class="stringliteral">&#39;alpha&#39;</span>]);
                                                ImageSetPixel($gdimg_dropshadow_temp, $x, $y, $thisColor);
                                        }
                                }
                        }

                        ImageSaveAlpha($gdimg, <span class="keyword">true</span>);
                        ImageAlphaBlending($gdimg, <span class="keyword">false</span>);
                        <span class="comment">//$this-&gt;is_alpha = true;</span>
                        $transparent2 = <a class="code" href="classphpthumb__functions.html#ab43fe1af0d0c46288c2ffcf3905a7b42">phpthumb_functions::ImageColorAllocateAlphaSafe</a>($gdimg, 0, 0, 0, 127);
                        ImageFilledRectangle($gdimg, 0, 0, ImageSX($gdimg), ImageSY($gdimg), $transparent2);
                        ImageCopyResampled($gdimg, $gdimg_dropshadow_temp, 0, 0, 0, 0, ImageSX($gdimg), ImageSY($gdimg), ImageSX($gdimg_dropshadow_temp), ImageSY($gdimg_dropshadow_temp));

                        ImageDestroy($gdimg_dropshadow_temp);
                }
                <span class="keywordflow">return</span> <span class="keyword">true</span>;
        }
</pre></div>
</div>
</div>
<a class="anchor" id="af13f740be9d44366c26925374e90b8b9"></a><!-- doxytag: member="phpthumb_filters::EdgeDetect" ref="af13f740be9d44366c26925374e90b8b9" args="(&amp;$gdimg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphpthumb__filters.html#af13f740be9d44366c26925374e90b8b9">EdgeDetect</a> </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>gdimg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l00372">372</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>
<div class="fragment"><pre class="fragment">                                     {
                <span class="keywordflow">if</span> (<a class="code" href="classphpthumb__functions.html#af53f41b3482e6bed2082daa0ebfd96c0">phpthumb_functions::version_compare_replacement</a>(phpversion(), <span class="stringliteral">&#39;5.0.0&#39;</span>, <span class="stringliteral">&#39;&gt;=&#39;</span>) &amp;&amp; <a class="code" href="classphpthumb__functions.html#adfd72c199df2f74f6daeda7c06a18cae">phpthumb_functions::gd_is_bundled</a>()) {
                        <span class="keywordflow">if</span> (ImageFilter($gdimg, IMG_FILTER_EDGEDETECT)) {
                                <span class="keywordflow">return</span> <span class="keyword">true</span>;
                        }
                        $this-&gt;<a class="code" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a>(<span class="stringliteral">&#39;FAILED: ImageFilter($gdimg, IMG_FILTER_EDGEDETECT)&#39;</span>, __FILE__, __LINE__);
                        <span class="comment">// fall through and try it the hard way</span>
                }
                <span class="comment">// currently not implemented &quot;the hard way&quot;</span>
                $this-&gt;<a class="code" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a>(<span class="stringliteral">&#39;FAILED: phpthumb_filters::EdgeDetect($gdimg) [function not implemented]&#39;</span>, __FILE__, __LINE__);
                <span class="keywordflow">return</span> <span class="keyword">false</span>;
        }
</pre></div>
</div>
</div>
<a class="anchor" id="abd40d19047d10673ea2670ce5ae69f6c"></a><!-- doxytag: member="phpthumb_filters::Elipse" ref="abd40d19047d10673ea2670ce5ae69f6c" args="($gdimg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphpthumb__filters.html#abd40d19047d10673ea2670ce5ae69f6c">Elipse</a> </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>gdimg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l00386">386</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>
<div class="fragment"><pre class="fragment">                                {
                <span class="keywordflow">if</span> (<a class="code" href="classphpthumb__functions.html#aaaad487d4c5a61befc88ae061f8a64fe">phpthumb_functions::gd_version</a>() &lt; 2) {
                        <span class="keywordflow">return</span> <span class="keyword">false</span>;
                }
                <span class="comment">// generate mask at twice desired resolution and downsample afterwards for easy antialiasing</span>
                <span class="keywordflow">if</span> ($gdimg_elipsemask_double = <a class="code" href="classphpthumb__functions.html#a02caac9e703a9c106e3fea3a6215130d">phpthumb_functions::ImageCreateFunction</a>(ImageSX($gdimg) * 2, ImageSY($gdimg) * 2)) {
                        <span class="keywordflow">if</span> ($gdimg_elipsemask = <a class="code" href="classphpthumb__functions.html#a02caac9e703a9c106e3fea3a6215130d">phpthumb_functions::ImageCreateFunction</a>(ImageSX($gdimg), ImageSY($gdimg))) {

                                $color_transparent = ImageColorAllocate($gdimg_elipsemask_double, 255, 255, 255);
                                ImageFilledEllipse($gdimg_elipsemask_double, ImageSX($gdimg), ImageSY($gdimg), (ImageSX($gdimg) - 1) * 2, (ImageSY($gdimg) - 1) * 2, $color_transparent);
                                ImageCopyResampled($gdimg_elipsemask, $gdimg_elipsemask_double, 0, 0, 0, 0, ImageSX($gdimg), ImageSY($gdimg), ImageSX($gdimg) * 2, ImageSY($gdimg) * 2);

                                <a class="code" href="classphpthumb__filters.html#a1d26d503a63b41fe2f6d6c6c22c2f977">phpthumb_filters::ApplyMask</a>($gdimg_elipsemask, $gdimg);
                                ImageDestroy($gdimg_elipsemask);
                                <span class="keywordflow">return</span> <span class="keyword">true</span>;

                        } <span class="keywordflow">else</span> {
                                $this-&gt;<a class="code" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a>(<span class="stringliteral">&#39;$gdimg_elipsemask = phpthumb_functions::ImageCreateFunction() failed&#39;</span>, __FILE__, __LINE__);
                        }
                        ImageDestroy($gdimg_elipsemask_double);
                } <span class="keywordflow">else</span> {
                        $this-&gt;<a class="code" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a>(<span class="stringliteral">&#39;$gdimg_elipsemask_double = phpthumb_functions::ImageCreateFunction() failed&#39;</span>, __FILE__, __LINE__);
                }
                <span class="keywordflow">return</span> <span class="keyword">false</span>;
        }
</pre></div>
</div>
</div>
<a class="anchor" id="af56f3a0df7361a69fc4b006f9a0e2f98"></a><!-- doxytag: member="phpthumb_filters::Emboss" ref="af56f3a0df7361a69fc4b006f9a0e2f98" args="(&amp;$gdimg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphpthumb__filters.html#af56f3a0df7361a69fc4b006f9a0e2f98">Emboss</a> </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>gdimg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l00413">413</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>
<div class="fragment"><pre class="fragment">                                 {
                <span class="keywordflow">if</span> (<a class="code" href="classphpthumb__functions.html#af53f41b3482e6bed2082daa0ebfd96c0">phpthumb_functions::version_compare_replacement</a>(phpversion(), <span class="stringliteral">&#39;5.0.0&#39;</span>, <span class="stringliteral">&#39;&gt;=&#39;</span>) &amp;&amp; <a class="code" href="classphpthumb__functions.html#adfd72c199df2f74f6daeda7c06a18cae">phpthumb_functions::gd_is_bundled</a>()) {
                        <span class="keywordflow">if</span> (ImageFilter($gdimg, IMG_FILTER_EMBOSS)) {
                                <span class="keywordflow">return</span> <span class="keyword">true</span>;
                        }
                        $this-&gt;<a class="code" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a>(<span class="stringliteral">&#39;FAILED: ImageFilter($gdimg, IMG_FILTER_EMBOSS)&#39;</span>, __FILE__, __LINE__);
                        <span class="comment">// fall through and try it the hard way</span>
                }
                <span class="comment">// currently not implemented &quot;the hard way&quot;</span>
                $this-&gt;<a class="code" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a>(<span class="stringliteral">&#39;FAILED: phpthumb_filters::Emboss($gdimg) [function not implemented]&#39;</span>, __FILE__, __LINE__);
                <span class="keywordflow">return</span> <span class="keyword">false</span>;
        }
</pre></div>
</div>
</div>
<a class="anchor" id="a9361be25a234723bef65039b7d7bb4da"></a><!-- doxytag: member="phpthumb_filters::Flip" ref="a9361be25a234723bef65039b7d7bb4da" args="(&amp;$gdimg, $x=false, $y=false)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphpthumb__filters.html#a9361be25a234723bef65039b7d7bb4da">Flip</a> </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>gdimg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>x</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>y</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l00427">427</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>
<div class="fragment"><pre class="fragment">                                                   {
                <span class="keywordflow">if</span> (!$x &amp;&amp; !$y) {
                        <span class="keywordflow">return</span> <span class="keyword">false</span>;
                }
                <span class="keywordflow">if</span> ($tempImage = <a class="code" href="classphpthumb__functions.html#a02caac9e703a9c106e3fea3a6215130d">phpthumb_functions::ImageCreateFunction</a>(ImageSX($gdimg), ImageSY($gdimg))) {
                        <span class="keywordflow">if</span> ($x) {
                                ImageCopy($tempImage, $gdimg, 0, 0, 0, 0, ImageSX($gdimg), ImageSY($gdimg));
                                <span class="keywordflow">for</span> ($x = 0; $x &lt; ImageSX($gdimg); $x++) {
                                        ImageCopy($gdimg, $tempImage, ImageSX($gdimg) - 1 - $x, 0, $x, 0, 1, ImageSY($gdimg));
                                }
                        }
                        <span class="keywordflow">if</span> ($y) {
                                ImageCopy($tempImage, $gdimg, 0, 0, 0, 0, ImageSX($gdimg), ImageSY($gdimg));
                                <span class="keywordflow">for</span> ($y = 0; $y &lt; ImageSY($gdimg); $y++) {
                                        ImageCopy($gdimg, $tempImage, 0, ImageSY($gdimg) - 1 - $y, 0, $y, ImageSX($gdimg), 1);
                                }
                        }
                        ImageDestroy($tempImage);
                }
                <span class="keywordflow">return</span> <span class="keyword">true</span>;
        }
</pre></div>
</div>
</div>
<a class="anchor" id="a61bd8c7eadd58f7eff3cfaf5888ce18d"></a><!-- doxytag: member="phpthumb_filters::Frame" ref="a61bd8c7eadd58f7eff3cfaf5888ce18d" args="(&amp;$gdimg, $frame_width, $edge_width, $hexcolor_frame, $hexcolor1, $hexcolor2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphpthumb__filters.html#a61bd8c7eadd58f7eff3cfaf5888ce18d">Frame</a> </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>gdimg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>frame_width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>edge_width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>hexcolor_frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>hexcolor1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>hexcolor2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l00450">450</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>
<div class="fragment"><pre class="fragment">                                                                                                    {
                $frame_width    = ($frame_width    ? $frame_width    : 5);
                $edge_width     = ($edge_width     ? $edge_width     : 1);
                $hexcolor_frame = ($hexcolor_frame ? $hexcolor_frame : <span class="stringliteral">&#39;CCCCCC&#39;</span>);
                $hexcolor1      = ($hexcolor1      ? $hexcolor1      : <span class="stringliteral">&#39;FFFFFF&#39;</span>);
                $hexcolor2      = ($hexcolor2      ? $hexcolor2      : <span class="stringliteral">&#39;000000&#39;</span>);

                $color_frame = <a class="code" href="classphpthumb__functions.html#a9a63d0b70df4136de64ab0cd351e7ff3">phpthumb_functions::ImageHexColorAllocate</a>($gdimg, $hexcolor_frame);
                $color1      = <a class="code" href="classphpthumb__functions.html#a9a63d0b70df4136de64ab0cd351e7ff3">phpthumb_functions::ImageHexColorAllocate</a>($gdimg, $hexcolor1);
                $color2      = <a class="code" href="classphpthumb__functions.html#a9a63d0b70df4136de64ab0cd351e7ff3">phpthumb_functions::ImageHexColorAllocate</a>($gdimg, $hexcolor2);
                <span class="keywordflow">for</span> ($i = 0; $i &lt; $edge_width; $i++) {
                        <span class="comment">// outer bevel</span>
                        ImageLine($gdimg,                   $i,                   $i,                   $i, ImageSY($gdimg) - $i, $color1); <span class="comment">// left</span>
                        ImageLine($gdimg,                   $i,                   $i, ImageSX($gdimg) - $i,                   $i, $color1); <span class="comment">// top</span>
                        ImageLine($gdimg, ImageSX($gdimg) - $i, ImageSY($gdimg) - $i, ImageSX($gdimg) - $i,                   $i, $color2); <span class="comment">// right</span>
                        ImageLine($gdimg, ImageSX($gdimg) - $i, ImageSY($gdimg) - $i,                   $i, ImageSY($gdimg) - $i, $color2); <span class="comment">// bottom</span>
                }
                <span class="keywordflow">for</span> ($i = 0; $i &lt; $frame_width; $i++) {
                        <span class="comment">// actual frame</span>
                        ImageRectangle($gdimg, $edge_width + $i, $edge_width + $i, ImageSX($gdimg) - $edge_width - $i, ImageSY($gdimg) - $edge_width - $i, $color_frame);
                }
                <span class="keywordflow">for</span> ($i = 0; $i &lt; $edge_width; $i++) {
                        <span class="comment">// inner bevel</span>
                        ImageLine($gdimg,                   $frame_width + $edge_width + $i,                   $frame_width + $edge_width + $i,                   $frame_width + $edge_width + $i, ImageSY($gdimg) - $frame_width - $edge_width - $i, $color2); <span class="comment">// left</span>
                        ImageLine($gdimg,                   $frame_width + $edge_width + $i,                   $frame_width + $edge_width + $i, ImageSX($gdimg) - $frame_width - $edge_width - $i,                   $frame_width + $edge_width + $i, $color2); <span class="comment">// top</span>
                        ImageLine($gdimg, ImageSX($gdimg) - $frame_width - $edge_width - $i, ImageSY($gdimg) - $frame_width - $edge_width - $i, ImageSX($gdimg) - $frame_width - $edge_width - $i,                   $frame_width + $edge_width + $i, $color1); <span class="comment">// right</span>
                        ImageLine($gdimg, ImageSX($gdimg) - $frame_width - $edge_width - $i, ImageSY($gdimg) - $frame_width - $edge_width - $i,                   $frame_width + $edge_width + $i, ImageSY($gdimg) - $frame_width - $edge_width - $i, $color1); <span class="comment">// bottom</span>
                }
                <span class="keywordflow">return</span> <span class="keyword">true</span>;
        }
</pre></div>
</div>
</div>
<a class="anchor" id="a8f8fb8f6b7b2aa1ccb9012de29322c89"></a><!-- doxytag: member="phpthumb_filters::Gamma" ref="a8f8fb8f6b7b2aa1ccb9012de29322c89" args="(&amp;$gdimg, $amount)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphpthumb__filters.html#a8f8fb8f6b7b2aa1ccb9012de29322c89">Gamma</a> </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>gdimg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>amount</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l00482">482</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>
<div class="fragment"><pre class="fragment">                                         {
                <span class="keywordflow">if</span> (number_format($amount, 4) == <span class="stringliteral">&#39;1.0000&#39;</span>) {
                        <span class="keywordflow">return</span> <span class="keyword">true</span>;
                }
                <span class="keywordflow">return</span> ImageGammaCorrect($gdimg, 1.0, $amount);
        }
</pre></div>
</div>
</div>
<a class="anchor" id="ac964ed4e79cc312837da27572426e6b6"></a><!-- doxytag: member="phpthumb_filters::Grayscale" ref="ac964ed4e79cc312837da27572426e6b6" args="(&amp;$gdimg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphpthumb__filters.html#ac964ed4e79cc312837da27572426e6b6">Grayscale</a> </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>gdimg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l00490">490</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>
<div class="fragment"><pre class="fragment">                                    {
                <span class="keywordflow">if</span> (<a class="code" href="classphpthumb__functions.html#af53f41b3482e6bed2082daa0ebfd96c0">phpthumb_functions::version_compare_replacement</a>(phpversion(), <span class="stringliteral">&#39;5.0.0&#39;</span>, <span class="stringliteral">&#39;&gt;=&#39;</span>) &amp;&amp; <a class="code" href="classphpthumb__functions.html#adfd72c199df2f74f6daeda7c06a18cae">phpthumb_functions::gd_is_bundled</a>()) {
                        <span class="keywordflow">if</span> (ImageFilter($gdimg, IMG_FILTER_GRAYSCALE)) {
                                <span class="keywordflow">return</span> <span class="keyword">true</span>;
                        }
                        $this-&gt;<a class="code" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a>(<span class="stringliteral">&#39;FAILED: ImageFilter($gdimg, IMG_FILTER_GRAYSCALE)&#39;</span>, __FILE__, __LINE__);
                        <span class="comment">// fall through and try it the hard way</span>
                }
                <span class="keywordflow">return</span> <a class="code" href="classphpthumb__filters.html#a0fd131013d15acb0563517913421f06e">phpthumb_filters::Colorize</a>($gdimg, 100, <span class="stringliteral">&#39;gray&#39;</span>);
        }
</pre></div>
</div>
</div>
<a class="anchor" id="ada0752b5c2e587088c61e8c18ba21514"></a><!-- doxytag: member="phpthumb_filters::HistogramAnalysis" ref="ada0752b5c2e587088c61e8c18ba21514" args="(&amp;$gdimg, $calculateGray=false)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphpthumb__filters.html#ada0752b5c2e587088c61e8c18ba21514">HistogramAnalysis</a> </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>gdimg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>calculateGray</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l00502">502</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>
<div class="fragment"><pre class="fragment">                                                                  {
                $ImageSX = ImageSX($gdimg);
                $ImageSY = ImageSY($gdimg);
                <span class="keywordflow">for</span> ($x = 0; $x &lt; $ImageSX; $x++) {
                        <span class="keywordflow">for</span> ($y = 0; $y &lt; $ImageSY; $y++) {
                                $OriginalPixel = <a class="code" href="classphpthumb__functions.html#ac73caf77553f599f9bdb88c03281b33b">phpthumb_functions::GetPixelColor</a>($gdimg, $x, $y);
                                @$Analysis[<span class="stringliteral">&#39;red&#39;</span>][$OriginalPixel[<span class="stringliteral">&#39;red&#39;</span>]]++;
                                @$Analysis[<span class="stringliteral">&#39;green&#39;</span>][$OriginalPixel[<span class="stringliteral">&#39;green&#39;</span>]]++;
                                @$Analysis[<span class="stringliteral">&#39;blue&#39;</span>][$OriginalPixel[<span class="stringliteral">&#39;blue&#39;</span>]]++;
                                @$Analysis[<span class="stringliteral">&#39;alpha&#39;</span>][$OriginalPixel[<span class="stringliteral">&#39;alpha&#39;</span>]]++;
                                <span class="keywordflow">if</span> ($calculateGray) {
                                        $GrayPixel = <a class="code" href="classphpthumb__functions.html#a5f3d1f38c5a6c3a5b83a8f96042ffef5">phpthumb_functions::GrayscalePixel</a>($OriginalPixel);
                                        @$Analysis[<span class="stringliteral">&#39;gray&#39;</span>][$GrayPixel[<span class="stringliteral">&#39;red&#39;</span>]]++;
                                }
                        }
                }
                $keys = array(<span class="stringliteral">&#39;red&#39;</span>, <span class="stringliteral">&#39;green&#39;</span>, <span class="stringliteral">&#39;blue&#39;</span>, <span class="stringliteral">&#39;alpha&#39;</span>);
                <span class="keywordflow">if</span> ($calculateGray) {
                        $keys[] = <span class="stringliteral">&#39;gray&#39;</span>;
                }
                <span class="keywordflow">foreach</span> ($keys as $dummy =&gt; $key) {
                        ksort($Analysis[$key]);
                }
                <span class="keywordflow">return</span> $Analysis;
        }
</pre></div>
</div>
</div>
<a class="anchor" id="a6419068818fbc8d1a371b6c169faa134"></a><!-- doxytag: member="phpthumb_filters::HistogramOverlay" ref="a6419068818fbc8d1a371b6c169faa134" args="(&amp;$gdimg, $bands='*', $colors='', $width=0.25, $height=0.25, $alignment='BR', $opacity=50, $margin_x=5, $margin_y=null)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphpthumb__filters.html#a6419068818fbc8d1a371b6c169faa134">HistogramOverlay</a> </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>gdimg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>bands</em> = <code>'*'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>colors</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>width</em> = <code>0.25</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>height</em> = <code>0.25</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>alignment</em> = <code>'BR'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>opacity</em> = <code>50</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>margin_x</em> = <code>5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>margin_y</em> = <code>null</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l00610">610</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>
<div class="fragment"><pre class="fragment">                                                                                                                                                         {
                $margin_y = (is_null($margin_y) ? $margin_x : $margin_y);

                $Analysis = <a class="code" href="classphpthumb__filters.html#ada0752b5c2e587088c61e8c18ba21514">phpthumb_filters::HistogramAnalysis</a>($gdimg, <span class="keyword">true</span>);
                $histW = round(($width &gt; 1) ? min($width, ImageSX($gdimg)) : ImageSX($gdimg) * $width);
                $histH = round(($width &gt; 1) ? min($width, ImageSX($gdimg)) : ImageSX($gdimg) * $width);
                <span class="keywordflow">if</span> ($gdHist = ImageCreateTrueColor($histW, $histH)) {
                        $color_back = <a class="code" href="classphpthumb__functions.html#ab43fe1af0d0c46288c2ffcf3905a7b42">phpthumb_functions::ImageColorAllocateAlphaSafe</a>($gdHist, 0, 0, 0, 127);
                        ImageFilledRectangle($gdHist, 0, 0, $histW, $histH, $color_back);
                        ImageAlphaBlending($gdHist, <span class="keyword">false</span>);
                        ImageSaveAlpha($gdHist, <span class="keyword">true</span>);

                        $HistogramTempWidth  = 256;
                        $HistogramTempHeight = 100;
                        <span class="keywordflow">if</span> ($gdHistTemp = ImageCreateTrueColor($HistogramTempWidth, $HistogramTempHeight)) {
                                $color_back_temp = <a class="code" href="classphpthumb__functions.html#ab43fe1af0d0c46288c2ffcf3905a7b42">phpthumb_functions::ImageColorAllocateAlphaSafe</a>($gdHistTemp, 255, 0, 255, 127);
                                ImageAlphaBlending($gdHistTemp, <span class="keyword">false</span>);
                                ImageSaveAlpha($gdHistTemp, <span class="keyword">true</span>);
                                ImageFilledRectangle($gdHistTemp, 0, 0, ImageSX($gdHistTemp), ImageSY($gdHistTemp), $color_back_temp);

                                $DefaultColors = array(<span class="charliteral">&#39;r&#39;</span>=&gt;<span class="stringliteral">&#39;FF0000&#39;</span>, <span class="charliteral">&#39;g&#39;</span>=&gt;<span class="stringliteral">&#39;00FF00&#39;</span>, <span class="charliteral">&#39;b&#39;</span>=&gt;<span class="stringliteral">&#39;0000FF&#39;</span>, <span class="charliteral">&#39;a&#39;</span>=&gt;<span class="stringliteral">&#39;999999&#39;</span>, <span class="charliteral">&#39;*&#39;</span>=&gt;<span class="stringliteral">&#39;FFFFFF&#39;</span>);
                                $Colors = explode(<span class="charliteral">&#39;;&#39;</span>, $colors);
                                $BandsToGraph = array_unique(preg_split(<span class="stringliteral">&#39;//&#39;</span>, $bands));
                                $keys = array(<span class="charliteral">&#39;r&#39;</span>=&gt;<span class="stringliteral">&#39;red&#39;</span>, <span class="charliteral">&#39;g&#39;</span>=&gt;<span class="stringliteral">&#39;green&#39;</span>, <span class="charliteral">&#39;b&#39;</span>=&gt;<span class="stringliteral">&#39;blue&#39;</span>, <span class="charliteral">&#39;a&#39;</span>=&gt;<span class="stringliteral">&#39;alpha&#39;</span>, <span class="charliteral">&#39;*&#39;</span>=&gt;<span class="stringliteral">&#39;gray&#39;</span>);
                                <span class="keywordflow">foreach</span> ($BandsToGraph as $key =&gt; $band) {
                                        <span class="keywordflow">if</span> (!isset($keys[$band])) {
                                                <span class="keywordflow">continue</span>;
                                        }
                                        $PeakValue = max($Analysis[$keys[$band]]);
                                        $thisColor = <a class="code" href="classphpthumb__functions.html#a9a63d0b70df4136de64ab0cd351e7ff3">phpthumb_functions::ImageHexColorAllocate</a>($gdHistTemp, <a class="code" href="classphpthumb__functions.html#aa88047663adfed917d5fb0bece3913b8">phpthumb_functions::IsHexColor</a>(@$Colors[$key]) ? $Colors[$key] : $DefaultColors[$band]);
                                        <span class="keywordflow">for</span> ($x = 0; $x &lt; $HistogramTempWidth; $x++) {
                                                ImageLine($gdHistTemp, $x, $HistogramTempHeight - 1, $x, $HistogramTempHeight - 1 - round(@$Analysis[$keys[$band]][$x] / $PeakValue * $HistogramTempHeight), $thisColor);
                                        }
                                        ImageLine($gdHistTemp, 0, $HistogramTempHeight - 1, $HistogramTempWidth - 1, $HistogramTempHeight - 1, $thisColor);
                                        ImageLine($gdHistTemp, 0, $HistogramTempHeight - 2, $HistogramTempWidth - 1, $HistogramTempHeight - 2, $thisColor);
                                }
                                ImageCopyResampled($gdHist, $gdHistTemp, 0, 0, 0, 0, ImageSX($gdHist), ImageSY($gdHist), ImageSX($gdHistTemp), ImageSY($gdHistTemp));
                                ImageDestroy($gdHistTemp);
                        } <span class="keywordflow">else</span> {
                                <span class="keywordflow">return</span> <span class="keyword">false</span>;
                        }

                        <a class="code" href="classphpthumb__filters.html#a31079a470f5697b85aad5855f5c614fc">phpthumb_filters::WatermarkOverlay</a>($gdimg, $gdHist, $alignment, $opacity, $margin_x, $margin_y);
                        ImageDestroy($gdHist);
                        <span class="keywordflow">return</span> <span class="keyword">true</span>;
                }
                <span class="keywordflow">return</span> <span class="keyword">false</span>;
        }
</pre></div>
</div>
</div>
<a class="anchor" id="ad49d6352f0a22c3c875fd0c59480ce7f"></a><!-- doxytag: member="phpthumb_filters::HistogramStretch" ref="ad49d6352f0a22c3c875fd0c59480ce7f" args="(&amp;$gdimg, $band='*', $method=0, $threshold=0.1)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphpthumb__filters.html#ad49d6352f0a22c3c875fd0c59480ce7f">HistogramStretch</a> </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>gdimg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>band</em> = <code>'*'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>method</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>threshold</em> = <code>0.1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l00529">529</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>
<div class="fragment"><pre class="fragment">                                                                                 {
                <span class="comment">// equivalent of &quot;Auto Contrast&quot; in Adobe Photoshop</span>
                <span class="comment">// method 0 stretches according to RGB colors. Gives a more conservative stretch.</span>
                <span class="comment">// method 1 band stretches according to grayscale which is color-biased (59% green, 30% red, 11% blue). May give a punchier / more aggressive stretch, possibly appearing over-saturated</span>
                $Analysis = <a class="code" href="classphpthumb__filters.html#ada0752b5c2e587088c61e8c18ba21514">phpthumb_filters::HistogramAnalysis</a>($gdimg, <span class="keyword">true</span>);
                $keys = array(<span class="charliteral">&#39;r&#39;</span>=&gt;<span class="stringliteral">&#39;red&#39;</span>, <span class="charliteral">&#39;g&#39;</span>=&gt;<span class="stringliteral">&#39;green&#39;</span>, <span class="charliteral">&#39;b&#39;</span>=&gt;<span class="stringliteral">&#39;blue&#39;</span>, <span class="charliteral">&#39;a&#39;</span>=&gt;<span class="stringliteral">&#39;alpha&#39;</span>, <span class="charliteral">&#39;*&#39;</span>=&gt;(($method == 0) ? <span class="stringliteral">&#39;all&#39;</span> : <span class="stringliteral">&#39;gray&#39;</span>));
                $band = substr($band, 0, 1);
                <span class="keywordflow">if</span> (!isset($keys[$band])) {
                        <span class="keywordflow">return</span> <span class="keyword">false</span>;
                }
                $key = $keys[$band];

                <span class="comment">// If the absolute brightest and darkest pixels are used then one random</span>
                <span class="comment">// pixel in the image could throw off the whole system. Instead, count up/down</span>
                <span class="comment">// from the limit and allow &lt;threshold&gt; (default = 0.1%) of brightest/darkest</span>
                <span class="comment">// pixels to be clipped to min/max</span>
                $threshold = floatval($threshold) / 100;
                $clip_threshold = ImageSX($gdimg) * ImageSX($gdimg) * $threshold;
                <span class="comment">//if ($min &gt;= 0) {</span>
                <span class="comment">//      $range_min = min($min, 255);</span>
                <span class="comment">//} else {</span>
                        $countsum = 0;
                        <span class="keywordflow">for</span> ($i = 0; $i &lt;= 255; $i++) {
                                <span class="keywordflow">if</span> ($method == 0) {
                                        $countsum = max(@$Analysis[<span class="stringliteral">&#39;red&#39;</span>][$i], @$Analysis[<span class="stringliteral">&#39;green&#39;</span>][$i], @$Analysis[<span class="stringliteral">&#39;blue&#39;</span>][$i]);
                                } <span class="keywordflow">else</span> {
                                        $countsum += @$Analysis[$key][$i];
                                }
                                <span class="keywordflow">if</span> ($countsum &gt;= $clip_threshold) {
                                        $range_min = $i - 1;
                                        <span class="keywordflow">break</span>;
                                }
                        }
                        $range_min = max($range_min, 0);
                <span class="comment">//}</span>
                <span class="comment">//if ($max &gt; 0) {</span>
                <span class="comment">//      $range_max = max($max, 255);</span>
                <span class="comment">//} else {</span>
                        $countsum = 0;
                        <span class="keywordflow">for</span> ($i = 255; $i &gt;= 0; $i--) {
                                <span class="keywordflow">if</span> ($method == 0) {
                                        $countsum = max(@$Analysis[<span class="stringliteral">&#39;red&#39;</span>][$i], @$Analysis[<span class="stringliteral">&#39;green&#39;</span>][$i], @$Analysis[<span class="stringliteral">&#39;blue&#39;</span>][$i]);
                                } <span class="keywordflow">else</span> {
                                        $countsum += @$Analysis[$key][$i];
                                }
                                <span class="keywordflow">if</span> ($countsum &gt;= $clip_threshold) {
                                        $range_max = $i + 1;
                                        <span class="keywordflow">break</span>;
                                }
                        }
                        $range_max = min($range_max, 255);
                <span class="comment">//}</span>
                $range_scale = (($range_max == $range_min) ? 1 : (255 / ($range_max - $range_min)));
                <span class="keywordflow">if</span> (($range_min == 0) &amp;&amp; ($range_max == 255)) {
                        <span class="comment">// no adjustment neccesary - don&#39;t waste CPU time!</span>
                        <span class="keywordflow">return</span> <span class="keyword">true</span>;
                }

                $ImageSX = ImageSX($gdimg);
                $ImageSY = ImageSY($gdimg);
                <span class="keywordflow">for</span> ($x = 0; $x &lt; $ImageSX; $x++) {
                        <span class="keywordflow">for</span> ($y = 0; $y &lt; $ImageSY; $y++) {
                                $OriginalPixel = <a class="code" href="classphpthumb__functions.html#ac73caf77553f599f9bdb88c03281b33b">phpthumb_functions::GetPixelColor</a>($gdimg, $x, $y);
                                <span class="keywordflow">if</span> ($band == <span class="charliteral">&#39;*&#39;</span>) {
                                        $new[<span class="stringliteral">&#39;red&#39;</span>]   = min(255, max(0, ($OriginalPixel[<span class="stringliteral">&#39;red&#39;</span>]   - $range_min) * $range_scale));
                                        $new[<span class="stringliteral">&#39;green&#39;</span>] = min(255, max(0, ($OriginalPixel[<span class="stringliteral">&#39;green&#39;</span>] - $range_min) * $range_scale));
                                        $new[<span class="stringliteral">&#39;blue&#39;</span>]  = min(255, max(0, ($OriginalPixel[<span class="stringliteral">&#39;blue&#39;</span>]  - $range_min) * $range_scale));
                                        $new[<span class="stringliteral">&#39;alpha&#39;</span>] = min(255, max(0, ($OriginalPixel[<span class="stringliteral">&#39;alpha&#39;</span>] - $range_min) * $range_scale));
                                } <span class="keywordflow">else</span> {
                                        $new = $OriginalPixel;
                                        $new[$key] = min(255, max(0, ($OriginalPixel[$key] - $range_min) * $range_scale));
                                }
                                $newColor = <a class="code" href="classphpthumb__functions.html#ab43fe1af0d0c46288c2ffcf3905a7b42">phpthumb_functions::ImageColorAllocateAlphaSafe</a>($gdimg, $new[<span class="stringliteral">&#39;red&#39;</span>], $new[<span class="stringliteral">&#39;green&#39;</span>], $new[<span class="stringliteral">&#39;blue&#39;</span>], $new[<span class="stringliteral">&#39;alpha&#39;</span>]);
                                ImageSetPixel($gdimg, $x, $y, $newColor);
                        }
                }

                <span class="keywordflow">return</span> <span class="keyword">true</span>;
        }
</pre></div>
</div>
</div>
<a class="anchor" id="adc2f01e3ad3f01f0204da6f10bad427c"></a><!-- doxytag: member="phpthumb_filters::ImageBorder" ref="adc2f01e3ad3f01f0204da6f10bad427c" args="(&amp;$gdimg, $border_width, $radius_x, $radius_y, $hexcolor_border)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphpthumb__filters.html#adc2f01e3ad3f01f0204da6f10bad427c">ImageBorder</a> </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>gdimg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>border_width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>radius_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>radius_y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>hexcolor_border</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l00660">660</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>
<div class="fragment"><pre class="fragment">                                                                                             {
                $border_width = ($border_width ? $border_width : 1);
                $radius_x     = ($radius_x     ? $radius_x     : 0);
                $radius_y     = ($radius_y     ? $radius_y     : 0);

                $output_width  = ImageSX($gdimg);
                $output_height = ImageSY($gdimg);

                list($new_width, $new_height) = <a class="code" href="classphpthumb__functions.html#a0b7ce9a69725437b7b71c8c4279d497d">phpthumb_functions::ProportionalResize</a>($output_width, $output_height, $output_width - max($border_width * 2, $radius_x), $output_height - max($border_width * 2, $radius_y));
                $offset_x = ($radius_x ? $output_width  - $new_width  - $radius_x : 0);
                $offset_y = ($radius_y ? $output_height - $new_height - $radius_y : 0);

<span class="comment">//header(&#39;Content-Type: image/png&#39;);</span>
<span class="comment">//ImagePNG($gdimg);</span>
<span class="comment">//exit;</span>
                <span class="keywordflow">if</span> ($gd_border_canvas = <a class="code" href="classphpthumb__functions.html#a02caac9e703a9c106e3fea3a6215130d">phpthumb_functions::ImageCreateFunction</a>($output_width, $output_height)) {

                        ImageSaveAlpha($gd_border_canvas, <span class="keyword">true</span>);
                        ImageAlphaBlending($gd_border_canvas, <span class="keyword">false</span>);
                        $color_background = <a class="code" href="classphpthumb__functions.html#ab43fe1af0d0c46288c2ffcf3905a7b42">phpthumb_functions::ImageColorAllocateAlphaSafe</a>($gd_border_canvas, 255, 255, 255, 127);
                        ImageFilledRectangle($gd_border_canvas, 0, 0, $output_width, $output_height, $color_background);

                        $color_border = <a class="code" href="classphpthumb__functions.html#a9a63d0b70df4136de64ab0cd351e7ff3">phpthumb_functions::ImageHexColorAllocate</a>($gd_border_canvas, (<a class="code" href="classphpthumb__functions.html#aa88047663adfed917d5fb0bece3913b8">phpthumb_functions::IsHexColor</a>($hexcolor_border) ? $hexcolor_border : <span class="stringliteral">&#39;000000&#39;</span>));

                        <span class="keywordflow">for</span> ($i = 0; $i &lt; $border_width; $i++) {
                                ImageLine($gd_border_canvas,             floor($offset_x / 2) + $radius_x,                      $i, $output_width - $radius_x - ceil($offset_x / 2),                         $i, $color_border); <span class="comment">// top</span>
                                ImageLine($gd_border_canvas,             floor($offset_x / 2) + $radius_x, $output_height - 1 - $i, $output_width - $radius_x - ceil($offset_x / 2),    $output_height - 1 - $i, $color_border); <span class="comment">// bottom</span>
                                ImageLine($gd_border_canvas,                    floor($offset_x / 2) + $i,               $radius_y,                      floor($offset_x / 2) +  $i, $output_height - $radius_y, $color_border); <span class="comment">// left</span>
                                ImageLine($gd_border_canvas, $output_width - 1 - $i - ceil($offset_x / 2),               $radius_y,    $output_width - 1 - $i - ceil($offset_x / 2), $output_height - $radius_y, $color_border); <span class="comment">// right</span>
                        }

                        <span class="keywordflow">if</span> ($radius_x &amp;&amp; $radius_y) {

                                <span class="comment">// PHP bug: ImageArc() with thicknesses &gt; 1 give bad/undesirable/unpredicatable results</span>
                                <span class="comment">// Solution: Draw multiple 1px arcs side-by-side.</span>

                                <span class="comment">// Problem: parallel arcs give strange/ugly antialiasing problems</span>
                                <span class="comment">// Solution: draw non-parallel arcs, from one side of the line thickness at the start angle</span>
                                <span class="comment">//   to the opposite edge of the line thickness at the terminating angle</span>
                                <span class="keywordflow">for</span> ($thickness_offset = 0; $thickness_offset &lt; $border_width; $thickness_offset++) {
                                        ImageArc($gd_border_canvas, floor($offset_x / 2) + 1 +                 $radius_x,              $thickness_offset - 1 + $radius_y, $radius_x * 2, $radius_y * 2, 180, 270, $color_border); <span class="comment">// top-left</span>
                                        ImageArc($gd_border_canvas,                     $output_width - $radius_x - 1 - ceil($offset_x / 2),              $thickness_offset - 1 + $radius_y, $radius_x * 2, $radius_y * 2, 270, 360, $color_border); <span class="comment">// top-right</span>
                                        ImageArc($gd_border_canvas,                     $output_width - $radius_x - 1 - ceil($offset_x / 2), $output_height - $thickness_offset - $radius_y, $radius_x * 2, $radius_y * 2,   0,  90, $color_border); <span class="comment">// bottom-right</span>
                                        ImageArc($gd_border_canvas, floor($offset_x / 2) + 1 +                 $radius_x, $output_height - $thickness_offset - $radius_y, $radius_x * 2, $radius_y * 2,  90, 180, $color_border); <span class="comment">// bottom-left</span>
                                }
                                <span class="keywordflow">if</span> ($border_width &gt; 1) {
                                        <span class="keywordflow">for</span> ($thickness_offset = 0; $thickness_offset &lt; $border_width; $thickness_offset++) {
                                                ImageArc($gd_border_canvas, floor($offset_x / 2) + $thickness_offset + $radius_x,                                      $radius_y, $radius_x * 2, $radius_y * 2, 180, 270, $color_border); <span class="comment">// top-left</span>
                                                ImageArc($gd_border_canvas, $output_width - $thickness_offset - $radius_x - 1 - ceil($offset_x / 2),                                      $radius_y, $radius_x * 2, $radius_y * 2, 270, 360, $color_border); <span class="comment">// top-right</span>
                                                ImageArc($gd_border_canvas, $output_width - $thickness_offset - $radius_x - 1 - ceil($offset_x / 2),                     $output_height - $radius_y, $radius_x * 2, $radius_y * 2,   0,  90, $color_border); <span class="comment">// bottom-right</span>
                                                ImageArc($gd_border_canvas, floor($offset_x / 2) + $thickness_offset + $radius_x,                     $output_height - $radius_y, $radius_x * 2, $radius_y * 2,  90, 180, $color_border); <span class="comment">// bottom-left</span>
                                        }
                                }

                        }
                        $this-&gt;phpThumbObject-&gt;ImageResizeFunction($gd_border_canvas, $gdimg, floor(($output_width - $new_width) / 2), round(($output_height - $new_height) / 2), 0, 0, $new_width, $new_height, $output_width, $output_height);

                        ImageDestroy($gdimg);
                        $gdimg = <a class="code" href="classphpthumb__functions.html#a02caac9e703a9c106e3fea3a6215130d">phpthumb_functions::ImageCreateFunction</a>($output_width, $output_height);
                        ImageSaveAlpha($gdimg, <span class="keyword">true</span>);
                        ImageAlphaBlending($gdimg, <span class="keyword">false</span>);
                        $gdimg_color_background = <a class="code" href="classphpthumb__functions.html#ab43fe1af0d0c46288c2ffcf3905a7b42">phpthumb_functions::ImageColorAllocateAlphaSafe</a>($gdimg, 255, 255, 255, 127);
                        ImageFilledRectangle($gdimg, 0, 0, $output_width, $output_height, $gdimg_color_background);

                        ImageCopy($gdimg, $gd_border_canvas, 0, 0, 0, 0, $output_width, $output_height);
                        <span class="comment">//$gdimg = $gd_border_canvas;</span>
                        ImageDestroy($gd_border_canvas);
                        <span class="keywordflow">return</span> <span class="keyword">true</span>;


                } <span class="keywordflow">else</span> {
                        $this-&gt;<a class="code" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a>(<span class="stringliteral">&#39;FAILED: $gd_border_canvas = phpthumb_functions::ImageCreateFunction(&#39;</span>.$output_width.<span class="stringliteral">&#39;, &#39;</span>.$output_height.<span class="charliteral">&#39;)&#39;</span>, __FILE__, __LINE__);
                }
                <span class="keywordflow">return</span> <span class="keyword">false</span>;
        }
</pre></div>
</div>
</div>
<a class="anchor" id="a64db4cefe2b067a8d7b684356b6c7c14"></a><!-- doxytag: member="phpthumb_filters::ImageTrueColorToPalette2" ref="a64db4cefe2b067a8d7b684356b6c7c14" args="(&amp;$image, $dither, $ncolors)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphpthumb__filters.html#a64db4cefe2b067a8d7b684356b6c7c14">ImageTrueColorToPalette2</a> </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>dither</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>ncolors</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l01031">1031</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>
<div class="fragment"><pre class="fragment">                                                                      {
                <span class="comment">// http://www.php.net/manual/en/function.imagetruecolortopalette.php</span>
                <span class="comment">// zmorris at zsculpt dot com (17-Aug-2004 06:58)</span>
                $width  = ImageSX($image);
                $height = ImageSY($image);
                $image_copy = ImageCreateTrueColor($width, $height);
                <span class="comment">//ImageCopyMerge($image_copy, $image, 0, 0, 0, 0, $width, $height, 100);</span>
                ImageCopy($image_copy, $image, 0, 0, 0, 0, $width, $height);
                ImageTrueColorToPalette($image, $dither, $ncolors);
                ImageColorMatch($image_copy, $image);
                ImageDestroy($image_copy);
                <span class="keywordflow">return</span> <span class="keyword">true</span>;
        }
</pre></div>
</div>
</div>
<a class="anchor" id="aa3a158b5772eeb4fb28f13973a9e82f5"></a><!-- doxytag: member="phpthumb_filters::ImprovedImageRotate" ref="aa3a158b5772eeb4fb28f13973a9e82f5" args="(&amp;$gdimg_source, $rotate_angle=0, $config_background_hexcolor='FFFFFF', $bg=null)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphpthumb__filters.html#aa3a158b5772eeb4fb28f13973a9e82f5">ImprovedImageRotate</a> </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>gdimg_source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>rotate_angle</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>config_background_hexcolor</em> = <code>'FFFFFF'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>bg</em> = <code>null</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l00737">737</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>
<div class="fragment"><pre class="fragment">                                                                                                                      {
                <span class="keywordflow">while</span> ($rotate_angle &lt; 0) {
                        $rotate_angle += 360;
                }
                $rotate_angle = $rotate_angle % 360;
                <span class="keywordflow">if</span> ($rotate_angle != 0) {

                        $background_color = <a class="code" href="classphpthumb__functions.html#a9a63d0b70df4136de64ab0cd351e7ff3">phpthumb_functions::ImageHexColorAllocate</a>($gdimg_source, $config_background_hexcolor);

                        <span class="keywordflow">if</span> ((<a class="code" href="classphpthumb__functions.html#aaaad487d4c5a61befc88ae061f8a64fe">phpthumb_functions::gd_version</a>() &gt;= 2) &amp;&amp; !$bg &amp;&amp; ($rotate_angle % 90)) {

                                <span class="comment">//$this-&gt;DebugMessage(&#39;Using alpha rotate&#39;, __FILE__, __LINE__);</span>
                                <span class="keywordflow">if</span> ($gdimg_rotate_mask = <a class="code" href="classphpthumb__functions.html#a02caac9e703a9c106e3fea3a6215130d">phpthumb_functions::ImageCreateFunction</a>(ImageSX($gdimg_source), ImageSY($gdimg_source))) {

                                        <span class="keywordflow">for</span> ($i = 0; $i &lt;= 255; $i++) {
                                                $color_mask[$i] = ImageColorAllocate($gdimg_rotate_mask, $i, $i, $i);
                                        }
                                        ImageFilledRectangle($gdimg_rotate_mask, 0, 0, ImageSX($gdimg_rotate_mask), ImageSY($gdimg_rotate_mask), $color_mask[255]);
                                        $imageX = ImageSX($gdimg_source);
                                        $imageY = ImageSY($gdimg_source);
                                        <span class="keywordflow">for</span> ($x = 0; $x &lt; $imageX; $x++) {
                                                <span class="keywordflow">for</span> ($y = 0; $y &lt; $imageY; $y++) {
                                                        $pixelcolor = <a class="code" href="classphpthumb__functions.html#ac73caf77553f599f9bdb88c03281b33b">phpthumb_functions::GetPixelColor</a>($gdimg_source, $x, $y);
                                                        ImageSetPixel($gdimg_rotate_mask, $x, $y, $color_mask[255 - round($pixelcolor[<span class="stringliteral">&#39;alpha&#39;</span>] * 255 / 127)]);
                                                }
                                        }
                                        $gdimg_rotate_mask  = ImageRotate($gdimg_rotate_mask,  $rotate_angle, $color_mask[0]);
                                        $gdimg_source = ImageRotate($gdimg_source, $rotate_angle, $background_color);

                                        ImageAlphaBlending($gdimg_source, <span class="keyword">false</span>);
                                        ImageSaveAlpha($gdimg_source, <span class="keyword">true</span>);
                                        <span class="comment">//$this-&gt;is_alpha = true;</span>
                                        $phpThumbFilters = <span class="keyword">new</span> <a class="code" href="classphpthumb__filters.html#afe54edab829027ca0b158c96bdd83ef1">phpthumb_filters</a>();
                                        $phpThumbFilters-&gt;phpThumbObject = $this;
                                        $phpThumbFilters-&gt;ApplyMask($gdimg_rotate_mask, $gdimg_source);

                                        ImageDestroy($gdimg_rotate_mask);

                                } <span class="keywordflow">else</span> {
                                        <span class="comment">//$this-&gt;DebugMessage(&#39;ImageCreateFunction() failed&#39;, __FILE__, __LINE__);</span>
                                }

                        } <span class="keywordflow">else</span> {

                                <span class="keywordflow">if</span> (<a class="code" href="classphpthumb__functions.html#aaaad487d4c5a61befc88ae061f8a64fe">phpthumb_functions::gd_version</a>() &lt; 2) {
                                        <span class="comment">//$this-&gt;DebugMessage(&#39;Using non-alpha rotate because gd_version is &quot;&#39;.phpthumb_functions::gd_version().&#39;&quot;&#39;, __FILE__, __LINE__);</span>
                                } <a class="code" href="php_thumb_8demo_8check_8php.html#af92779326267616cd7c3cdaaa9484bc9">elseif</a> ($bg) {
                                        <span class="comment">//$this-&gt;DebugMessage(&#39;Using non-alpha rotate because $this-&gt;bg is &quot;&#39;.$bg.&#39;&quot;&#39;, __FILE__, __LINE__);</span>
                                } <a class="code" href="php_thumb_8demo_8check_8php.html#af92779326267616cd7c3cdaaa9484bc9">elseif</a> ($rotate_angle % 90) {
                                        <span class="comment">//$this-&gt;DebugMessage(&#39;Using non-alpha rotate because ($rotate_angle % 90) = &quot;&#39;.($rotate_angle % 90).&#39;&quot;&#39;, __FILE__, __LINE__);</span>
                                } <span class="keywordflow">else</span> {
                                        <span class="comment">//$this-&gt;DebugMessage(&#39;Using non-alpha rotate because $this-&gt;thumbnailFormat is &quot;&#39;.$this-&gt;thumbnailFormat.&#39;&quot;&#39;, __FILE__, __LINE__);</span>
                                }

                                <span class="keywordflow">if</span> (ImageColorTransparent($gdimg_source) &gt;= 0) {
                                        <span class="comment">// ImageRotate() forgets all about an image&#39;s transparency and sets the transparent color to black</span>
                                        <span class="comment">// To compensate, flood-fill the transparent color of the source image with the specified background color first</span>
                                        <span class="comment">// then rotate and the colors should match</span>

                                        <span class="keywordflow">if</span> (!function_exists(<span class="stringliteral">&#39;ImageIsTrueColor&#39;</span>) || !ImageIsTrueColor($gdimg_source)) {
                                                <span class="comment">// convert paletted image to true-color before rotating to prevent nasty aliasing artifacts</span>

                                                <span class="comment">//$this-&gt;source_width  = ImageSX($gdimg_source);</span>
                                                <span class="comment">//$this-&gt;source_height = ImageSY($gdimg_source);</span>
                                                $gdimg_newsrc = <a class="code" href="classphpthumb__functions.html#a02caac9e703a9c106e3fea3a6215130d">phpthumb_functions::ImageCreateFunction</a>(ImageSX($gdimg_source), ImageSY($gdimg_source));
                                                $background_color = <a class="code" href="classphpthumb__functions.html#a9a63d0b70df4136de64ab0cd351e7ff3">phpthumb_functions::ImageHexColorAllocate</a>($gdimg_newsrc, $config_background_hexcolor);
                                                ImageFilledRectangle($gdimg_newsrc, 0, 0, ImageSX($gdimg_source), ImageSY($gdimg_source), <a class="code" href="classphpthumb__functions.html#a9a63d0b70df4136de64ab0cd351e7ff3">phpthumb_functions::ImageHexColorAllocate</a>($gdimg_newsrc, $config_background_hexcolor));
                                                ImageCopy($gdimg_newsrc, $gdimg_source, 0, 0, 0, 0, ImageSX($gdimg_source), ImageSY($gdimg_source));
                                                ImageDestroy($gdimg_source);
                                                unset($gdimg_source);
                                                $gdimg_source = $gdimg_newsrc;
                                                unset($gdimg_newsrc);

                                        } <span class="keywordflow">else</span> {

                                                ImageColorSet(
                                                        $gdimg_source,
                                                        ImageColorTransparent($gdimg_source),
                                                        hexdec(substr($config_background_hexcolor, 0, 2)),
                                                        hexdec(substr($config_background_hexcolor, 2, 2)),
                                                        hexdec(substr($config_background_hexcolor, 4, 2)));

                                                ImageColorTransparent($gdimg_source, -1);

                                        }
                                }

                                $gdimg_source = ImageRotate($gdimg_source, $rotate_angle, $background_color);

                        }
                }
                <span class="keywordflow">return</span> <span class="keyword">true</span>;
        }
</pre></div>
</div>
</div>
<a class="anchor" id="aaf6375de63265e2d032d90ef2d7771df"></a><!-- doxytag: member="phpthumb_filters::MeanRemoval" ref="aaf6375de63265e2d032d90ef2d7771df" args="(&amp;$gdimg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphpthumb__filters.html#aaf6375de63265e2d032d90ef2d7771df">MeanRemoval</a> </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>gdimg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l00832">832</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>
<div class="fragment"><pre class="fragment">                                      {
                <span class="keywordflow">if</span> (<a class="code" href="classphpthumb__functions.html#af53f41b3482e6bed2082daa0ebfd96c0">phpthumb_functions::version_compare_replacement</a>(phpversion(), <span class="stringliteral">&#39;5.0.0&#39;</span>, <span class="stringliteral">&#39;&gt;=&#39;</span>) &amp;&amp; <a class="code" href="classphpthumb__functions.html#adfd72c199df2f74f6daeda7c06a18cae">phpthumb_functions::gd_is_bundled</a>()) {
                        <span class="keywordflow">if</span> (ImageFilter($gdimg, IMG_FILTER_MEAN_REMOVAL)) {
                                <span class="keywordflow">return</span> <span class="keyword">true</span>;
                        }
                        $this-&gt;<a class="code" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a>(<span class="stringliteral">&#39;FAILED: ImageFilter($gdimg, IMG_FILTER_MEAN_REMOVAL)&#39;</span>, __FILE__, __LINE__);
                        <span class="comment">// fall through and try it the hard way</span>
                }
                <span class="comment">// currently not implemented &quot;the hard way&quot;</span>
                $this-&gt;<a class="code" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a>(<span class="stringliteral">&#39;FAILED: phpthumb_filters::MeanRemoval($gdimg) [function not implemented]&#39;</span>, __FILE__, __LINE__);
                <span class="keywordflow">return</span> <span class="keyword">false</span>;
        }
</pre></div>
</div>
</div>
<a class="anchor" id="a62cc8b7f2263af3eeefd434659c84ff8"></a><!-- doxytag: member="phpthumb_filters::Negative" ref="a62cc8b7f2263af3eeefd434659c84ff8" args="(&amp;$gdimg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphpthumb__filters.html#a62cc8b7f2263af3eeefd434659c84ff8">Negative</a> </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>gdimg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l00846">846</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>
<div class="fragment"><pre class="fragment">                                   {
                <span class="keywordflow">if</span> (<a class="code" href="classphpthumb__functions.html#af53f41b3482e6bed2082daa0ebfd96c0">phpthumb_functions::version_compare_replacement</a>(phpversion(), <span class="stringliteral">&#39;5.0.0&#39;</span>, <span class="stringliteral">&#39;&gt;=&#39;</span>) &amp;&amp; <a class="code" href="classphpthumb__functions.html#adfd72c199df2f74f6daeda7c06a18cae">phpthumb_functions::gd_is_bundled</a>()) {
                        <span class="keywordflow">if</span> (ImageFilter($gdimg, IMG_FILTER_NEGATE)) {
                                <span class="keywordflow">return</span> <span class="keyword">true</span>;
                        }
                        $this-&gt;<a class="code" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a>(<span class="stringliteral">&#39;FAILED: ImageFilter($gdimg, IMG_FILTER_NEGATE)&#39;</span>, __FILE__, __LINE__);
                        <span class="comment">// fall through and try it the hard way</span>
                }
                $ImageSX = ImageSX($gdimg);
                $ImageSY = ImageSY($gdimg);
                <span class="keywordflow">for</span> ($x = 0; $x &lt; $ImageSX; $x++) {
                        <span class="keywordflow">for</span> ($y = 0; $y &lt; $ImageSY; $y++) {
                                $currentPixel = <a class="code" href="classphpthumb__functions.html#ac73caf77553f599f9bdb88c03281b33b">phpthumb_functions::GetPixelColor</a>($gdimg, $x, $y);
                                $newColor = <a class="code" href="classphpthumb__functions.html#ab43fe1af0d0c46288c2ffcf3905a7b42">phpthumb_functions::ImageColorAllocateAlphaSafe</a>($gdimg, (~$currentPixel[<span class="stringliteral">&#39;red&#39;</span>] &amp; 0xFF), (~$currentPixel[<span class="stringliteral">&#39;green&#39;</span>] &amp; 0xFF), (~$currentPixel[<span class="stringliteral">&#39;blue&#39;</span>] &amp; 0xFF), $currentPixel[<span class="stringliteral">&#39;alpha&#39;</span>]);
                                ImageSetPixel($gdimg, $x, $y, $newColor);
                        }
                }
                <span class="keywordflow">return</span> <span class="keyword">true</span>;
        }
</pre></div>
</div>
</div>
<a class="anchor" id="afe54edab829027ca0b158c96bdd83ef1"></a><!-- doxytag: member="phpthumb_filters::phpthumb_filters" ref="afe54edab829027ca0b158c96bdd83ef1" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphpthumb__filters.html">phpthumb_filters</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l00015">15</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>
<div class="fragment"><pre class="fragment">                                    {
                <span class="keywordflow">return</span> <span class="keyword">true</span>;
        }
</pre></div>
</div>
</div>
<a class="anchor" id="a6a911baba07ff5d63b8f1c6718e0ed28"></a><!-- doxytag: member="phpthumb_filters::ReduceColorDepth" ref="a6a911baba07ff5d63b8f1c6718e0ed28" args="(&amp;$gdimg, $colors=256, $dither=true)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphpthumb__filters.html#a6a911baba07ff5d63b8f1c6718e0ed28">ReduceColorDepth</a> </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>gdimg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>colors</em> = <code>256</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>dither</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l01045">1045</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>
<div class="fragment"><pre class="fragment">                                                                      {
                $colors = max(min($colors, 256), 2);
                <span class="comment">// ImageTrueColorToPalette usually makes ugly colors, the replacement is a bit better</span>
                <span class="comment">//ImageTrueColorToPalette($gdimg, $dither, $colors);</span>
                <a class="code" href="classphpthumb__filters.html#a64db4cefe2b067a8d7b684356b6c7c14">phpthumb_filters::ImageTrueColorToPalette2</a>($gdimg, $dither, $colors);
                <span class="keywordflow">return</span> <span class="keyword">true</span>;
        }
</pre></div>
</div>
</div>
<a class="anchor" id="a8425970ef696ae1c8e420cc7718e7c9f"></a><!-- doxytag: member="phpthumb_filters::RoundedImageCorners" ref="a8425970ef696ae1c8e420cc7718e7c9f" args="(&amp;$gdimg, $radius_x, $radius_y)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphpthumb__filters.html#a8425970ef696ae1c8e420cc7718e7c9f">RoundedImageCorners</a> </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>gdimg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>radius_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>radius_y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l00867">867</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>
<div class="fragment"><pre class="fragment">                                                                    {
                <span class="comment">// generate mask at twice desired resolution and downsample afterwards for easy antialiasing</span>
                <span class="comment">// mask is generated as a white double-size elipse on a triple-size black background and copy-paste-resampled</span>
                <span class="comment">// onto a correct-size mask image as 4 corners due to errors when the entire mask is resampled at once (gray edges)</span>
                <span class="keywordflow">if</span> ($gdimg_cornermask_triple = <a class="code" href="classphpthumb__functions.html#a02caac9e703a9c106e3fea3a6215130d">phpthumb_functions::ImageCreateFunction</a>($radius_x * 6, $radius_y * 6)) {
                        <span class="keywordflow">if</span> ($gdimg_cornermask = <a class="code" href="classphpthumb__functions.html#a02caac9e703a9c106e3fea3a6215130d">phpthumb_functions::ImageCreateFunction</a>(ImageSX($gdimg), ImageSY($gdimg))) {

                                $color_transparent = ImageColorAllocate($gdimg_cornermask_triple, 255, 255, 255);
                                ImageFilledEllipse($gdimg_cornermask_triple, $radius_x * 3, $radius_y * 3, $radius_x * 4, $radius_y * 4, $color_transparent);

                                ImageFilledRectangle($gdimg_cornermask, 0, 0, ImageSX($gdimg), ImageSY($gdimg), $color_transparent);

                                ImageCopyResampled($gdimg_cornermask, $gdimg_cornermask_triple,                           0,                           0,     $radius_x,     $radius_y, $radius_x, $radius_y, $radius_x * 2, $radius_y * 2);
                                ImageCopyResampled($gdimg_cornermask, $gdimg_cornermask_triple,                           0, ImageSY($gdimg) - $radius_y,     $radius_x, $radius_y * 3, $radius_x, $radius_y, $radius_x * 2, $radius_y * 2);
                                ImageCopyResampled($gdimg_cornermask, $gdimg_cornermask_triple, ImageSX($gdimg) - $radius_x, ImageSY($gdimg) - $radius_y, $radius_x * 3, $radius_y * 3, $radius_x, $radius_y, $radius_x * 2, $radius_y * 2);
                                ImageCopyResampled($gdimg_cornermask, $gdimg_cornermask_triple, ImageSX($gdimg) - $radius_x,                           0, $radius_x * 3,     $radius_y, $radius_x, $radius_y, $radius_x * 2, $radius_y * 2);

                                <a class="code" href="classphpthumb__filters.html#a1d26d503a63b41fe2f6d6c6c22c2f977">phpthumb_filters::ApplyMask</a>($gdimg_cornermask, $gdimg);
                                ImageDestroy($gdimg_cornermask);
                                $this-&gt;<a class="code" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a>(<span class="stringliteral">&#39;RoundedImageCorners(&#39;</span>.$radius_x.<span class="stringliteral">&#39;, &#39;</span>.$radius_y.<span class="stringliteral">&#39;) succeeded&#39;</span>, __FILE__, __LINE__);
                                <span class="keywordflow">return</span> <span class="keyword">true</span>;

                        } <span class="keywordflow">else</span> {
                                $this-&gt;<a class="code" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a>(<span class="stringliteral">&#39;FAILED: $gdimg_cornermask = phpthumb_functions::ImageCreateFunction(&#39;</span>.ImageSX($gdimg).<span class="stringliteral">&#39;, &#39;</span>.ImageSY($gdimg).<span class="charliteral">&#39;)&#39;</span>, __FILE__, __LINE__);
                        }
                        ImageDestroy($gdimg_cornermask_triple);

                } <span class="keywordflow">else</span> {
                        $this-&gt;<a class="code" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a>(<span class="stringliteral">&#39;FAILED: $gdimg_cornermask_triple = phpthumb_functions::ImageCreateFunction(&#39;</span>.($radius_x * 6).<span class="stringliteral">&#39;, &#39;</span>.($radius_y * 6).<span class="charliteral">&#39;)&#39;</span>, __FILE__, __LINE__);
                }
                <span class="keywordflow">return</span> <span class="keyword">false</span>;
        }
</pre></div>
</div>
</div>
<a class="anchor" id="a861290ddb5fcd73734a327fbd883fa9d"></a><!-- doxytag: member="phpthumb_filters::Saturation" ref="a861290ddb5fcd73734a327fbd883fa9d" args="(&amp;$gdimg, $amount, $color='')" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphpthumb__filters.html#a861290ddb5fcd73734a327fbd883fa9d">Saturation</a> </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>gdimg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>amount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>color</em> = <code>''</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l00901">901</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>
<div class="fragment"><pre class="fragment">                                                         {
                <span class="keywordflow">if</span> ($amount == 0) {
                        <span class="keywordflow">return</span> <span class="keyword">true</span>;
                } <a class="code" href="php_thumb_8demo_8check_8php.html#af92779326267616cd7c3cdaaa9484bc9">elseif</a> ($amount &gt; 0) {
                        $amount = 0 - $amount;
                } <span class="keywordflow">else</span> {
                        $amount = abs($amount);
                }
                <span class="keywordflow">return</span> <a class="code" href="classphpthumb__filters.html#ad3b8f01262de4fbbcfd011e3e5beeb6b">phpthumb_filters::Desaturate</a>($gdimg, $amount, $color);
        }
</pre></div>
</div>
</div>
<a class="anchor" id="aebd2067d17409638a17de18089628f6d"></a><!-- doxytag: member="phpthumb_filters::Sepia" ref="aebd2067d17409638a17de18089628f6d" args="(&amp;$gdimg, $amount, $targetColor)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphpthumb__filters.html#aebd2067d17409638a17de18089628f6d">Sepia</a> </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>gdimg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>amount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>targetColor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l00913">913</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>
<div class="fragment"><pre class="fragment">                                                       {
                $amount      = (is_numeric($amount) ? max(0, min(100, $amount)) : 50);
                $amountPct   = $amount / 100;
                $targetColor = (<a class="code" href="classphpthumb__functions.html#aa88047663adfed917d5fb0bece3913b8">phpthumb_functions::IsHexColor</a>($targetColor) ? $targetColor : <span class="stringliteral">&#39;A28065&#39;</span>);

                <span class="keywordflow">if</span> ($amount == 0) {
                        <span class="keywordflow">return</span> <span class="keyword">true</span>;
                }

                <span class="keywordflow">if</span> (<a class="code" href="classphpthumb__functions.html#af53f41b3482e6bed2082daa0ebfd96c0">phpthumb_functions::version_compare_replacement</a>(phpversion(), <span class="stringliteral">&#39;5.0.0&#39;</span>, <span class="stringliteral">&#39;&gt;=&#39;</span>) &amp;&amp; <a class="code" href="classphpthumb__functions.html#adfd72c199df2f74f6daeda7c06a18cae">phpthumb_functions::gd_is_bundled</a>()) {
                        <span class="keywordflow">if</span> (ImageFilter($gdimg, IMG_FILTER_GRAYSCALE)) {

                                $r = round($amountPct * hexdec(substr($targetColor, 0, 2)));
                                $g = round($amountPct * hexdec(substr($targetColor, 2, 2)));
                                $b = round($amountPct * hexdec(substr($targetColor, 4, 2)));
                                <span class="keywordflow">if</span> (ImageFilter($gdimg, IMG_FILTER_COLORIZE, $r, $g, $b)) {
                                        <span class="keywordflow">return</span> <span class="keyword">true</span>;
                                }
                                $this-&gt;<a class="code" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a>(<span class="stringliteral">&#39;FAILED: ImageFilter($gdimg, IMG_FILTER_COLORIZE)&#39;</span>, __FILE__, __LINE__);
                                <span class="comment">// fall through and try it the hard way</span>

                        } <span class="keywordflow">else</span> {

                                $this-&gt;<a class="code" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a>(<span class="stringliteral">&#39;FAILED: ImageFilter($gdimg, IMG_FILTER_GRAYSCALE)&#39;</span>, __FILE__, __LINE__);
                                <span class="comment">// fall through and try it the hard way</span>

                        }
                }

                $TargetPixel[<span class="stringliteral">&#39;red&#39;</span>]   = hexdec(substr($targetColor, 0, 2));
                $TargetPixel[<span class="stringliteral">&#39;green&#39;</span>] = hexdec(substr($targetColor, 2, 2));
                $TargetPixel[<span class="stringliteral">&#39;blue&#39;</span>]  = hexdec(substr($targetColor, 4, 2));

                $ImageSX = ImageSX($gdimg);
                $ImageSY = ImageSY($gdimg);
                <span class="keywordflow">for</span> ($x = 0; $x &lt; $ImageSX; $x++) {
                        <span class="keywordflow">for</span> ($y = 0; $y &lt; $ImageSY; $y++) {
                                $OriginalPixel = <a class="code" href="classphpthumb__functions.html#ac73caf77553f599f9bdb88c03281b33b">phpthumb_functions::GetPixelColor</a>($gdimg, $x, $y);
                                $GrayPixel = <a class="code" href="classphpthumb__functions.html#a5f3d1f38c5a6c3a5b83a8f96042ffef5">phpthumb_functions::GrayscalePixel</a>($OriginalPixel);

                                <span class="comment">// http://www.gimpguru.org/Tutorials/SepiaToning/</span>
                                <span class="comment">// &quot;In the traditional sepia toning process, the tinting occurs most in</span>
                                <span class="comment">// the mid-tones: the lighter and darker areas appear to be closer to B&amp;W.&quot;</span>
                                $SepiaAmount = ((128 - abs($GrayPixel[<span class="stringliteral">&#39;red&#39;</span>] - 128)) / 128) * $amountPct;

                                <span class="keywordflow">foreach</span> ($TargetPixel as $key =&gt; $value) {
                                        $NewPixel[$key] = round(max(0, min(255, $GrayPixel[$key] * (1 - $SepiaAmount) + ($TargetPixel[$key] * $SepiaAmount))));
                                }
                                $newColor = <a class="code" href="classphpthumb__functions.html#ab43fe1af0d0c46288c2ffcf3905a7b42">phpthumb_functions::ImageColorAllocateAlphaSafe</a>($gdimg, $NewPixel[<span class="stringliteral">&#39;red&#39;</span>], $NewPixel[<span class="stringliteral">&#39;green&#39;</span>], $NewPixel[<span class="stringliteral">&#39;blue&#39;</span>], $OriginalPixel[<span class="stringliteral">&#39;alpha&#39;</span>]);
                                ImageSetPixel($gdimg, $x, $y, $newColor);
                        }
                }
                <span class="keywordflow">return</span> <span class="keyword">true</span>;
        }
</pre></div>
</div>
</div>
<a class="anchor" id="a7b9388a8ff19eb5a2b441aba78fabf57"></a><!-- doxytag: member="phpthumb_filters::Smooth" ref="a7b9388a8ff19eb5a2b441aba78fabf57" args="(&amp;$gdimg, $amount=6)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphpthumb__filters.html#a7b9388a8ff19eb5a2b441aba78fabf57">Smooth</a> </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>gdimg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>amount</em> = <code>6</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l00969">969</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>
<div class="fragment"><pre class="fragment">                                            {
                $amount = min(25, max(0, $amount));
                <span class="keywordflow">if</span> ($amount == 0) {
                        <span class="keywordflow">return</span> <span class="keyword">true</span>;
                }
                <span class="keywordflow">if</span> (<a class="code" href="classphpthumb__functions.html#af53f41b3482e6bed2082daa0ebfd96c0">phpthumb_functions::version_compare_replacement</a>(phpversion(), <span class="stringliteral">&#39;5.0.0&#39;</span>, <span class="stringliteral">&#39;&gt;=&#39;</span>) &amp;&amp; <a class="code" href="classphpthumb__functions.html#adfd72c199df2f74f6daeda7c06a18cae">phpthumb_functions::gd_is_bundled</a>()) {
                        <span class="keywordflow">if</span> (ImageFilter($gdimg, IMG_FILTER_SMOOTH, $amount)) {
                                <span class="keywordflow">return</span> <span class="keyword">true</span>;
                        }
                        $this-&gt;<a class="code" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a>(<span class="stringliteral">&#39;FAILED: ImageFilter($gdimg, IMG_FILTER_SMOOTH, &#39;</span>.$amount.<span class="charliteral">&#39;)&#39;</span>, __FILE__, __LINE__);
                        <span class="comment">// fall through and try it the hard way</span>
                }
                <span class="comment">// currently not implemented &quot;the hard way&quot;</span>
                $this-&gt;<a class="code" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a>(<span class="stringliteral">&#39;FAILED: phpthumb_filters::Smooth($gdimg, &#39;</span>.$amount.<span class="stringliteral">&#39;) [function not implemented]&#39;</span>, __FILE__, __LINE__);
                <span class="keywordflow">return</span> <span class="keyword">false</span>;
        }
</pre></div>
</div>
</div>
<a class="anchor" id="ad4c44b13cfa064b7b1adcc14db883745"></a><!-- doxytag: member="phpthumb_filters::SourceTransparentColorMask" ref="ad4c44b13cfa064b7b1adcc14db883745" args="(&amp;$gdimg, $hexcolor, $min_limit=5, $max_limit=10)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphpthumb__filters.html#ad4c44b13cfa064b7b1adcc14db883745">SourceTransparentColorMask</a> </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>gdimg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>hexcolor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>min_limit</em> = <code>5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>max_limit</em> = <code>10</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l00987">987</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>
<div class="fragment"><pre class="fragment">                                                                                             {
                $width  = ImageSX($gdimg);
                $height = ImageSY($gdimg);
                <span class="keywordflow">if</span> ($gdimg_mask = ImageCreateTrueColor($width, $height)) {
                        $R = hexdec(substr($hexcolor, 0, 2));
                        $G = hexdec(substr($hexcolor, 2, 2));
                        $B = hexdec(substr($hexcolor, 4, 2));
                        $targetPixel = array(<span class="stringliteral">&#39;red&#39;</span>=&gt;$R, <span class="stringliteral">&#39;green&#39;</span>=&gt;$G, <span class="stringliteral">&#39;blue&#39;</span>=&gt;$B);
                        $cutoffRange = $max_limit - $min_limit;
                        <span class="keywordflow">for</span> ($x = 0; $x &lt; $width; $x++) {
                                <span class="keywordflow">for</span> ($y = 0; $y &lt; $height; $y++) {
                                        $currentPixel = <a class="code" href="classphpthumb__functions.html#ac73caf77553f599f9bdb88c03281b33b">phpthumb_functions::GetPixelColor</a>($gdimg, $x, $y);
                                        $colorDiff = <a class="code" href="classphpthumb__functions.html#a21903a1bd6f92685f0c3188c9776801a">phpthumb_functions::PixelColorDifferencePercent</a>($currentPixel, $targetPixel);
                                        $grayLevel = min($cutoffRange, MAX(0, -$min_limit + $colorDiff)) * (255 / MAX(1, $cutoffRange));
                                        $newColor = ImageColorAllocate($gdimg_mask, $grayLevel, $grayLevel, $grayLevel);
                                        ImageSetPixel($gdimg_mask, $x, $y, $newColor);
                                }
                        }
                        <span class="keywordflow">return</span> $gdimg_mask;
                }
                <span class="keywordflow">return</span> <span class="keyword">false</span>;
        }
</pre></div>
</div>
</div>
<a class="anchor" id="ae3154ed46062f29561e7be86f2559b1c"></a><!-- doxytag: member="phpthumb_filters::Threshold" ref="ae3154ed46062f29561e7be86f2559b1c" args="(&amp;$gdimg, $cutoff)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphpthumb__filters.html#ae3154ed46062f29561e7be86f2559b1c">Threshold</a> </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>gdimg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>cutoff</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l01011">1011</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>
<div class="fragment"><pre class="fragment">                                             {
                $width  = ImageSX($gdimg);
                $height = ImageSY($gdimg);
                $cutoff = min(255, max(0, ($cutoff ? $cutoff : 128)));
                <span class="keywordflow">for</span> ($x = 0; $x &lt; $width; $x++) {
                        <span class="keywordflow">for</span> ($y = 0; $y &lt; $height; $y++) {
                                $currentPixel = <a class="code" href="classphpthumb__functions.html#ac73caf77553f599f9bdb88c03281b33b">phpthumb_functions::GetPixelColor</a>($gdimg, $x, $y);
                                $grayPixel = <a class="code" href="classphpthumb__functions.html#a5f3d1f38c5a6c3a5b83a8f96042ffef5">phpthumb_functions::GrayscalePixel</a>($currentPixel);
                                <span class="keywordflow">if</span> ($grayPixel[<span class="stringliteral">&#39;red&#39;</span>] &lt; $cutoff) {
                                        $newColor = <a class="code" href="classphpthumb__functions.html#ab43fe1af0d0c46288c2ffcf3905a7b42">phpthumb_functions::ImageColorAllocateAlphaSafe</a>($gdimg, 0x00, 0x00, 0x00, $currentPixel[<span class="stringliteral">&#39;alpha&#39;</span>]);
                                } <span class="keywordflow">else</span> {
                                        $newColor = <a class="code" href="classphpthumb__functions.html#ab43fe1af0d0c46288c2ffcf3905a7b42">phpthumb_functions::ImageColorAllocateAlphaSafe</a>($gdimg, 0xFF, 0xFF, 0xFF, $currentPixel[<span class="stringliteral">&#39;alpha&#39;</span>]);
                                }
                                ImageSetPixel($gdimg, $x, $y, $newColor);
                        }
                }
                <span class="keywordflow">return</span> <span class="keyword">true</span>;
        }
</pre></div>
</div>
</div>
<a class="anchor" id="a31079a470f5697b85aad5855f5c614fc"></a><!-- doxytag: member="phpthumb_filters::WatermarkOverlay" ref="a31079a470f5697b85aad5855f5c614fc" args="(&amp;$gdimg_dest, &amp;$img_watermark, $alignment='*', $opacity=50, $margin_x=5, $margin_y=null)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphpthumb__filters.html#a31079a470f5697b85aad5855f5c614fc">WatermarkOverlay</a> </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>gdimg_dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>img_watermark</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>alignment</em> = <code>'*'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>opacity</em> = <code>50</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>margin_x</em> = <code>5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>margin_y</em> = <code>null</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l01403">1403</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>
<div class="fragment"><pre class="fragment">                                                                                                                           {

                <span class="keywordflow">if</span> (is_resource($gdimg_dest) &amp;&amp; is_resource($img_watermark)) {
                        $watermark_source_x        = 0;
                        $watermark_source_y        = 0;
                        $img_source_width          = ImageSX($gdimg_dest);
                        $img_source_height         = ImageSY($gdimg_dest);
                        $watermark_source_width    = ImageSX($img_watermark);
                        $watermark_source_height   = ImageSY($img_watermark);
                        $watermark_opacity_percent = max(0, min(100, $opacity));
                        $margin_y = (is_null($margin_y) ? $margin_x : $margin_y);
                        $watermark_margin_x = ((($margin_x &gt; 0) &amp;&amp; ($margin_x &lt; 1)) ? round((1 - $margin_x) * $img_source_width)  : $margin_x);
                        $watermark_margin_y = ((($margin_y &gt; 0) &amp;&amp; ($margin_y &lt; 1)) ? round((1 - $margin_y) * $img_source_height) : $margin_y);
                        <span class="keywordflow">if</span> (eregi(<span class="stringliteral">&#39;^([0-9\\.\\-]*)x([0-9\\.\\-]*)$&#39;</span>, $alignment, $matches)) {
                                $watermark_destination_x = intval($matches[1]);
                                $watermark_destination_y = intval($matches[2]);
                        } <span class="keywordflow">else</span> {
                                <span class="keywordflow">switch</span> ($alignment) {
                                        <span class="keywordflow">case</span> <span class="charliteral">&#39;*&#39;</span>:
                                                <span class="keywordflow">if</span> ($gdimg_tiledwatermark = <a class="code" href="classphpthumb__functions.html#a02caac9e703a9c106e3fea3a6215130d">phpthumb_functions::ImageCreateFunction</a>($img_source_width, $img_source_height)) {

                                                        ImageAlphaBlending($gdimg_tiledwatermark, <span class="keyword">false</span>);
                                                        ImageSaveAlpha($gdimg_tiledwatermark, <span class="keyword">true</span>);
                                                        $text_color_transparent = <a class="code" href="classphpthumb__functions.html#ab43fe1af0d0c46288c2ffcf3905a7b42">phpthumb_functions::ImageColorAllocateAlphaSafe</a>($gdimg_tiledwatermark, 255, 0, 255, 127);
                                                        ImageFill($gdimg_tiledwatermark, 0, 0, $text_color_transparent);

                                                        <span class="comment">// set the tiled image transparent color to whatever the untiled image transparency index is</span>
        <span class="comment">//                                              ImageColorTransparent($gdimg_tiledwatermark, ImageColorTransparent($img_watermark));</span>

                                                        <span class="comment">// a &quot;cleaner&quot; way of doing it, but can&#39;t handle the margin feature :(</span>
        <span class="comment">//                                              ImageSetTile($gdimg_tiledwatermark, $img_watermark);</span>
        <span class="comment">//                                              ImageFill($gdimg_tiledwatermark, 0, 0, IMG_COLOR_TILED);</span>
        <span class="comment">//                                              break;</span>

        <span class="comment">//                                              ImageFill($gdimg_tiledwatermark, 0, 0, ImageColorTransparent($gdimg_tiledwatermark));</span>
                                                        <span class="comment">// tile the image as many times as can fit</span>
                                                        <span class="keywordflow">for</span> ($x = $watermark_margin_x; $x &lt; ($img_source_width + $watermark_source_width); $x += ($watermark_source_width + $watermark_margin_x)) {
                                                                <span class="keywordflow">for</span> ($y = $watermark_margin_y; $y &lt; ($img_source_height + $watermark_source_height); $y += ($watermark_source_height + $watermark_margin_y)) {
                                                                        ImageCopy(
                                                                                $gdimg_tiledwatermark,
                                                                                $img_watermark,
                                                                                $x,
                                                                                $y,
                                                                                0,
                                                                                0,
                                                                                min($watermark_source_width,  $img_source_width  - $x - $watermark_margin_x),
                                                                                min($watermark_source_height, $img_source_height - $y - $watermark_margin_y)
                                                                        );
                                                                }
                                                        }

                                                        $watermark_source_width  = ImageSX($gdimg_tiledwatermark);
                                                        $watermark_source_height = ImageSY($gdimg_tiledwatermark);
                                                        $watermark_destination_x = 0;
                                                        $watermark_destination_y = 0;

                                                        ImageDestroy($img_watermark);
                                                        $img_watermark = $gdimg_tiledwatermark;
                                                }
                                                <span class="keywordflow">break</span>;

                                        <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>:
                                                $watermark_destination_x = round((($img_source_width  / 2) - ($watermark_source_width / 2)) + $watermark_margin_x);
                                                $watermark_destination_y = $watermark_margin_y;
                                                <span class="keywordflow">break</span>;

                                        <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>:
                                                $watermark_destination_x = round((($img_source_width  / 2) - ($watermark_source_width / 2)) + $watermark_margin_x);
                                                $watermark_destination_y = $img_source_height - $watermark_source_height - $watermark_margin_y;
                                                <span class="keywordflow">break</span>;

                                        <span class="keywordflow">case</span> <span class="charliteral">&#39;L&#39;</span>:
                                                $watermark_destination_x = $watermark_margin_x;
                                                $watermark_destination_y = round((($img_source_height / 2) - ($watermark_source_height / 2)) + $watermark_margin_y);
                                                <span class="keywordflow">break</span>;

                                        <span class="keywordflow">case</span> <span class="charliteral">&#39;R&#39;</span>:
                                                $watermark_destination_x = $img_source_width - $watermark_source_width - $watermark_margin_x;
                                                $watermark_destination_y = round((($img_source_height / 2) - ($watermark_source_height / 2)) + $watermark_margin_y);
                                                <span class="keywordflow">break</span>;

                                        <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>:
                                                $watermark_destination_x = round(($img_source_width  / 2) - ($watermark_source_width  / 2));
                                                $watermark_destination_y = round(($img_source_height / 2) - ($watermark_source_height / 2));
                                                <span class="keywordflow">break</span>;

                                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;TL&#39;</span>:
                                                $watermark_destination_x = $watermark_margin_x;
                                                $watermark_destination_y = $watermark_margin_y;
                                                <span class="keywordflow">break</span>;

                                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;TR&#39;</span>:
                                                $watermark_destination_x = $img_source_width - $watermark_source_width - $watermark_margin_x;
                                                $watermark_destination_y = $watermark_margin_y;
                                                <span class="keywordflow">break</span>;

                                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;BL&#39;</span>:
        <span class="comment">//echo &#39;&lt;pre&gt;&#39;;</span>
<span class="comment"></span>        <span class="comment">//var_dump($watermark_margin_x);</span>
        <span class="comment">//var_dump($img_source_height);</span>
        <span class="comment">//var_dump($watermark_source_height);</span>
        <span class="comment">//var_dump($watermark_margin_y);</span>
                                                $watermark_destination_x = $watermark_margin_x;
                                                $watermark_destination_y = $img_source_height - $watermark_source_height - $watermark_margin_y;
                                                <span class="keywordflow">break</span>;

                                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;BR&#39;</span>:
                                        <span class="keywordflow">default</span>:
                                                $watermark_destination_x = $img_source_width  - $watermark_source_width  - $watermark_margin_x;
                                                $watermark_destination_y = $img_source_height - $watermark_source_height - $watermark_margin_y;
                                                <span class="keywordflow">break</span>;
                                }
                        }
                        ImageAlphaBlending($gdimg_dest, <span class="keyword">false</span>);
                        ImageSaveAlpha($gdimg_dest, <span class="keyword">true</span>);
                        ImageSaveAlpha($img_watermark, <span class="keyword">true</span>);
                        <a class="code" href="classphpthumb__functions.html#a3b35e57dd6a7b582dc71d5da44468455">phpthumb_functions::ImageCopyRespectAlpha</a>($gdimg_dest, $img_watermark, $watermark_destination_x, $watermark_destination_y, 0, 0, $watermark_source_width, $watermark_source_height, $watermark_opacity_percent);

                        <span class="keywordflow">return</span> <span class="keyword">true</span>;
                }
                <span class="keywordflow">return</span> <span class="keyword">false</span>;
        }
</pre></div>
</div>
</div>
<a class="anchor" id="aa7c3c6393587a04c965fca12a81163c6"></a><!-- doxytag: member="phpthumb_filters::WatermarkText" ref="aa7c3c6393587a04c965fca12a81163c6" args="(&amp;$gdimg, $text, $size, $alignment, $hex_color='000000', $ttffont='', $opacity=100, $margin=5, $angle=0, $bg_color=false, $bg_opacity=0, $fillextend='')" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphpthumb__filters.html#aa7c3c6393587a04c965fca12a81163c6">WatermarkText</a> </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>gdimg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>alignment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>hex_color</em> = <code>'000000'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>ttffont</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>opacity</em> = <code>100</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>margin</em> = <code>5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>angle</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>bg_color</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>bg_opacity</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>fillextend</em> = <code>''</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l01091">1091</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>
<div class="fragment"><pre class="fragment">                                                                                                                                                                                       {
                <span class="comment">// text watermark requested</span>
                <span class="keywordflow">if</span> (!$text) {
                        <span class="keywordflow">return</span> <span class="keyword">false</span>;
                }
                ImageAlphaBlending($gdimg, <span class="keyword">true</span>);

                <span class="keywordflow">if</span> (eregi(<span class="stringliteral">&#39;^([0-9\\.\\-]*)x([0-9\\.\\-]*)(@[LCR])?$&#39;</span>, $alignment, $matches)) {
                        $originOffsetX = intval($matches[1]);
                        $originOffsetY = intval($matches[2]);
                        $alignment = (@$matches[4] ? $matches[4] : <span class="charliteral">&#39;L&#39;</span>);
                        $margin = 0;
                } <span class="keywordflow">else</span> {
                        $originOffsetX = 0;
                        $originOffsetY = 0;
                }

                $metaTextArray = array(
                        <span class="stringliteral">&#39;^Fb&#39;</span> =&gt;       $this-&gt;phpThumbObject-&gt;getimagesizeinfo[<span class="stringliteral">&#39;filesize&#39;</span>],
                        <span class="stringliteral">&#39;^Fk&#39;</span> =&gt; round($this-&gt;phpThumbObject-&gt;getimagesizeinfo[<span class="stringliteral">&#39;filesize&#39;</span>] / 1024),
                        <span class="stringliteral">&#39;^Fm&#39;</span> =&gt; round($this-&gt;phpThumbObject-&gt;getimagesizeinfo[<span class="stringliteral">&#39;filesize&#39;</span>] / 1048576),
                        <span class="stringliteral">&#39;^X&#39;</span>  =&gt; $this-&gt;phpThumbObject-&gt;getimagesizeinfo[0],
                        <span class="stringliteral">&#39;^Y&#39;</span>  =&gt; $this-&gt;phpThumbObject-&gt;getimagesizeinfo[1],
                        <span class="stringliteral">&#39;^x&#39;</span>  =&gt; ImageSX($gdimg),
                        <span class="stringliteral">&#39;^y&#39;</span>  =&gt; ImageSY($gdimg),
                        <span class="stringliteral">&#39;^^&#39;</span>  =&gt; <span class="charliteral">&#39;^&#39;</span>,
                );
                $text = strtr($text, $metaTextArray);

                $text = str_replace(<span class="stringliteral">&quot;\r\n&quot;</span>, <span class="stringliteral">&quot;\n&quot;</span>, $text);
                $text = str_replace(<span class="stringliteral">&quot;\r&quot;</span>,   <span class="stringliteral">&quot;\n&quot;</span>, $text);
                $textlines = explode(<span class="stringliteral">&quot;\n&quot;</span>, $text);
                $this-&gt;<a class="code" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a>(<span class="stringliteral">&#39;Processing &#39;</span>.count($textlines).<span class="stringliteral">&#39; lines of text&#39;</span>, __FILE__, __LINE__);

                <span class="keywordflow">if</span> (@is_readable($ttffont) &amp;&amp; is_file($ttffont)) {

                        $opacity = 100 - intval(max(min($opacity, 100), 0));
                        $letter_color_text = <a class="code" href="classphpthumb__functions.html#a9a63d0b70df4136de64ab0cd351e7ff3">phpthumb_functions::ImageHexColorAllocate</a>($gdimg, $hex_color, <span class="keyword">false</span>, $opacity * 1.27);

                        $this-&gt;<a class="code" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a>(<span class="stringliteral">&#39;Using TTF font &quot;&#39;</span>.$ttffont.<span class="charliteral">&#39;&quot;&#39;</span>, __FILE__, __LINE__);

                        $TTFbox = ImageTTFbBox($size, $angle, $ttffont, $text);

                        $min_x = min($TTFbox[0], $TTFbox[2], $TTFbox[4], $TTFbox[6]);
                        $max_x = max($TTFbox[0], $TTFbox[2], $TTFbox[4], $TTFbox[6]);
                        <span class="comment">//$text_width = round($max_x - $min_x + ($size * 0.5));</span>
                        $text_width = round($max_x - $min_x);

                        $min_y = min($TTFbox[1], $TTFbox[3], $TTFbox[5], $TTFbox[7]);
                        $max_y = max($TTFbox[1], $TTFbox[3], $TTFbox[5], $TTFbox[7]);
                        <span class="comment">//$text_height = round($max_y - $min_y + ($size * 0.5));</span>
                        $text_height = round($max_y - $min_y);

                        $TTFboxChar = ImageTTFbBox($size, $angle, $ttffont, <span class="stringliteral">&#39;jH&#39;</span>);
                        $char_min_y = min($TTFboxChar[1], $TTFboxChar[3], $TTFboxChar[5], $TTFboxChar[7]);
                        $char_max_y = max($TTFboxChar[1], $TTFboxChar[3], $TTFboxChar[5], $TTFboxChar[7]);
                        $char_height = round($char_max_y - $char_min_y);

                        <span class="keywordflow">if</span> ($alignment == <span class="charliteral">&#39;*&#39;</span>) {

                                $text_origin_y = $char_height + $margin;
                                <span class="keywordflow">while</span> (($text_origin_y - $text_height) &lt; ImageSY($gdimg)) {
                                        $text_origin_x = $margin;
                                        <span class="keywordflow">while</span> ($text_origin_x &lt; ImageSX($gdimg)) {
                                                ImageTTFtext($gdimg, $size, $angle, $text_origin_x, $text_origin_y, $letter_color_text, $ttffont, $text);
                                                $text_origin_x += ($text_width + $margin);
                                        }
                                        $text_origin_y += ($text_height + $margin);
                                }

                        } <span class="keywordflow">else</span> {

                                <span class="comment">// this block for background color only</span>

                                <span class="keywordflow">switch</span> ($alignment) {
                                        <span class="keywordflow">case</span> <span class="charliteral">&#39;*&#39;</span>:
                                                <span class="comment">// handled separately</span>
                                                <span class="keywordflow">break</span>;

                                        <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>:
                                                $text_origin_x = ($originOffsetX ? $originOffsetX - round($text_width / 2) : round((ImageSX($gdimg) - $text_width) / 2));
                                                $text_origin_y = $char_height + $margin + $originOffsetY;
                                                <span class="keywordflow">break</span>;

                                        <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>:
                                                $text_origin_x = ($originOffsetX ? $originOffsetX - round($text_width / 2) : round((ImageSX($gdimg) - $text_width) / 2));
                                                $text_origin_y = ImageSY($gdimg) + $TTFbox[1] - $margin + $originOffsetY;
                                                <span class="keywordflow">break</span>;

                                        <span class="keywordflow">case</span> <span class="charliteral">&#39;L&#39;</span>:
                                                $text_origin_x = $margin + $originOffsetX;
                                                $text_origin_y = ($originOffsetY ? $originOffsetY : round((ImageSY($gdimg) - $text_height) / 2) + $char_height);
                                                <span class="keywordflow">break</span>;

                                        <span class="keywordflow">case</span> <span class="charliteral">&#39;R&#39;</span>:
                                                $text_origin_x = ($originOffsetX ? $originOffsetX - $text_width : ImageSX($gdimg) - $text_width  + $TTFbox[0] - $min_x + round($size * 0.25) - $margin);
                                                $text_origin_y = ($originOffsetY ? $originOffsetY : round((ImageSY($gdimg) - $text_height) / 2) + $char_height);
                                                <span class="keywordflow">break</span>;

                                        <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>:
                                                $text_origin_x = ($originOffsetX ? $originOffsetX - round($text_width / 2) : round((ImageSX($gdimg) - $text_width) / 2));
                                                $text_origin_y = ($originOffsetY ? $originOffsetY : round((ImageSY($gdimg) - $text_height) / 2) + $char_height);
                                                <span class="keywordflow">break</span>;

                                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;TL&#39;</span>:
                                                $text_origin_x = $margin + $originOffsetX;
                                                $text_origin_y = $char_height + $margin + $originOffsetY;
                                                <span class="keywordflow">break</span>;

                                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;TR&#39;</span>:
                                                $text_origin_x = ($originOffsetX ? $originOffsetX - $text_width : ImageSX($gdimg) - $text_width  + $TTFbox[0] - $min_x + round($size * 0.25) - $margin);
                                                $text_origin_y = $char_height + $margin + $originOffsetY;
                                                <span class="keywordflow">break</span>;

                                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;BL&#39;</span>:
                                                $text_origin_x = $margin + $originOffsetX;
                                                $text_origin_y = ImageSY($gdimg) + $TTFbox[1] - $margin + $originOffsetY;
                                                <span class="keywordflow">break</span>;

                                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;BR&#39;</span>:
                                        <span class="keywordflow">default</span>:
                                                $text_origin_x = ($originOffsetX ? $originOffsetX - $text_width : ImageSX($gdimg) - $text_width  + $TTFbox[0] - $min_x + round($size * 0.25) - $margin);
                                                $text_origin_y = ImageSY($gdimg) + $TTFbox[1] - $margin + $originOffsetY;
                                                <span class="keywordflow">break</span>;
                                }

                                <span class="comment">//ImageRectangle($gdimg, $text_origin_x + $min_x, $text_origin_y + $TTFbox[1], $text_origin_x + $min_x + $text_width, $text_origin_y + $TTFbox[1] - $text_height, $letter_color_text);</span>
                                <span class="keywordflow">if</span> (<a class="code" href="classphpthumb__functions.html#aa88047663adfed917d5fb0bece3913b8">phpthumb_functions::IsHexColor</a>($bg_color)) {
                                        $text_background_alpha = round(127 * ((100 - min(max(0, $bg_opacity), 100)) / 100));
                                        $text_color_background = <a class="code" href="classphpthumb__functions.html#a9a63d0b70df4136de64ab0cd351e7ff3">phpthumb_functions::ImageHexColorAllocate</a>($gdimg, $bg_color, <span class="keyword">false</span>, $text_background_alpha);
                                } <span class="keywordflow">else</span> {
                                        $text_color_background = <a class="code" href="classphpthumb__functions.html#a9a63d0b70df4136de64ab0cd351e7ff3">phpthumb_functions::ImageHexColorAllocate</a>($gdimg, <span class="stringliteral">&#39;FFFFFF&#39;</span>, <span class="keyword">false</span>, 127);
                                }
                                $x1 = $text_origin_x + $min_x;
                                $y1 = $text_origin_y + $TTFbox[1];
                                $x2 = $text_origin_x + $min_x + $text_width;
                                $y2 = $text_origin_y + $TTFbox[1] - $text_height;
                                $x_TL = eregi(<span class="charliteral">&#39;x&#39;</span>, $fillextend) ?               0 : min($x1, $x2);
                                $y_TL = eregi(<span class="charliteral">&#39;y&#39;</span>, $fillextend) ?               0 : min($y1, $y2);
                                $x_BR = eregi(<span class="charliteral">&#39;x&#39;</span>, $fillextend) ? ImageSX($gdimg) : max($x1, $x2);
                                $y_BR = eregi(<span class="charliteral">&#39;y&#39;</span>, $fillextend) ? ImageSY($gdimg) : max($y1, $y2);
                                <span class="comment">//while ($y_BR &gt; ImageSY($gdimg)) {</span>
                                <span class="comment">//      $y_TL--;</span>
                                <span class="comment">//      $y_BR--;</span>
                                <span class="comment">//      $text_origin_y--;</span>
                                <span class="comment">//}</span>
                                $this-&gt;<a class="code" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a>(<span class="stringliteral">&#39;WatermarkText() calling ImageFilledRectangle($gdimg, &#39;</span>.$x_TL.<span class="stringliteral">&#39;, &#39;</span>.$y_TL.<span class="stringliteral">&#39;, &#39;</span>.$x_BR.<span class="stringliteral">&#39;, &#39;</span>.$y_BR.<span class="stringliteral">&#39;, $text_color_background)&#39;</span>, __FILE__, __LINE__);
                                ImageFilledRectangle($gdimg, $x_TL, $y_TL, $x_BR, $y_BR, $text_color_background);

                                <span class="comment">// end block for background color only</span>


                                $y_offset = 0;
                                <span class="keywordflow">foreach</span> ($textlines as $dummy =&gt; <a class="code" href="tokenizer__test_8php.html#a52f469b0182d9abac2d0f20548680c9c">$line</a>) {

                                        $TTFboxLine = ImageTTFbBox($size, $angle, $ttffont, <a class="code" href="tokenizer__test_8php.html#a52f469b0182d9abac2d0f20548680c9c">$line</a>);
                                        $min_x_line = min($TTFboxLine[0], $TTFboxLine[2], $TTFboxLine[4], $TTFboxLine[6]);
                                        $max_x_line = max($TTFboxLine[0], $TTFboxLine[2], $TTFboxLine[4], $TTFboxLine[6]);
                                        <span class="comment">//$text_width = round($max_x - $min_x + ($size * 0.5));</span>
                                        $text_width_line = round($max_x_line - $min_x_line);

                                        $min_y_line = min($TTFboxLine[1], $TTFboxLine[3], $TTFboxLine[5], $TTFboxLine[7]);
                                        $max_y_line = max($TTFboxLine[1], $TTFboxLine[3], $TTFboxLine[5], $TTFboxLine[7]);
                                        <span class="comment">//$text_height = round($max_y - $min_y + ($size * 0.5));</span>
                                        $text_height_line = round($max_y_line - $min_y_line);

                                        <span class="keywordflow">switch</span> ($alignment) {
                                                <span class="comment">// $text_origin_y set above, just re-set $text_origin_x here as needed</span>

                                                <span class="keywordflow">case</span> <span class="charliteral">&#39;L&#39;</span>:
                                                <span class="keywordflow">case</span> <span class="stringliteral">&#39;TL&#39;</span>:
                                                <span class="keywordflow">case</span> <span class="stringliteral">&#39;BL&#39;</span>:
                                                        <span class="comment">// no change neccesary</span>
                                                        <span class="keywordflow">break</span>;

                                                <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>:
                                                <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>:
                                                <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>:
                                                        $text_origin_x = ($originOffsetX ? $originOffsetX - round($text_width_line / 2) : round((ImageSX($gdimg) - $text_width_line) / 2));
                                                        <span class="keywordflow">break</span>;

                                                <span class="keywordflow">case</span> <span class="charliteral">&#39;R&#39;</span>:
                                                <span class="keywordflow">case</span> <span class="stringliteral">&#39;TR&#39;</span>:
                                                <span class="keywordflow">case</span> <span class="stringliteral">&#39;BR&#39;</span>:
                                                        $text_origin_x = ($originOffsetX ? $originOffsetX - $text_width_line : ImageSX($gdimg) - $text_width_line  + $TTFbox[0] - $min_x + round($size * 0.25) - $margin);
                                                        <span class="keywordflow">break</span>;
                                        }

                                        <span class="comment">//ImageTTFtext($gdimg, $size, $angle, $text_origin_x, $text_origin_y, $letter_color_text, $ttffont, $text);</span>
                                        $this-&gt;<a class="code" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a>(<span class="stringliteral">&#39;WatermarkText() calling ImageTTFtext($gdimg, &#39;</span>.$size.<span class="stringliteral">&#39;, &#39;</span>.$angle.<span class="stringliteral">&#39;, &#39;</span>.$text_origin_x.<span class="stringliteral">&#39;, &#39;</span>.($text_origin_y + $y_offset).<span class="stringliteral">&#39;, $letter_color_text, &#39;</span>.$ttffont.<span class="stringliteral">&#39;, &#39;</span>.<a class="code" href="tokenizer__test_8php.html#a52f469b0182d9abac2d0f20548680c9c">$line</a>.<span class="charliteral">&#39;)&#39;</span>, __FILE__, __LINE__);
                                        ImageTTFtext($gdimg, $size, $angle, $text_origin_x, $text_origin_y + $y_offset, $letter_color_text, $ttffont, <a class="code" href="tokenizer__test_8php.html#a52f469b0182d9abac2d0f20548680c9c">$line</a>);

                                        $y_offset += $char_height;
                                }

                        }
                        <span class="keywordflow">return</span> <span class="keyword">true</span>;

                } <span class="keywordflow">else</span> {

                        $size = min(5, max(1, $size));
                        $this-&gt;<a class="code" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a>(<span class="stringliteral">&#39;Using built-in font (size=&#39;</span>.$size.<span class="stringliteral">&#39;) for text watermark&#39;</span>.($ttffont ? <span class="stringliteral">&#39; because $ttffont !is_readable(&#39;</span>.$ttffont.<span class="charliteral">&#39;)&#39;</span> : <span class="stringliteral">&#39;&#39;</span>), __FILE__, __LINE__);

                        $text_width  = 0;
                        $text_height = 0;
                        <span class="keywordflow">foreach</span> ($textlines as $dummy =&gt; <a class="code" href="tokenizer__test_8php.html#a52f469b0182d9abac2d0f20548680c9c">$line</a>) {
                                $text_width   = max($text_width, ImageFontWidth($size) * strlen(<a class="code" href="tokenizer__test_8php.html#a52f469b0182d9abac2d0f20548680c9c">$line</a>));
                                $text_height += ImageFontHeight($size);
                        }
                        <span class="keywordflow">if</span> ($img_watermark = <a class="code" href="classphpthumb__functions.html#a02caac9e703a9c106e3fea3a6215130d">phpthumb_functions::ImageCreateFunction</a>($text_width, $text_height)) {
                                ImageAlphaBlending($img_watermark, <span class="keyword">false</span>);
                                <span class="keywordflow">if</span> (<a class="code" href="classphpthumb__functions.html#aa88047663adfed917d5fb0bece3913b8">phpthumb_functions::IsHexColor</a>($bg_color)) {
                                        $text_background_alpha = round(127 * ((100 - min(max(0, $bg_opacity), 100)) / 100));
                                        $text_color_background = <a class="code" href="classphpthumb__functions.html#a9a63d0b70df4136de64ab0cd351e7ff3">phpthumb_functions::ImageHexColorAllocate</a>($img_watermark, $bg_color, <span class="keyword">false</span>, $text_background_alpha);
                                } <span class="keywordflow">else</span> {
                                        $text_color_background = <a class="code" href="classphpthumb__functions.html#a9a63d0b70df4136de64ab0cd351e7ff3">phpthumb_functions::ImageHexColorAllocate</a>($img_watermark, <span class="stringliteral">&#39;FFFFFF&#39;</span>, <span class="keyword">false</span>, 127);
                                }
                                $this-&gt;<a class="code" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a>(<span class="stringliteral">&#39;WatermarkText() calling ImageFilledRectangle($img_watermark, 0, 0, &#39;</span>.ImageSX($img_watermark).<span class="stringliteral">&#39;, &#39;</span>.ImageSY($img_watermark).<span class="stringliteral">&#39;, $text_color_background)&#39;</span>, __FILE__, __LINE__);
                                ImageFilledRectangle($img_watermark, 0, 0, ImageSX($img_watermark), ImageSY($img_watermark), $text_color_background);

                                <span class="keywordflow">if</span> ($angle &amp;&amp; function_exists(<span class="stringliteral">&#39;ImageRotate&#39;</span>)) {
                                        <span class="comment">// using $img_watermark_mask is pointless if ImageRotate function isn&#39;t available</span>
                                        <span class="keywordflow">if</span> ($img_watermark_mask = <a class="code" href="classphpthumb__functions.html#a02caac9e703a9c106e3fea3a6215130d">phpthumb_functions::ImageCreateFunction</a>($text_width, $text_height)) {
                                                $mask_color_background = ImageColorAllocate($img_watermark_mask, 0, 0, 0);
                                                ImageAlphaBlending($img_watermark_mask, <span class="keyword">false</span>);
                                                ImageFilledRectangle($img_watermark_mask, 0, 0, ImageSX($img_watermark_mask), ImageSY($img_watermark_mask), $mask_color_background);
                                                $mask_color_watermark = ImageColorAllocate($img_watermark_mask, 255, 255, 255);
                                        }
                                }

                                $text_color_watermark = <a class="code" href="classphpthumb__functions.html#a9a63d0b70df4136de64ab0cd351e7ff3">phpthumb_functions::ImageHexColorAllocate</a>($img_watermark, $hex_color);
                                <span class="keywordflow">foreach</span> ($textlines as $key =&gt; <a class="code" href="tokenizer__test_8php.html#a52f469b0182d9abac2d0f20548680c9c">$line</a>) {
                                        <span class="keywordflow">switch</span> ($alignment) {
                                                <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>:
                                                        $x_offset = round(($text_width - (ImageFontWidth($size) * strlen(<a class="code" href="tokenizer__test_8php.html#a52f469b0182d9abac2d0f20548680c9c">$line</a>))) / 2);
                                                        $originOffsetX = (ImageSX($gdimg) - ImageSX($img_watermark)) / 2;
                                                        $originOffsetY = (ImageSY($gdimg) - ImageSY($img_watermark)) / 2;
                                                        <span class="keywordflow">break</span>;

                                                <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>:
                                                        $x_offset = round(($text_width - (ImageFontWidth($size) * strlen(<a class="code" href="tokenizer__test_8php.html#a52f469b0182d9abac2d0f20548680c9c">$line</a>))) / 2);
                                                        $originOffsetX = (ImageSX($gdimg) - ImageSX($img_watermark)) / 2;
                                                        $originOffsetY = $margin;
                                                        <span class="keywordflow">break</span>;

                                                <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>:
                                                        $x_offset = round(($text_width - (ImageFontWidth($size) * strlen(<a class="code" href="tokenizer__test_8php.html#a52f469b0182d9abac2d0f20548680c9c">$line</a>))) / 2);
                                                        $originOffsetX = (ImageSX($gdimg) - ImageSX($img_watermark)) / 2;
                                                        $originOffsetY = ImageSY($gdimg) - ImageSY($img_watermark) - $margin;
                                                        <span class="keywordflow">break</span>;

                                                <span class="keywordflow">case</span> <span class="charliteral">&#39;L&#39;</span>:
                                                        $x_offset = 0;
                                                        $originOffsetX = $margin;
                                                        $originOffsetY = (ImageSY($gdimg) - ImageSY($img_watermark)) / 2;
                                                        <span class="keywordflow">break</span>;

                                                <span class="keywordflow">case</span> <span class="stringliteral">&#39;TL&#39;</span>:
                                                        $x_offset = 0;
                                                        $originOffsetX = $margin;
                                                        $originOffsetY = $margin;
                                                        <span class="keywordflow">break</span>;

                                                <span class="keywordflow">case</span> <span class="stringliteral">&#39;BL&#39;</span>:
                                                        $x_offset = 0;
                                                        $originOffsetX = $margin;
                                                        $originOffsetY = ImageSY($gdimg) - ImageSY($img_watermark) - $margin;
                                                        <span class="keywordflow">break</span>;

                                                <span class="keywordflow">case</span> <span class="charliteral">&#39;R&#39;</span>:
                                                        $x_offset = $text_width - (ImageFontWidth($size) * strlen(<a class="code" href="tokenizer__test_8php.html#a52f469b0182d9abac2d0f20548680c9c">$line</a>));
                                                        $originOffsetX = ImageSX($gdimg) - ImageSX($img_watermark) - $margin;
                                                        $originOffsetY = (ImageSY($gdimg) - ImageSY($img_watermark)) / 2;
                                                        <span class="keywordflow">break</span>;

                                                <span class="keywordflow">case</span> <span class="stringliteral">&#39;TR&#39;</span>:
                                                        $x_offset = $text_width - (ImageFontWidth($size) * strlen(<a class="code" href="tokenizer__test_8php.html#a52f469b0182d9abac2d0f20548680c9c">$line</a>));
                                                        $originOffsetX = ImageSX($gdimg) - ImageSX($img_watermark) - $margin;
                                                        $originOffsetY = $margin;
                                                        <span class="keywordflow">break</span>;

                                                <span class="keywordflow">case</span> <span class="stringliteral">&#39;BR&#39;</span>:
                                                <span class="keywordflow">default</span>:
                                                        $x_offset = $text_width - (ImageFontWidth($size) * strlen(<a class="code" href="tokenizer__test_8php.html#a52f469b0182d9abac2d0f20548680c9c">$line</a>));
                                                        $originOffsetX = ImageSX($gdimg) - ImageSX($img_watermark) - $margin;
                                                        $originOffsetY = ImageSY($gdimg) - ImageSY($img_watermark) - $margin;
                                                        <span class="keywordflow">break</span>;
                                        }
                                        $this-&gt;<a class="code" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a>(<span class="stringliteral">&#39;WatermarkText() calling ImageString($img_watermark, &#39;</span>.$size.<span class="stringliteral">&#39;, &#39;</span>.$x_offset.<span class="stringliteral">&#39;, &#39;</span>.($key * ImageFontHeight($size)).<span class="stringliteral">&#39;, &#39;</span>.<a class="code" href="tokenizer__test_8php.html#a52f469b0182d9abac2d0f20548680c9c">$line</a>.<span class="stringliteral">&#39;, $text_color_watermark)&#39;</span>, __FILE__, __LINE__);
                                        ImageString($img_watermark, $size, $x_offset, $key * ImageFontHeight($size), <a class="code" href="tokenizer__test_8php.html#a52f469b0182d9abac2d0f20548680c9c">$line</a>, $text_color_watermark);
                                        <span class="keywordflow">if</span> ($angle &amp;&amp; $img_watermark_mask) {
                                                $this-&gt;<a class="code" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a>(<span class="stringliteral">&#39;WatermarkText() calling ImageString($img_watermark_mask, &#39;</span>.$size.<span class="stringliteral">&#39;, &#39;</span>.$x_offset.<span class="stringliteral">&#39;, &#39;</span>.($key * ImageFontHeight($size)).<span class="stringliteral">&#39;, &#39;</span>.$text.<span class="stringliteral">&#39;, $mask_color_watermark)&#39;</span>, __FILE__, __LINE__);
                                                ImageString($img_watermark_mask, $size, $x_offset, $key * ImageFontHeight($size), $text, $mask_color_watermark);
                                        }
                                }
                                <span class="keywordflow">if</span> ($angle &amp;&amp; $img_watermark_mask) {
                                        $img_watermark      = ImageRotate($img_watermark,      $angle, $text_color_background);
                                        $img_watermark_mask = ImageRotate($img_watermark_mask, $angle, $mask_color_background);
                                        <a class="code" href="classphpthumb__filters.html#a1d26d503a63b41fe2f6d6c6c22c2f977">phpthumb_filters::ApplyMask</a>($img_watermark_mask, $img_watermark);
                                }
                                <span class="comment">//phpthumb_filters::WatermarkOverlay($gdimg, $img_watermark, $alignment, $opacity, $margin);</span>
                                $this-&gt;<a class="code" href="classphpthumb__filters.html#a31094adc61bf77474247fff1bd98319a">DebugMessage</a>(<span class="stringliteral">&#39;WatermarkText() calling phpthumb_filters::WatermarkOverlay($gdimg, $img_watermark, &#39;</span>.($originOffsetX.<span class="charliteral">&#39;x&#39;</span>.$originOffsetY).<span class="stringliteral">&#39;, &#39;</span>.$opacity.<span class="stringliteral">&#39;, 0)&#39;</span>, __FILE__, __LINE__);
                                <a class="code" href="classphpthumb__filters.html#a31079a470f5697b85aad5855f5c614fc">phpthumb_filters::WatermarkOverlay</a>($gdimg, $img_watermark, $originOffsetX.<span class="charliteral">&#39;x&#39;</span>.$originOffsetY, $opacity, 0);
                                ImageDestroy($img_watermark);
                                <span class="keywordflow">return</span> <span class="keyword">true</span>;
                        }

                }
                <span class="keywordflow">return</span> <span class="keyword">false</span>;
        }
</pre></div>
</div>
</div>
<a class="anchor" id="a825ce270b0defc94f2ccb5baa07e7303"></a><!-- doxytag: member="phpthumb_filters::WhiteBalance" ref="a825ce270b0defc94f2ccb5baa07e7303" args="(&amp;$gdimg, $targetColor='')" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphpthumb__filters.html#a825ce270b0defc94f2ccb5baa07e7303">WhiteBalance</a> </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>gdimg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>targetColor</em> = <code>''</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l01054">1054</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>
<div class="fragment"><pre class="fragment">                                                        {
                <span class="keywordflow">if</span> (<a class="code" href="classphpthumb__functions.html#aa88047663adfed917d5fb0bece3913b8">phpthumb_functions::IsHexColor</a>($targetColor)) {
                        $targetPixel = array(
                                <span class="stringliteral">&#39;red&#39;</span>   =&gt; hexdec(substr($targetColor, 0, 2)),
                                <span class="stringliteral">&#39;green&#39;</span> =&gt; hexdec(substr($targetColor, 2, 2)),
                                <span class="stringliteral">&#39;blue&#39;</span>  =&gt; hexdec(substr($targetColor, 4, 2))
                        );
                } <span class="keywordflow">else</span> {
                        $Analysis = <a class="code" href="classphpthumb__filters.html#ada0752b5c2e587088c61e8c18ba21514">phpthumb_filters::HistogramAnalysis</a>($gdimg, <span class="keyword">false</span>);
                        $targetPixel = array(
                                <span class="stringliteral">&#39;red&#39;</span>   =&gt; max(array_keys($Analysis[<span class="stringliteral">&#39;red&#39;</span>])),
                                <span class="stringliteral">&#39;green&#39;</span> =&gt; max(array_keys($Analysis[<span class="stringliteral">&#39;green&#39;</span>])),
                                <span class="stringliteral">&#39;blue&#39;</span>  =&gt; max(array_keys($Analysis[<span class="stringliteral">&#39;blue&#39;</span>]))
                        );
                }
                $grayValue = <a class="code" href="classphpthumb__functions.html#af419a3a071e831a2c4de93b73f3e7063">phpthumb_functions::GrayscaleValue</a>($targetPixel[<span class="stringliteral">&#39;red&#39;</span>], $targetPixel[<span class="stringliteral">&#39;green&#39;</span>], $targetPixel[<span class="stringliteral">&#39;blue&#39;</span>]);
                $scaleR = $grayValue / $targetPixel[<span class="stringliteral">&#39;red&#39;</span>];
                $scaleG = $grayValue / $targetPixel[<span class="stringliteral">&#39;green&#39;</span>];
                $scaleB = $grayValue / $targetPixel[<span class="stringliteral">&#39;blue&#39;</span>];

                <span class="keywordflow">for</span> ($x = 0; $x &lt; ImageSX($gdimg); $x++) {
                        <span class="keywordflow">for</span> ($y = 0; $y &lt; ImageSY($gdimg); $y++) {
                                $currentPixel = <a class="code" href="classphpthumb__functions.html#ac73caf77553f599f9bdb88c03281b33b">phpthumb_functions::GetPixelColor</a>($gdimg, $x, $y);
                                $newColor = <a class="code" href="classphpthumb__functions.html#ab43fe1af0d0c46288c2ffcf3905a7b42">phpthumb_functions::ImageColorAllocateAlphaSafe</a>(
                                        $gdimg,
                                        max(0, min(255, round($currentPixel[<span class="stringliteral">&#39;red&#39;</span>]   * $scaleR))),
                                        max(0, min(255, round($currentPixel[<span class="stringliteral">&#39;green&#39;</span>] * $scaleG))),
                                        max(0, min(255, round($currentPixel[<span class="stringliteral">&#39;blue&#39;</span>]  * $scaleB))),
                                        $currentPixel[<span class="stringliteral">&#39;alpha&#39;</span>]
                                );
                                ImageSetPixel($gdimg, $x, $y, $newColor);
                        }
                }
                <span class="keywordflow">return</span> <span class="keyword">true</span>;
        }
</pre></div>
</div>
</div>
<hr/><h2>Field Documentation</h2>
<a class="anchor" id="ac10166ea697629d5f86fe09b118abd03"></a><!-- doxytag: member="phpthumb_filters::$phpThumbObject" ref="ac10166ea697629d5f86fe09b118abd03" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$phpThumbObject = null</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="phpthumb_8filters_8php_source.html#l00013">13</a> of file <a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>C:/wamp/www/MitosEHR/lib/phpThumbs-1.7.9/<a class="el" href="phpthumb_8filters_8php_source.html">phpthumb.filters.php</a></li>
</ul>
</div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="classphpthumb__filters.html">phpthumb_filters</a>      </li>

    <li class="footer">Generated on Mon Feb 6 2012 00:16:33 for MitosEHR by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>

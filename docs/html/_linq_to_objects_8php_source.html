<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>MitosEHR: C:/wamp/www/MitosEHR/lib/LINQ_040/Classes/PHPLinq/LinqToObjects.php Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="logo_medium.png"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">MitosEHR
   &#160;<span id="projectnumber">Vega v1.0</span>
   </div>
   <div id="projectbrief">Electronic Health Record</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('_linq_to_objects_8php.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">C:/wamp/www/MitosEHR/lib/LINQ_040/Classes/PHPLinq/LinqToObjects.php</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_linq_to_objects_8php.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00030"></a>00030 require_once(<span class="stringliteral">&#39;PHPLinq.php&#39;</span>);
<a name="l00031"></a>00031 
<a name="l00033"></a>00033 require_once(<span class="stringliteral">&#39;PHPLinq/ILinqProvider.php&#39;</span>);
<a name="l00034"></a>00034 
<a name="l00036"></a>00036 require_once(<span class="stringliteral">&#39;PHPLinq/Expression.php&#39;</span>);
<a name="l00037"></a>00037 
<a name="l00039"></a>00039 require_once(<span class="stringliteral">&#39;PHPLinq/OrderByExpression.php&#39;</span>);
<a name="l00040"></a>00040 
<a name="l00042"></a>00042 require_once(<span class="stringliteral">&#39;PHPLinq/Initiator.php&#39;</span>);
<a name="l00043"></a>00043 
<a name="l00045"></a>00045 <a class="code" href="class_p_h_p_linq___initiator.html#ae7a238b507c031f645cf50c96fe978ec">PHPLinq_Initiator::registerProvider</a>(<span class="stringliteral">&#39;PHPLinq_LinqToObjects&#39;</span>);
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 
<a name="l00055"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html">00055</a> <span class="keyword">class </span><a class="code" href="class_p_h_p_linq___linq_to_objects.html">PHPLinq_LinqToObjects</a> <span class="keyword">implements</span> <a class="code" href="interface_p_h_p_linq___i_linq_provider.html">PHPLinq_ILinqProvider</a> {
<a name="l00061"></a>00061         <span class="keyword">private</span> $_from = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00062"></a>00062         
<a name="l00068"></a>00068         <span class="keyword">private</span> $_data = null;
<a name="l00069"></a>00069         
<a name="l00075"></a>00075         <span class="keyword">private</span> $_where = null;
<a name="l00076"></a>00076         
<a name="l00082"></a>00082         <span class="keyword">private</span> $_take = null;
<a name="l00083"></a>00083         
<a name="l00089"></a>00089         <span class="keyword">private</span> $_skip = null;
<a name="l00090"></a>00090         
<a name="l00096"></a>00096         <span class="keyword">private</span> $_takeWhile = null;
<a name="l00097"></a>00097         
<a name="l00103"></a>00103         <span class="keyword">private</span> $_skipWhile = null;
<a name="l00104"></a>00104         
<a name="l00110"></a>00110         <span class="keyword">private</span> $_orderBy = array();
<a name="l00111"></a>00111         
<a name="l00117"></a>00117         <span class="keyword">private</span> $_distinct = null;
<a name="l00118"></a>00118         
<a name="l00124"></a>00124         <span class="keyword">private</span> $_ofType = null;
<a name="l00125"></a>00125         
<a name="l00131"></a>00131         <span class="keyword">private</span> $_parentProvider = null;
<a name="l00132"></a>00132         
<a name="l00138"></a>00138         <span class="keyword">private</span> $_childProviders = array();
<a name="l00139"></a>00139         
<a name="l00145"></a>00145         <span class="keyword">private</span> $_joinCondition = null;
<a name="l00146"></a>00146 
<a name="l00152"></a>00152         <span class="keyword">private</span> $_isDestructing;
<a name="l00153"></a>00153         
<a name="l00160"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#a9cac44c1999a5e76809136f13aa20639">00160</a>         <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#a9cac44c1999a5e76809136f13aa20639">handles</a>($source) {
<a name="l00161"></a>00161                 <span class="keywordflow">return</span> is_array($source);
<a name="l00162"></a>00162         }
<a name="l00163"></a>00163         
<a name="l00171"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#a928a5f42150b4e56d17aef568cfc5422">00171</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#a928a5f42150b4e56d17aef568cfc5422">__construct</a>($name, <a class="code" href="interface_p_h_p_linq___i_linq_provider.html">PHPLinq_ILinqProvider</a> $parentProvider = null) {
<a name="l00172"></a>00172                 $this-&gt;_from = $name;
<a name="l00173"></a>00173                 
<a name="l00174"></a>00174                 <span class="keywordflow">if</span> (!is_null($parentProvider)) {
<a name="l00175"></a>00175                         $this-&gt;_parentProvider = $parentProvider;
<a name="l00176"></a>00176                         $parentProvider-&gt;addChildProvider($this);
<a name="l00177"></a>00177                 }
<a name="l00178"></a>00178                 
<a name="l00179"></a>00179                 <span class="keywordflow">return</span> $this;
<a name="l00180"></a>00180         }
<a name="l00181"></a>00181         
<a name="l00185"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#a421831a265621325e1fdd19aace0c758">00185</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#a421831a265621325e1fdd19aace0c758">__destruct</a>() {
<a name="l00186"></a>00186                 $this-&gt;_isDestructing = <span class="keyword">true</span>;
<a name="l00187"></a>00187 
<a name="l00188"></a>00188                 <span class="keywordflow">if</span> (isset($this-&gt;_parentProvider) &amp;&amp; !is_null($this-&gt;_parentProvider)) {
<a name="l00189"></a>00189                         <span class="keywordflow">if</span> (!$this-&gt;_parentProvider-&gt;__isDestructing()) {
<a name="l00190"></a>00190                                 $this-&gt;_parentProvider-&gt;__destruct();
<a name="l00191"></a>00191                         }
<a name="l00192"></a>00192                         $this-&gt;_parentProvider = null;
<a name="l00193"></a>00193                         unset($this-&gt;_parentProvider);
<a name="l00194"></a>00194                 }
<a name="l00195"></a>00195                 
<a name="l00196"></a>00196                 <span class="keywordflow">if</span> (!is_null($this-&gt;_childProviders)) {
<a name="l00197"></a>00197                         <span class="keywordflow">foreach</span> ($this-&gt;_childProviders as $provider) {
<a name="l00198"></a>00198                                 $provider-&gt;__destruct();
<a name="l00199"></a>00199                                 $provider = null;
<a name="l00200"></a>00200                                 unset($provider);
<a name="l00201"></a>00201                         }
<a name="l00202"></a>00202                 }
<a name="l00203"></a>00203         }
<a name="l00204"></a>00204 
<a name="l00210"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#a506479f6f7a079e71fbdeda02a1a6ab8">00210</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#a506479f6f7a079e71fbdeda02a1a6ab8">__isDestructing</a>() {
<a name="l00211"></a>00211                 <span class="keywordflow">return</span> $this-&gt;_isDestructing;
<a name="l00212"></a>00212         }
<a name="l00213"></a>00213         
<a name="l00219"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#ad0ca423b939b19d85496cf514d1b5bb0">00219</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#ad0ca423b939b19d85496cf514d1b5bb0">getJoinCondition</a>() {
<a name="l00220"></a>00220                 <span class="keywordflow">return</span> $this-&gt;_joinCondition;
<a name="l00221"></a>00221         }
<a name="l00222"></a>00222         
<a name="l00228"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#a798e73787fcde65c17ad338b08f54fe7">00228</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#a798e73787fcde65c17ad338b08f54fe7">addChildProvider</a>(<a class="code" href="interface_p_h_p_linq___i_linq_provider.html">PHPLinq_ILinqProvider</a> $provider) {
<a name="l00229"></a>00229                 $this-&gt;_childProviders[] = $provider;
<a name="l00230"></a>00230         }
<a name="l00231"></a>00231         
<a name="l00237"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#a3c49ca214406f4a6b62da5e775d6fb7a">00237</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#a3c49ca214406f4a6b62da5e775d6fb7a">getFromName</a>() {
<a name="l00238"></a>00238                 <span class="keywordflow">return</span> $this-&gt;_from;
<a name="l00239"></a>00239         }
<a name="l00240"></a>00240         
<a name="l00246"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#a42fdd8313c99d9c5f80219c1e192b93a">00246</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#a42fdd8313c99d9c5f80219c1e192b93a">getSource</a>() {
<a name="l00247"></a>00247                 <span class="keywordflow">return</span> $this-&gt;_data;
<a name="l00248"></a>00248         }
<a name="l00249"></a>00249         
<a name="l00256"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#a91ece07609442e0e388f1115c21f2259">00256</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#a91ece07609442e0e388f1115c21f2259">in</a>($source) {
<a name="l00257"></a>00257                 $this-&gt;_data = $source;
<a name="l00258"></a>00258                 <span class="keywordflow">return</span> $this;
<a name="l00259"></a>00259         }
<a name="l00260"></a>00260         
<a name="l00267"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#ad65fd69a356c5d75610ef1c5c8f9e3b1">00267</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#ad65fd69a356c5d75610ef1c5c8f9e3b1">select</a>($expression = null) {
<a name="l00268"></a>00268                 <span class="comment">// Returnvalue</span>
<a name="l00269"></a>00269                 $returnValue = array();
<a name="l00270"></a>00270                         
<a name="l00271"></a>00271                 <span class="comment">// Expression set?</span>
<a name="l00272"></a>00272                 <span class="keywordflow">if</span> (is_null($expression) || $expression == <span class="stringliteral">&#39;&#39;</span>) {
<a name="l00273"></a>00273                         $expression = $this-&gt;_from . <span class="stringliteral">&#39; =&gt; &#39;</span> . $this-&gt;_from;
<a name="l00274"></a>00274                 }
<a name="l00275"></a>00275 
<a name="l00276"></a>00276                 <span class="comment">// OrderBy set?</span>
<a name="l00277"></a>00277                 <span class="keywordflow">if</span> (is_array($this-&gt;_orderBy) &amp;&amp; <a class="code" href="class_p_h_p_linq___linq_to_objects.html#ac751e87b3d4c4bf2feb03bee8b092755">count</a>($this-&gt;_orderBy) &gt; 0) {
<a name="l00278"></a>00278                         <span class="comment">// Create sorter</span>
<a name="l00279"></a>00279                         $sorter = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00280"></a>00280                         
<a name="l00281"></a>00281                         <span class="comment">// Is there only one OrderBy expression?</span>
<a name="l00282"></a>00282                         <span class="keywordflow">if</span> (<a class="code" href="class_p_h_p_linq___linq_to_objects.html#ac751e87b3d4c4bf2feb03bee8b092755">count</a>($this-&gt;_orderBy) == 1) {
<a name="l00283"></a>00283                                 <span class="comment">// First sorter</span>
<a name="l00284"></a>00284                                 $sorter = $this-&gt;_orderBy[0]-&gt;getFunctionReference();
<a name="l00285"></a>00285                         } <span class="keywordflow">else</span> {
<a name="l00286"></a>00286                                 <span class="comment">// Create OrderBy expression</span>
<a name="l00287"></a>00287                                 $compareCode = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00288"></a>00288                                 
<a name="l00289"></a>00289                                 <span class="comment">// Compile comparer function</span>
<a name="l00290"></a>00290                                 $compareCode = <span class="stringliteral">&quot;</span>
<a name="l00291"></a>00291 <span class="stringliteral">                                        \$result = null;</span>
<a name="l00292"></a>00292 <span class="stringliteral">                                &quot;</span>;
<a name="l00293"></a>00293                                 <span class="keywordflow">for</span> ($i = 0; $i &lt; <a class="code" href="class_p_h_p_linq___linq_to_objects.html#ac751e87b3d4c4bf2feb03bee8b092755">count</a>($this-&gt;_orderBy); $i++) {
<a name="l00294"></a>00294                                         
<a name="l00295"></a>00295                                         $f = substr($this-&gt;_orderBy[$i]-&gt;getFunctionReference(), 1); 
<a name="l00296"></a>00296                                         $compareCode .= <span class="stringliteral">&quot;</span>
<a name="l00297"></a>00297 <span class="stringliteral">                                        \$result = call_user_func_array(chr(0).&#39;$f&#39;, array({$this-&gt;_from}A, {$this-&gt;_from}B));</span>
<a name="l00298"></a>00298 <span class="stringliteral">                                        if (\$result != 0) {</span>
<a name="l00299"></a>00299 <span class="stringliteral">                                                return \$result;</span>
<a name="l00300"></a>00300 <span class="stringliteral">                                        }</span>
<a name="l00301"></a>00301 <span class="stringliteral">                                        &quot;</span>;
<a name="l00302"></a>00302                                         
<a name="l00303"></a>00303                                 }
<a name="l00304"></a>00304                                 $compareCode .= <span class="stringliteral">&quot;return \$result;&quot;</span>;
<a name="l00305"></a>00305                                 $sorter = create_function($this-&gt;_from . <span class="stringliteral">&#39;A, &#39;</span> . $this-&gt;_from . <span class="charliteral">&#39;B&#39;</span>, $compareCode);
<a name="l00306"></a>00306                         }
<a name="l00307"></a>00307                         
<a name="l00308"></a>00308                         <span class="comment">// Sort!</span>
<a name="l00309"></a>00309                         usort($this-&gt;_data, $sorter);
<a name="l00310"></a>00310                 }
<a name="l00311"></a>00311                 
<a name="l00312"></a>00312                 <span class="comment">// Data source</span>
<a name="l00313"></a>00313                 $dataSource = array();
<a name="l00314"></a>00314                 
<a name="l00315"></a>00315                 <span class="comment">// Build possible join data</span>
<a name="l00316"></a>00316                 <span class="keywordflow">foreach</span> ($this-&gt;_data as $value) {
<a name="l00317"></a>00317                         <span class="comment">// Child providers set?</span>
<a name="l00318"></a>00318                         <span class="keywordflow">if</span> (<a class="code" href="class_p_h_p_linq___linq_to_objects.html#ac751e87b3d4c4bf2feb03bee8b092755">count</a>($this-&gt;_childProviders) &gt; 0) {
<a name="l00319"></a>00319                                 <span class="comment">// Data to be joined</span>
<a name="l00320"></a>00320                                 $joinedData = array();
<a name="l00321"></a>00321                                 $joinedData[$this-&gt;_from][] = $value;
<a name="l00322"></a>00322                                                 
<a name="l00323"></a>00323                                 <span class="comment">// Join other values</span>
<a name="l00324"></a>00324                                 <span class="keywordflow">foreach</span> ($this-&gt;_childProviders as $provider) {
<a name="l00325"></a>00325                                         <span class="comment">// Fetch possible join data</span>
<a name="l00326"></a>00326                                         <span class="keywordflow">foreach</span> ($provider-&gt;select() as $record) {
<a name="l00327"></a>00327                                                 $joinValid = $provider-&gt;getJoinCondition()-&gt;execute( array( $this-&gt;_from =&gt; $value, $provider-&gt;getFromName() =&gt; $record ) );
<a name="l00328"></a>00328                                                 <span class="keywordflow">if</span> ($joinValid) {
<a name="l00329"></a>00329                                                         $joinedData[$provider-&gt;getFromName()][] = $record;
<a name="l00330"></a>00330                                                 }
<a name="l00331"></a>00331                                         }
<a name="l00332"></a>00332                                 }
<a name="l00333"></a>00333 
<a name="l00336"></a>00336                                 <span class="comment">// Joinable array</span>
<a name="l00337"></a>00337                                 $joinable = array();
<a name="l00338"></a>00338                                                 
<a name="l00339"></a>00339                                 <span class="comment">// Join data keys</span>
<a name="l00340"></a>00340                                 $joinedDataKeys = array_keys($joinedData);
<a name="l00341"></a>00341                                                 
<a name="l00342"></a>00342                                 <span class="comment">// Calculate expected size of $joinable</span>
<a name="l00343"></a>00343                                 $size = (<a class="code" href="class_p_h_p_linq___linq_to_objects.html#ac751e87b3d4c4bf2feb03bee8b092755">count</a>($joinedData) &gt; 0 ? 1 : 0);
<a name="l00344"></a>00344                                 <span class="keywordflow">foreach</span> ($joinedData as $values) {
<a name="l00345"></a>00345                                         $size = $size * <a class="code" href="class_p_h_p_linq___linq_to_objects.html#ac751e87b3d4c4bf2feb03bee8b092755">count</a>($values);
<a name="l00346"></a>00346                                 }
<a name="l00347"></a>00347                                 
<a name="l00348"></a>00348                                 <span class="comment">// Create cartesian array</span>
<a name="l00349"></a>00349                                 <span class="keywordflow">for</span> ($i = 0; $i &lt; $size; $i++) {
<a name="l00350"></a>00350                                         $joinable[$i] = array();
<a name="l00351"></a>00351                                         
<a name="l00352"></a>00352                                         <span class="keywordflow">for</span> ($j = 0; $j &lt; <a class="code" href="class_p_h_p_linq___linq_to_objects.html#ac751e87b3d4c4bf2feb03bee8b092755">count</a>($joinedData); $j++) {
<a name="l00353"></a>00353                                                 array_push($joinable[$i], current($joinedData[$joinedDataKeys[$j]]));
<a name="l00354"></a>00354                                         }
<a name="l00355"></a>00355                                         
<a name="l00356"></a>00356                                         <span class="comment">// Set cursor on next element in the $joinedData, beginning with the last array</span>
<a name="l00357"></a>00357                                         <span class="keywordflow">for</span> ($j = (<a class="code" href="class_p_h_p_linq___linq_to_objects.html#ac751e87b3d4c4bf2feb03bee8b092755">count</a>($joinedData)-1); $j &gt;= 0; $j--) {
<a name="l00358"></a>00358                                                 <span class="comment">// If next returns true, then break</span>
<a name="l00359"></a>00359                                                 <span class="keywordflow">if</span> (next($joinedData[$joinedDataKeys[$j]])) {
<a name="l00360"></a>00360                                                         <span class="keywordflow">break</span>;
<a name="l00361"></a>00361                                                 } <span class="keywordflow">else</span> {
<a name="l00362"></a>00362                                                         <span class="comment">// If next returns false, then reset and go on with previous $joinedData...</span>
<a name="l00363"></a>00363                                                         reset($joinedData[$joinedDataKeys[$j]]);
<a name="l00364"></a>00364                                                 }
<a name="l00365"></a>00365                                         }
<a name="l00366"></a>00366                                 }
<a name="l00367"></a>00367                                 
<a name="l00370"></a>00370                                 <span class="comment">// Join values using selector expression</span>
<a name="l00371"></a>00371                                 <span class="keywordflow">foreach</span> ($joinable as $values) {
<a name="l00372"></a>00372                                         $dataSource[] = $values;
<a name="l00373"></a>00373                                 }
<a name="l00374"></a>00374                         }
<a name="l00375"></a>00375                 }
<a name="l00376"></a>00376                 
<a name="l00377"></a>00377                 <span class="comment">// Data source filled?</span>
<a name="l00378"></a>00378                 <span class="keywordflow">if</span> (<a class="code" href="class_p_h_p_linq___linq_to_objects.html#ac751e87b3d4c4bf2feb03bee8b092755">count</a>($dataSource) == 0) {
<a name="l00379"></a>00379                         $dataSource = $this-&gt;_data;
<a name="l00380"></a>00380                 }
<a name="l00381"></a>00381 
<a name="l00382"></a>00382                 <span class="comment">// Distinct values storage</span>
<a name="l00383"></a>00383                 $distinctValues = array();
<a name="l00384"></a>00384                 
<a name="l00385"></a>00385                 <span class="comment">// Create selector expression</span>
<a name="l00386"></a>00386                 $selector = <span class="keyword">new</span> <a class="code" href="class_p_h_p_linq___expression.html">PHPLinq_Expression</a>($expression, $this-&gt;_from);
<a name="l00387"></a>00387                 
<a name="l00388"></a>00388                 <span class="comment">// Count elements</span>
<a name="l00389"></a>00389                 $elementCount = 0;
<a name="l00390"></a>00390                 
<a name="l00391"></a>00391                 <span class="comment">// Loop trough data source</span>
<a name="l00392"></a>00392                 <span class="keywordflow">foreach</span> ($dataSource as $value) {
<a name="l00393"></a>00393                         <span class="comment">// Is it a valid element?</span>
<a name="l00394"></a>00394                         $isValid = <span class="keyword">true</span>;
<a name="l00395"></a>00395                         
<a name="l00396"></a>00396                         <span class="comment">// OfType expresion set? Evaluate it!</span>
<a name="l00397"></a>00397                         <span class="keywordflow">if</span> ($isValid &amp;&amp; !is_null($this-&gt;_ofType)) {
<a name="l00398"></a>00398                                 $isValid = $this-&gt;_ofType-&gt;execute($value);
<a name="l00399"></a>00399                         }
<a name="l00400"></a>00400                         
<a name="l00401"></a>00401                         <span class="comment">// Where expresion set? Evaluate it!</span>
<a name="l00402"></a>00402                         <span class="keywordflow">if</span> ($isValid &amp;&amp; !is_null($this-&gt;_where)) {
<a name="l00403"></a>00403                                 $isValid = $this-&gt;_where-&gt;execute($value);
<a name="l00404"></a>00404                         }
<a name="l00405"></a>00405                         
<a name="l00406"></a>00406                         <span class="comment">// Distinct expression set? Evaluate it!</span>
<a name="l00407"></a>00407                         <span class="keywordflow">if</span> ($isValid &amp;&amp; !is_null($this-&gt;_distinct)) {
<a name="l00408"></a>00408                                 $distinctKey = $this-&gt;_distinct-&gt;execute($value);
<a name="l00409"></a>00409                                 <span class="keywordflow">if</span> (isset($distinctValues[$distinctKey])) {
<a name="l00410"></a>00410                                         $isValid = <span class="keyword">false</span>;
<a name="l00411"></a>00411                                 } <span class="keywordflow">else</span> {
<a name="l00412"></a>00412                                         $distinctValues[$distinctKey] = 1; 
<a name="l00413"></a>00413                                 }
<a name="l00414"></a>00414                         }
<a name="l00415"></a>00415                         
<a name="l00416"></a>00416                         <span class="comment">// The element is valid, check if it is our selection range</span>
<a name="l00417"></a>00417                         <span class="keywordflow">if</span> ($isValid) {
<a name="l00418"></a>00418                                         
<a name="l00419"></a>00419                                 <span class="comment">// Skip element?</span>
<a name="l00420"></a>00420                                 <span class="keywordflow">if</span> (!is_null($this-&gt;_skipWhile) &amp;&amp; $this-&gt;_skipWhile-&gt;execute($value)) {
<a name="l00421"></a>00421                                         $isValid = <span class="keyword">false</span>;
<a name="l00422"></a>00422                                 }
<a name="l00423"></a>00423                                 <span class="keywordflow">if</span> (!is_null($this-&gt;_skip) &amp;&amp; $elementCount &lt; $this-&gt;_skip) {
<a name="l00424"></a>00424                                         $isValid = <span class="keyword">false</span>;
<a name="l00425"></a>00425                                 }
<a name="l00426"></a>00426                                 
<a name="l00427"></a>00427                                 <span class="comment">// Take element?</span>
<a name="l00428"></a>00428                                 <span class="keywordflow">if</span> (!is_null($this-&gt;_takeWhile) &amp;&amp; !$this-&gt;_takeWhile-&gt;execute($value)) {
<a name="l00429"></a>00429                                         $isValid = <span class="keyword">false</span>;
<a name="l00430"></a>00430                                         <span class="keywordflow">break</span>;
<a name="l00431"></a>00431                                 }
<a name="l00432"></a>00432                                 <span class="keywordflow">if</span> (!is_null($this-&gt;_take) &amp;&amp; <a class="code" href="class_p_h_p_linq___linq_to_objects.html#ac751e87b3d4c4bf2feb03bee8b092755">count</a>($returnValue) &gt;= $this-&gt;_take) {
<a name="l00433"></a>00433                                         $isValid = <span class="keyword">false</span>;
<a name="l00434"></a>00434                                         <span class="keywordflow">break</span>;
<a name="l00435"></a>00435                                 }
<a name="l00436"></a>00436 
<a name="l00437"></a>00437                                 <span class="comment">// Next element</span>
<a name="l00438"></a>00438                                 $elementCount++;
<a name="l00439"></a>00439 
<a name="l00440"></a>00440                                 <span class="comment">// Add the element to the return value if it is a valid element</span>
<a name="l00441"></a>00441                                 <span class="keywordflow">if</span> ($isValid) {
<a name="l00442"></a>00442                                         $returnValue[] = $selector-&gt;execute($value);
<a name="l00443"></a>00443                                 }
<a name="l00444"></a>00444                         }
<a name="l00445"></a>00445                 }
<a name="l00446"></a>00446                 
<a name="l00447"></a>00447                 <span class="comment">// Return value</span>
<a name="l00448"></a>00448                 <span class="keywordflow">return</span> $returnValue;
<a name="l00449"></a>00449         }
<a name="l00450"></a>00450         
<a name="l00457"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#a59e1acf3496c614274a406aad5f59e99">00457</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#a59e1acf3496c614274a406aad5f59e99">where</a>($expression) {
<a name="l00458"></a>00458                 $this-&gt;_where = !is_null($expression) ? <span class="keyword">new</span> <a class="code" href="class_p_h_p_linq___expression.html">PHPLinq_Expression</a>($expression, $this-&gt;_from) : null;
<a name="l00459"></a>00459                 <span class="keywordflow">return</span> $this;
<a name="l00460"></a>00460         }
<a name="l00461"></a>00461         
<a name="l00468"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#a3962e38f48bc7bfd63ff01815e216ded">00468</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#a3962e38f48bc7bfd63ff01815e216ded">take</a>($n) {
<a name="l00469"></a>00469                 $this-&gt;_take = $n;
<a name="l00470"></a>00470                 <span class="keywordflow">return</span> $this;
<a name="l00471"></a>00471         }
<a name="l00472"></a>00472         
<a name="l00479"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#af2536f10cfe7025b485561e1146e9cd0">00479</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#af2536f10cfe7025b485561e1146e9cd0">skip</a>($n) {
<a name="l00480"></a>00480                 $this-&gt;_skip = $n;
<a name="l00481"></a>00481                 <span class="keywordflow">return</span> $this;
<a name="l00482"></a>00482         }
<a name="l00483"></a>00483         
<a name="l00490"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#a1fc5c97541d4b8666dbc7fb9ea3717a7">00490</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#a1fc5c97541d4b8666dbc7fb9ea3717a7">takeWhile</a>($expression) {
<a name="l00491"></a>00491                 $this-&gt;_takeWhile = !is_null($expression) ? <span class="keyword">new</span> <a class="code" href="class_p_h_p_linq___expression.html">PHPLinq_Expression</a>($expression, $this-&gt;_from) : null;
<a name="l00492"></a>00492                 <span class="keywordflow">return</span> $this;
<a name="l00493"></a>00493         }
<a name="l00494"></a>00494         
<a name="l00501"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#a24ee105087c3674aeebbe5ded87dd389">00501</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#a24ee105087c3674aeebbe5ded87dd389">skipWhile</a>($expression) {
<a name="l00502"></a>00502                 $this-&gt;_skipWhile = !is_null($expression) ? <span class="keyword">new</span> <a class="code" href="class_p_h_p_linq___expression.html">PHPLinq_Expression</a>($expression, $this-&gt;_from) : null;
<a name="l00503"></a>00503                 <span class="keywordflow">return</span> $this;
<a name="l00504"></a>00504         }
<a name="l00505"></a>00505         
<a name="l00513"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#a4da1bd83e986083bb8d34a401e8ebe2c">00513</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#a4da1bd83e986083bb8d34a401e8ebe2c">orderBy</a>($expression, $comparer = null) {
<a name="l00514"></a>00514                 $this-&gt;_orderBy[0] = <span class="keyword">new</span> <a class="code" href="class_p_h_p_linq___order_by_expression.html">PHPLinq_OrderByExpression</a>($expression, $this-&gt;_from, <span class="keyword">false</span>, $comparer);
<a name="l00515"></a>00515                 <span class="keywordflow">return</span> $this;
<a name="l00516"></a>00516         }
<a name="l00517"></a>00517         
<a name="l00525"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#a76ee5b40b6c67d792788c1dc1da2f1cf">00525</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#a76ee5b40b6c67d792788c1dc1da2f1cf">orderByDescending</a>($expression, $comparer = null) {
<a name="l00526"></a>00526                 $this-&gt;_orderBy[0] = <span class="keyword">new</span> <a class="code" href="class_p_h_p_linq___order_by_expression.html">PHPLinq_OrderByExpression</a>($expression, $this-&gt;_from, <span class="keyword">true</span>, $comparer);
<a name="l00527"></a>00527                 <span class="keywordflow">return</span> $this;
<a name="l00528"></a>00528         }
<a name="l00529"></a>00529         
<a name="l00537"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#a05857c194334417f951036f26570c348">00537</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#a05857c194334417f951036f26570c348">thenBy</a>($expression, $comparer = null) {
<a name="l00538"></a>00538                 $this-&gt;_orderBy[] = <span class="keyword">new</span> <a class="code" href="class_p_h_p_linq___order_by_expression.html">PHPLinq_OrderByExpression</a>($expression, $this-&gt;_from, <span class="keyword">false</span>, $comparer);
<a name="l00539"></a>00539                 <span class="keywordflow">return</span> $this;
<a name="l00540"></a>00540         }
<a name="l00541"></a>00541         
<a name="l00549"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#ad98ee4890a9297e3bb1689e340a51597">00549</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#ad98ee4890a9297e3bb1689e340a51597">thenByDescending</a>($expression, $comparer = null) {
<a name="l00550"></a>00550                 $this-&gt;_orderBy[] = <span class="keyword">new</span> <a class="code" href="class_p_h_p_linq___order_by_expression.html">PHPLinq_OrderByExpression</a>($expression, $this-&gt;_from, <span class="keyword">true</span>, $comparer);
<a name="l00551"></a>00551                 <span class="keywordflow">return</span> $this;
<a name="l00552"></a>00552         }
<a name="l00553"></a>00553         
<a name="l00560"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#ad88bb13ea1b971fd2a973334caa4668f">00560</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#ad88bb13ea1b971fd2a973334caa4668f">distinct</a>($expression) {
<a name="l00561"></a>00561                 $this-&gt;_distinct = !is_null($expression) ? <span class="keyword">new</span> <a class="code" href="class_p_h_p_linq___expression.html">PHPLinq_Expression</a>($expression, $this-&gt;_from) : null;
<a name="l00562"></a>00562                 <span class="keywordflow">return</span> $this;
<a name="l00563"></a>00563         }
<a name="l00564"></a>00564         
<a name="l00570"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#a0a2ba7c0fc2611ebdb7af7827adac344">00570</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#a0a2ba7c0fc2611ebdb7af7827adac344">ofType</a>($type) {
<a name="l00571"></a>00571                 <span class="comment">// Create a new expression</span>
<a name="l00572"></a>00572                 $expression = $this-&gt;_from . <span class="stringliteral">&#39; =&gt; &#39;</span>;
<a name="l00573"></a>00573                 
<a name="l00574"></a>00574                 <span class="comment">// Evaluate type</span>
<a name="l00575"></a>00575                 <span class="keywordflow">switch</span> (strtolower($type)) {
<a name="l00576"></a>00576                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;array&#39;</span>:
<a name="l00577"></a>00577                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;bool&#39;</span>:
<a name="l00578"></a>00578                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;double&#39;</span>:
<a name="l00579"></a>00579                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;float&#39;</span>:
<a name="l00580"></a>00580                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;int&#39;</span>:
<a name="l00581"></a>00581                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;integer&#39;</span>:
<a name="l00582"></a>00582                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;long&#39;</span>:
<a name="l00583"></a>00583                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;null&#39;</span>:
<a name="l00584"></a>00584                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;numeric&#39;</span>:
<a name="l00585"></a>00585                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;object&#39;</span>:
<a name="l00586"></a>00586                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;real&#39;</span>:
<a name="l00587"></a>00587                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;scalar&#39;</span>:
<a name="l00588"></a>00588                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;string&#39;</span>:
<a name="l00589"></a>00589                                 $expression .= <span class="stringliteral">&#39;is_&#39;</span> . strtolower($type) . <span class="charliteral">&#39;(&#39;</span> . $this-&gt;_from . <span class="charliteral">&#39;)&#39;</span>;
<a name="l00590"></a>00590                                 <span class="keywordflow">break</span>;
<a name="l00591"></a>00591                         <span class="keywordflow">default</span>:
<a name="l00592"></a>00592                                 $expression .= <span class="stringliteral">&#39;is_a(&#39;</span> . $this-&gt;_from . <span class="stringliteral">&#39;, &quot;&#39;</span> . $type . <span class="stringliteral">&#39;&quot;)&#39;</span>;
<a name="l00593"></a>00593                                 <span class="keywordflow">break</span>;
<a name="l00594"></a>00594                 }
<a name="l00595"></a>00595                 
<a name="l00596"></a>00596                 <span class="comment">// Assign expression</span>
<a name="l00597"></a>00597                 $this-&gt;_ofType = <span class="keyword">new</span> <a class="code" href="class_p_h_p_linq___expression.html">PHPLinq_Expression</a>($expression, $this-&gt;_from);
<a name="l00598"></a>00598                 <span class="keywordflow">return</span> $this;
<a name="l00599"></a>00599         }
<a name="l00600"></a>00600         
<a name="l00607"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#a658a448c5998940e8d7f21a351403439">00607</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#a658a448c5998940e8d7f21a351403439">any</a>($expression) {
<a name="l00608"></a>00608                 $originalWhere = $this-&gt;_where;
<a name="l00609"></a>00609                 
<a name="l00610"></a>00610                 <a class="code" href="_linq_to_objects_201-simple_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> = $this-&gt;<a class="code" href="class_p_h_p_linq___linq_to_objects.html#a59e1acf3496c614274a406aad5f59e99">where</a>($expression)-&gt;select($this-&gt;_from);
<a name="l00611"></a>00611                 
<a name="l00612"></a>00612                 $this-&gt;_where = $originalWhere;
<a name="l00613"></a>00613                 
<a name="l00614"></a>00614                 <span class="keywordflow">return</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#ac751e87b3d4c4bf2feb03bee8b092755">count</a>(<a class="code" href="_linq_to_objects_201-simple_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a>) &gt; 0;
<a name="l00615"></a>00615         }
<a name="l00616"></a>00616         
<a name="l00623"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#a74f8883392f4b48edb0fcd7aa05f3944">00623</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#a74f8883392f4b48edb0fcd7aa05f3944">all</a>($expression) {
<a name="l00624"></a>00624                 $originalWhere = $this-&gt;_where;
<a name="l00625"></a>00625                 
<a name="l00626"></a>00626                 <a class="code" href="_linq_to_objects_201-simple_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> = $this-&gt;<a class="code" href="class_p_h_p_linq___linq_to_objects.html#a59e1acf3496c614274a406aad5f59e99">where</a>($expression)-&gt;select($this-&gt;_from);
<a name="l00627"></a>00627                 
<a name="l00628"></a>00628                 $this-&gt;_where = $originalWhere;
<a name="l00629"></a>00629                 
<a name="l00630"></a>00630                 <span class="keywordflow">return</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#ac751e87b3d4c4bf2feb03bee8b092755">count</a>(<a class="code" href="_linq_to_objects_201-simple_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a>) == <a class="code" href="class_p_h_p_linq___linq_to_objects.html#ac751e87b3d4c4bf2feb03bee8b092755">count</a>($this-&gt;_data);
<a name="l00631"></a>00631         }
<a name="l00632"></a>00632 
<a name="l00639"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#a13c5d8a1f5c3552eea74839799acebab">00639</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#a13c5d8a1f5c3552eea74839799acebab">contains</a>($element) {
<a name="l00640"></a>00640                 <span class="keywordflow">return</span> in_array($element, $this-&gt;_data);
<a name="l00641"></a>00641         }
<a name="l00642"></a>00642         
<a name="l00649"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#a8c53c55a81fa2256fd89655f945059aa">00649</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#a8c53c55a81fa2256fd89655f945059aa">reverse</a>($preserveKeys = null) {
<a name="l00650"></a>00650                 <a class="code" href="administration_2lists_2data_8php.html#a6efc15b5a2314dd4b5aaa556a375c6d6">$data</a> = array_reverse($this-&gt;<a class="code" href="class_p_h_p_linq___linq_to_objects.html#ad65fd69a356c5d75610ef1c5c8f9e3b1">select</a>(), $preserveKeys);
<a name="l00651"></a>00651                 <span class="keywordflow">return</span> <a class="code" href="_p_h_p_linq_8php.html#a52386bd9c23a1b1b61ba20580f40df64">linqfrom</a>($this-&gt;_from)-&gt;in(<a class="code" href="administration_2lists_2data_8php.html#a6efc15b5a2314dd4b5aaa556a375c6d6">$data</a>);
<a name="l00652"></a>00652         }
<a name="l00653"></a>00653         
<a name="l00660"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#aed8dd8dd04c924a6e7c9626f29f537df">00660</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#aed8dd8dd04c924a6e7c9626f29f537df">elementAt</a>($index = null) {
<a name="l00661"></a>00661                 $originalWhere = $this-&gt;_where;
<a name="l00662"></a>00662                 
<a name="l00663"></a>00663                 <a class="code" href="_linq_to_objects_201-simple_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> = isset($this-&gt;_data[$index]) ? $this-&gt;_data[$index] : null;
<a name="l00664"></a>00664                 
<a name="l00665"></a>00665                 $this-&gt;_where = $originalWhere;
<a name="l00666"></a>00666                 
<a name="l00667"></a>00667                 <span class="keywordflow">if</span> (<a class="code" href="class_p_h_p_linq___linq_to_objects.html#ac751e87b3d4c4bf2feb03bee8b092755">count</a>(<a class="code" href="_linq_to_objects_201-simple_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a>) &gt; 0) {
<a name="l00668"></a>00668                         <span class="keywordflow">return</span> array_shift(<a class="code" href="_linq_to_objects_201-simple_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a>);
<a name="l00669"></a>00669                 }
<a name="l00670"></a>00670                 <span class="keywordflow">return</span> null;
<a name="l00671"></a>00671         }
<a name="l00672"></a>00672         
<a name="l00680"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#ada7377d6eff2a6ad171c0616ec6271b8">00680</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#ada7377d6eff2a6ad171c0616ec6271b8">elementAtOrDefault</a>($index = null, $defaultValue = null) {
<a name="l00681"></a>00681                 $returnValue = $this-&gt;<a class="code" href="class_p_h_p_linq___linq_to_objects.html#aed8dd8dd04c924a6e7c9626f29f537df">elementAt</a>($index);
<a name="l00682"></a>00682                 <span class="keywordflow">if</span> (!is_null($returnValue)) {
<a name="l00683"></a>00683                         <span class="keywordflow">return</span> $returnValue;
<a name="l00684"></a>00684                 } <span class="keywordflow">else</span> {
<a name="l00685"></a>00685                         <span class="keywordflow">return</span> $defaultValue;
<a name="l00686"></a>00686                 }
<a name="l00687"></a>00687         }
<a name="l00688"></a>00688         
<a name="l00695"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#a3e57723b96efe016e8a95ff23bfbc82e">00695</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#a3e57723b96efe016e8a95ff23bfbc82e">concat</a>($source) {
<a name="l00696"></a>00696                 <a class="code" href="administration_2lists_2data_8php.html#a6efc15b5a2314dd4b5aaa556a375c6d6">$data</a> = array_merge($this-&gt;<a class="code" href="class_p_h_p_linq___linq_to_objects.html#ad65fd69a356c5d75610ef1c5c8f9e3b1">select</a>(), $source);
<a name="l00697"></a>00697                 <span class="keywordflow">return</span> <a class="code" href="_p_h_p_linq_8php.html#a52386bd9c23a1b1b61ba20580f40df64">linqfrom</a>($this-&gt;_from)-&gt;in(<a class="code" href="administration_2lists_2data_8php.html#a6efc15b5a2314dd4b5aaa556a375c6d6">$data</a>);
<a name="l00698"></a>00698         }
<a name="l00699"></a>00699         
<a name="l00706"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#a9c368dc77913f7cf4268bcaab18f848b">00706</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#a9c368dc77913f7cf4268bcaab18f848b">first</a>($expression = null) {
<a name="l00707"></a>00707                 $linqCommand = clone $this;
<a name="l00708"></a>00708                 <a class="code" href="_linq_to_objects_201-simple_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> = $linqCommand-&gt;skip(0)-&gt;take(1)-&gt;select($expression);
<a name="l00709"></a>00709                 <span class="keywordflow">if</span> (<a class="code" href="class_p_h_p_linq___linq_to_objects.html#ac751e87b3d4c4bf2feb03bee8b092755">count</a>(<a class="code" href="_linq_to_objects_201-simple_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a>) &gt; 0) {
<a name="l00710"></a>00710                         <span class="keywordflow">return</span> array_shift(<a class="code" href="_linq_to_objects_201-simple_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a>);
<a name="l00711"></a>00711                 }
<a name="l00712"></a>00712                 <span class="keywordflow">return</span> null;
<a name="l00713"></a>00713         }
<a name="l00714"></a>00714         
<a name="l00722"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#a970d3424f925820d6d9f0b4e2b1aa52c">00722</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#a970d3424f925820d6d9f0b4e2b1aa52c">firstOrDefault</a> ($expression = null, $defaultValue = null) {
<a name="l00723"></a>00723                 $returnValue = $this-&gt;<a class="code" href="class_p_h_p_linq___linq_to_objects.html#a9c368dc77913f7cf4268bcaab18f848b">first</a>($expression);
<a name="l00724"></a>00724                 <span class="keywordflow">if</span> (!is_null($returnValue)) {
<a name="l00725"></a>00725                         <span class="keywordflow">return</span> $returnValue;
<a name="l00726"></a>00726                 } <span class="keywordflow">else</span> {
<a name="l00727"></a>00727                         <span class="keywordflow">return</span> $defaultValue;
<a name="l00728"></a>00728                 }
<a name="l00729"></a>00729         }
<a name="l00730"></a>00730         
<a name="l00737"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#a473a30c27001f1edc74b1b94f481c8d7">00737</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#a473a30c27001f1edc74b1b94f481c8d7">last</a>($expression = null) {
<a name="l00738"></a>00738                 $linqCommand = clone $this;
<a name="l00739"></a>00739                 <a class="code" href="_linq_to_objects_201-simple_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> = $linqCommand-&gt;reverse()-&gt;skip(0)-&gt;take(1)-&gt;select($expression);
<a name="l00740"></a>00740                 <span class="keywordflow">if</span> (<a class="code" href="class_p_h_p_linq___linq_to_objects.html#ac751e87b3d4c4bf2feb03bee8b092755">count</a>(<a class="code" href="_linq_to_objects_201-simple_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a>) &gt; 0) {
<a name="l00741"></a>00741                         <span class="keywordflow">return</span> array_shift(<a class="code" href="_linq_to_objects_201-simple_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a>);
<a name="l00742"></a>00742                 }
<a name="l00743"></a>00743                 <span class="keywordflow">return</span> null;
<a name="l00744"></a>00744         }
<a name="l00745"></a>00745         
<a name="l00753"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#a87a27c9a37068fdadedb4d026eba831a">00753</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#a87a27c9a37068fdadedb4d026eba831a">lastOrDefault</a> ($expression = null, $defaultValue = null) {
<a name="l00754"></a>00754                 $returnValue = $this-&gt;<a class="code" href="class_p_h_p_linq___linq_to_objects.html#a473a30c27001f1edc74b1b94f481c8d7">last</a>($expression);
<a name="l00755"></a>00755                 <span class="keywordflow">if</span> (!is_null($returnValue)) {
<a name="l00756"></a>00756                         <span class="keywordflow">return</span> $returnValue;
<a name="l00757"></a>00757                 } <span class="keywordflow">else</span> {
<a name="l00758"></a>00758                         <span class="keywordflow">return</span> $defaultValue;
<a name="l00759"></a>00759                 }
<a name="l00760"></a>00760         }
<a name="l00761"></a>00761         
<a name="l00768"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#ab32beb141f7ae12ac580c8c1b0506390">00768</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#ab32beb141f7ae12ac580c8c1b0506390">single</a>($expression = null) {
<a name="l00769"></a>00769                 <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_p_h_p_linq___linq_to_objects.html#a9c368dc77913f7cf4268bcaab18f848b">first</a>($expression);
<a name="l00770"></a>00770         }
<a name="l00771"></a>00771         
<a name="l00779"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#a204daca32909a6031584dcd308be29e0">00779</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#a204daca32909a6031584dcd308be29e0">singleOrDefault</a> ($expression = null, $defaultValue = null) {
<a name="l00780"></a>00780                 <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_p_h_p_linq___linq_to_objects.html#a970d3424f925820d6d9f0b4e2b1aa52c">firstOrDefault</a>($expression, $defaultValue);
<a name="l00781"></a>00781         }
<a name="l00782"></a>00782         
<a name="l00789"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#a1ac24d63648701a6876a2eb91f03900d">00789</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#a1ac24d63648701a6876a2eb91f03900d">join</a>($name) {
<a name="l00790"></a>00790                 <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="class_p_h_p_linq___initiator.html">PHPLinq_Initiator</a>($name, $this);
<a name="l00791"></a>00791         }
<a name="l00792"></a>00792         
<a name="l00799"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#a000230305e785b77bb55704d625d103b">00799</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#a000230305e785b77bb55704d625d103b">on</a>($expression) {
<a name="l00800"></a>00800                 $this-&gt;_joinCondition = <span class="keyword">new</span> <a class="code" href="class_p_h_p_linq___expression.html">PHPLinq_Expression</a>($expression, $this-&gt;_from);
<a name="l00801"></a>00801                 <span class="keywordflow">return</span> $this-&gt;_parentProvider;
<a name="l00802"></a>00802         }
<a name="l00803"></a>00803         
<a name="l00809"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#ac751e87b3d4c4bf2feb03bee8b092755">00809</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#ac751e87b3d4c4bf2feb03bee8b092755">count</a>() {
<a name="l00810"></a>00810                 <span class="keywordflow">return</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#ac751e87b3d4c4bf2feb03bee8b092755">count</a>($this-&gt;_data);
<a name="l00811"></a>00811         }
<a name="l00812"></a>00812         
<a name="l00818"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#adce2d1b0fc342d86c949a3588b78ebe6">00818</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#adce2d1b0fc342d86c949a3588b78ebe6">sum</a>() {
<a name="l00819"></a>00819                 <span class="keywordflow">return</span> array_sum($this-&gt;_data); <span class="comment">// $this-&gt;aggregate(0, &#39;$s, $t =&gt; $s + $t&#39;);</span>
<a name="l00820"></a>00820         }
<a name="l00821"></a>00821         
<a name="l00827"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#a0bb962b33915e2c1a507e95798a453a6">00827</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#a0bb962b33915e2c1a507e95798a453a6">min</a>(){
<a name="l00828"></a>00828                 <span class="keywordflow">return</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#a0bb962b33915e2c1a507e95798a453a6">min</a>($this-&gt;_data);
<a name="l00829"></a>00829         }
<a name="l00830"></a>00830         
<a name="l00836"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#aa53a1564d7748b63ad507d7136c852fb">00836</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#aa53a1564d7748b63ad507d7136c852fb">max</a>(){
<a name="l00837"></a>00837                 <span class="keywordflow">return</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#aa53a1564d7748b63ad507d7136c852fb">max</a>($this-&gt;_data);
<a name="l00838"></a>00838         }
<a name="l00839"></a>00839         
<a name="l00845"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#a8fa5690da6dbfe97e5f2ebfda9dc997f">00845</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#a8fa5690da6dbfe97e5f2ebfda9dc997f">average</a>(){
<a name="l00846"></a>00846                 <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_p_h_p_linq___linq_to_objects.html#adce2d1b0fc342d86c949a3588b78ebe6">sum</a>() / $this-&gt;<a class="code" href="class_p_h_p_linq___linq_to_objects.html#ac751e87b3d4c4bf2feb03bee8b092755">count</a>();
<a name="l00847"></a>00847         }
<a name="l00848"></a>00848 
<a name="l00858"></a><a class="code" href="class_p_h_p_linq___linq_to_objects.html#a6b6ca639b69217bb6d4f12a8a3fcbf44">00858</a>         <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_p_h_p_linq___linq_to_objects.html#a6b6ca639b69217bb6d4f12a8a3fcbf44">aggregate</a>($seed = 0, $expression) {
<a name="l00859"></a>00859                 $codeExpression = <span class="keyword">new</span> <a class="code" href="class_p_h_p_linq___expression.html">PHPLinq_Expression</a>($expression);
<a name="l00860"></a>00860                 
<a name="l00861"></a>00861                 $runningValue = $seed;
<a name="l00862"></a>00862                 <span class="keywordflow">foreach</span> ($this-&gt;_data as $value) {
<a name="l00863"></a>00863                         $runningValue = $codeExpression-&gt;execute( array($runningValue, $value) );
<a name="l00864"></a>00864                 }
<a name="l00865"></a>00865                 
<a name="l00866"></a>00866                 <span class="keywordflow">return</span> $runningValue;
<a name="l00867"></a>00867         }
<a name="l00868"></a>00868 }
</pre></div></div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="_linq_to_objects_8php.html">LinqToObjects.php</a>      </li>

    <li class="footer">Generated on Mon Feb 6 2012 00:16:19 for MitosEHR by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>

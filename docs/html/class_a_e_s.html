<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>MitosEHR: AES Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="logo_medium.png"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">MitosEHR
   &#160;<span id="projectnumber">Vega v1.0</span>
   </div>
   <div id="projectbrief">PHP Classes Documentation</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="classes.html"><span>Data&#160;Structure&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Data&#160;Fields</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('class_a_e_s.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">AES Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="AES" --><table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_e_s.html#a3744d6096dfddc20b27c1ec11c315b58">__construct</a> ($z)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_e_s.html#abbe265eb1d619359ae523ccb7fb440cb">encrypt</a> ($x)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_e_s.html#a5b00d18039aacb6dc47005611535fbf2">decrypt</a> ($y)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_e_s.html#a7e3b27824de2f4121b818757adf411c8">encryptBlock</a> ($x)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_e_s.html#a9cd7afbddff8cb4a079149f75d006542">decryptBlock</a> ($y)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_e_s.html#a421831a265621325e1fdd19aace0c758">__destruct</a> ()</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="_a_e_s_8php_source.html#l00023">23</a> of file <a class="el" href="_a_e_s_8php_source.html">AES.php</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a3744d6096dfddc20b27c1ec11c315b58"></a><!-- doxytag: member="AES::__construct" ref="a3744d6096dfddc20b27c1ec11c315b58" args="($z)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_a_e_s.html#a3744d6096dfddc20b27c1ec11c315b58">__construct</a> </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>z</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>constructs an <a class="el" href="class_a_e_s.html">AES</a> cipher using a specific key. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">$z</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_a_e_s_8php_source.html#l00209">209</a> of file <a class="el" href="_a_e_s_8php_source.html">AES.php</a>.</p>
<div class="fragment"><pre class="fragment">                                    {
       $this-&gt;Nk = strlen($z)/4;
       $this-&gt;Nr = $this-&gt;Nk + self::$Nb + 2;

       <span class="keywordflow">if</span> ($this-&gt;Nk != 4 &amp;&amp; $this-&gt;Nk != 6 &amp;&amp; $this-&gt;Nk != 8)
            die(<span class="stringliteral">&quot;Key is &quot;</span> . ($this-&gt;Nk*32) . <span class="stringliteral">&quot; bits long. *not* 128, 192, or 256.&quot;</span>);

       $this-&gt;Nr = $this-&gt;Nk+self::$Nb+2;
       $this-&gt;w = array(); <span class="comment">// Nb*(Nr+1) 32-bit words</span>
       $this-&gt;s = array(array());  <span class="comment">// 2-D array of Nb colums and 4 rows</span>

       $this-&gt;KeyExpansion($z); <span class="comment">// places expanded key in w</span>
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a421831a265621325e1fdd19aace0c758"></a><!-- doxytag: member="AES::__destruct" ref="a421831a265621325e1fdd19aace0c758" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_a_e_s.html#a421831a265621325e1fdd19aace0c758">__destruct</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_a_e_s_8php_source.html#l00373">373</a> of file <a class="el" href="_a_e_s_8php_source.html">AES.php</a>.</p>
<div class="fragment"><pre class="fragment">                                 {
        unset($this-&gt;w);
        unset($this-&gt;s);
    }
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a5b00d18039aacb6dc47005611535fbf2"></a><!-- doxytag: member="AES::decrypt" ref="a5b00d18039aacb6dc47005611535fbf2" args="($y)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_a_e_s.html#a5b00d18039aacb6dc47005611535fbf2">decrypt</a> </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>y</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Decrypts an aribtrary length String.</p>
<p>Whenever possible you should stream your ciphertext through the <a class="el" href="class_a_e_s.html#a9cd7afbddff8cb4a079149f75d006542">decryptBlock()</a> function directly, as the amount of time required to decrypt is linear to the size of the ciphertext. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">$y</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>string </dd></dl>

<p>Definition at line <a class="el" href="_a_e_s_8php_source.html#l00261">261</a> of file <a class="el" href="_a_e_s_8php_source.html">AES.php</a>.</p>
<div class="fragment"><pre class="fragment">                                {
        $t = <span class="stringliteral">&quot;&quot;</span>; <span class="comment">// 16-byte block</span>
        $x = <span class="stringliteral">&quot;&quot;</span>; <span class="comment">// returned plain text;</span>

        <span class="comment">// put a 16-byte block into t</span>
        $ysize = strlen($y);
        <span class="keywordflow">for</span> ($i=0; $i&lt;$ysize; $i+=16) {
            <span class="keywordflow">for</span> ($j=0; $j&lt;16; $j++) {
                <span class="keywordflow">if</span> (($i+$j)&lt;$ysize)
                        $t[$j] = $y[$i+$j];
                <span class="keywordflow">else</span>
                        $t[$j] = chr(0);
            }
            $x .= $this-&gt;<a class="code" href="class_a_e_s.html#a9cd7afbddff8cb4a079149f75d006542">decryptBlock</a>($t);
        }
        <span class="keywordflow">return</span> $x;
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a9cd7afbddff8cb4a079149f75d006542"></a><!-- doxytag: member="AES::decryptBlock" ref="a9cd7afbddff8cb4a079149f75d006542" args="($y)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_a_e_s.html#a9cd7afbddff8cb4a079149f75d006542">decryptBlock</a> </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>y</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Decrypts the 16-byte cipher text. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">$y</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>string </dd></dl>

<p>Definition at line <a class="el" href="_a_e_s_8php_source.html#l00331">331</a> of file <a class="el" href="_a_e_s_8php_source.html">AES.php</a>.</p>
<div class="fragment"><pre class="fragment">                                     {
        $x = <span class="stringliteral">&quot;&quot;</span>; <span class="comment">// 16-byte string</span>

        <span class="comment">// place input y into the initial state matrix in column order</span>
        <span class="keywordflow">for</span> ($i=0; $i&lt;4*self::$Nb; $i++)
                $this-&gt;s[$i%4][($i-$i%self::$Nb)/self::$Nb] = ord($y[$i]);

        <span class="comment">// add round key</span>
        $this-&gt;addRoundKey($this-&gt;Nr);

        <span class="keywordflow">for</span> ($i=$this-&gt;Nr-1; $i&gt;0; $i--) {
            <span class="comment">// inverse shift rows</span>
            $this-&gt;invShiftRows();

            <span class="comment">// inverse sub bytes</span>
            $this-&gt;invSubBytes();

            <span class="comment">// add round key</span>
            $this-&gt;addRoundKey($i);

            <span class="comment">// inverse mix columns</span>
            $this-&gt;invMixColumns();
        }

        <span class="comment">// inverse shift rows</span>
        $this-&gt;invShiftRows();

        <span class="comment">// inverse sub bytes</span>
        $this-&gt;invSubBytes();

        <span class="comment">// add round key</span>
        $this-&gt;addRoundKey($i);

        <span class="comment">// place state matrix s into x in column order</span>
        <span class="keywordflow">for</span> ($i=0; $i&lt;4*self::$Nb; $i++) {
               <span class="comment">// Used to remove filled null characters.</span>
               $x .= ($this-&gt;s[$i%4][($i-$i%self::$Nb)/self::$Nb] == chr(0) ? <span class="stringliteral">&quot;&quot;</span> : chr($this-&gt;s[$i%4][($i-$i%self::$Nb)/self::$Nb]));
        }

        <span class="keywordflow">return</span> $x;
    }
</pre></div>
</div>
</div>
<a class="anchor" id="abbe265eb1d619359ae523ccb7fb440cb"></a><!-- doxytag: member="AES::encrypt" ref="abbe265eb1d619359ae523ccb7fb440cb" args="($x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_a_e_s.html#abbe265eb1d619359ae523ccb7fb440cb">encrypt</a> </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Encrypts an aribtrary length String.</p>
<p>Whenever possible you should stream your plaintext through the <a class="el" href="class_a_e_s.html#a7e3b27824de2f4121b818757adf411c8">encryptBlock()</a> function directly, as the amount of time required to encrypt is linear to the size of the ciphertext. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">$x</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>string </dd></dl>

<p>Definition at line <a class="el" href="_a_e_s_8php_source.html#l00232">232</a> of file <a class="el" href="_a_e_s_8php_source.html">AES.php</a>.</p>
<div class="fragment"><pre class="fragment">                                {
        $t = <span class="stringliteral">&quot;&quot;</span>; <span class="comment">// 16-byte block</span>
        $y = <span class="stringliteral">&quot;&quot;</span>; <span class="comment">// returned cipher text;</span>

        <span class="comment">// put a 16-byte block into t</span>
        $xsize = strlen($x);
        <span class="keywordflow">for</span> ($i=0; $i&lt;$xsize; $i+=16) {
            <span class="keywordflow">for</span> ($j=0; $j&lt;16; $j++) {
                <span class="keywordflow">if</span> (($i+$j)&lt;$xsize) {
                        $t[$j] = $x[$i+$j];
                }
                <span class="keywordflow">else</span>
                        $t[$j] = chr(0);
            }

            $y .= $this-&gt;<a class="code" href="class_a_e_s.html#a7e3b27824de2f4121b818757adf411c8">encryptBlock</a>($t);
        }
        <span class="keywordflow">return</span> $y;
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a7e3b27824de2f4121b818757adf411c8"></a><!-- doxytag: member="AES::encryptBlock" ref="a7e3b27824de2f4121b818757adf411c8" args="($x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_a_e_s.html#a7e3b27824de2f4121b818757adf411c8">encryptBlock</a> </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Encrypts the 16-byte plain text.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">$x</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>string </dd></dl>

<p>Definition at line <a class="el" href="_a_e_s_8php_source.html#l00285">285</a> of file <a class="el" href="_a_e_s_8php_source.html">AES.php</a>.</p>
<div class="fragment"><pre class="fragment">                                     {
        $y = <span class="stringliteral">&quot;&quot;</span>; <span class="comment">// 16-byte string</span>

        <span class="comment">// place input x into the initial state matrix in column order</span>
        <span class="keywordflow">for</span> ($i=0; $i&lt;4*self::$Nb; $i++) {
            <span class="comment">// we want integerger division for the second index</span>
            $this-&gt;s[$i%4][($i-$i%self::$Nb)/self::$Nb] = ord($x[$i]);
        }

        <span class="comment">// add round key</span>
        $this-&gt;addRoundKey(0);

        <span class="keywordflow">for</span> ($i=1; $i&lt;$this-&gt;Nr; $i++) {
            <span class="comment">// substitute bytes</span>
            $this-&gt;subBytes();

            <span class="comment">// shift rows</span>
            $this-&gt;shiftRows();

            <span class="comment">// mix columns</span>
            $this-&gt;mixColumns();

            <span class="comment">// add round key</span>
            $this-&gt;addRoundKey($i);
        }

        <span class="comment">// substitute bytes</span>
        $this-&gt;subBytes();

        <span class="comment">// shift rows</span>
        $this-&gt;shiftRows();

        <span class="comment">// add round key</span>
        $this-&gt;addRoundKey($i);

        <span class="comment">// place state matrix s into y in column order</span>
        <span class="keywordflow">for</span> ($i=0; $i&lt;4*self::$Nb; $i++)
               $y .= chr($this-&gt;s[$i%4][($i-$i%self::$Nb)/self::$Nb]);
        <span class="keywordflow">return</span> $y;
    }
</pre></div>
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>C:/wamp/www/MitosEHR/classes/<a class="el" href="_a_e_s_8php_source.html">AES.php</a></li>
</ul>
</div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="class_a_e_s.html">AES</a>      </li>

    <li class="footer">Generated on Sun Feb 12 2012 11:59:14 for MitosEHR by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>

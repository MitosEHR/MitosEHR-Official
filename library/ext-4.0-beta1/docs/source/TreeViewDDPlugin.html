<!DOCTYPE html><html><head><title>Sencha Documentation Project</title><link rel="stylesheet" href="../reset.css" type="text/css"><link rel="stylesheet" href="../prettify.css" type="text/css"><link rel="stylesheet" href="../prettify_sa.css" type="text/css"><script type="text/javascript" src="../prettify.js"></script></head><body onload="prettyPrint()"><pre class="prettyprint"><pre><a name="cls-Ext.tree.TreeViewDDPlugin"></a>/**
 * @class Ext.tree.TreeViewDDPlugin
 * @extends Ext.AbstractPlugin
 * &lt;p&gt;This plugin provides drag and/or drop functionality for a TreeView.&lt;/p&gt;
 * &lt;p&gt;It creates a specialized instance of {@link Ext.dd.DragZone DragZone} which knows how to drag out of a {@link Ext.AbstractTreeView TreeView}
 * and loads the data object which is passed to a cooperating {@link Ext.dd.DragZone DragZone}&#39;s methods with the following properties:&lt;ul&gt;
 * &lt;li&gt;copy : Boolean
 *  &lt;div class=&quot;sub-desc&quot;&gt;The value of the TreeView&#39;s &lt;code&gt;copy&lt;/code&gt; property, or &lt;code&gt;true&lt;/code&gt; if the TreeView was configured
 *  with &lt;code&gt;allowCopy: true&lt;/code&gt; &lt;u&gt;and&lt;/u&gt; the control key was pressed when the drag operation was begun.&lt;/div&gt;&lt;/li&gt;
 * &lt;li&gt;view : TreeView
 *  &lt;div class=&quot;sub-desc&quot;&gt;The source TreeView from which the drag originated.&lt;/div&gt;&lt;/li&gt;
 * &lt;li&gt;ddel : HtmlElement
 *  &lt;div class=&quot;sub-desc&quot;&gt;The drag proxy element which moves with the mouse&lt;/div&gt;&lt;/li&gt;
 * &lt;li&gt;item : HtmlElement
 *  &lt;div class=&quot;sub-desc&quot;&gt;The TreeView node upon which the mousedown event was registered.&lt;/div&gt;&lt;/li&gt;
 * &lt;li&gt;records : Array
 *  &lt;div class=&quot;sub-desc&quot;&gt;An Array of {@link Ext.data.Model Model}s representing the selected data being dragged from the source TreeView.&lt;/div&gt;&lt;/li&gt;
 * &lt;/ul&gt;&lt;/p&gt;
 * &lt;p&gt;It also creates a specialized instance of {@link Ext.dd.DropZone} which cooperates with other DropZones which are members of the same
 * ddGroup which processes such data objects.&lt;/p&gt;
 * &lt;p&gt;Adding this plugin to a view means that two new events may be fired from the client TreeView, &lt;code&gt;{@link #event-beforedrop beforedrop}&lt;/code&gt; and
 * &lt;code&gt;{@link #event-drop drop}&lt;/code&gt;&lt;/p&gt;
 */
Ext.define(&#39;Ext.tree.TreeViewDDPlugin&#39;, {
    extend: &#39;Ext.AbstractPlugin&#39;,
    alias: &#39;plugin.treeviewdd&#39;,

    uses: [
        &#39;Ext.tree.TreeViewDragZone&#39;,
        &#39;Ext.tree.TreeViewDropZone&#39;
    ],

    <a name="event-Ext.tree.TreeViewDDPlugin-beforedrop"></a>/**
     * @event beforedrop
     * &lt;p&gt;&lt;b&gt;This event is fired through the TreeView. Add listeners to the TreeView object&lt;/b&gt;&lt;/p&gt;
     * &lt;p&gt;Fired when a drop gesture has been triggered by a mouseup event in a valid drop position in the TreeView.
     * @param {HtmlElement} node The TreeView node &lt;b&gt;if any&lt;/b&gt; over which the mouse was positioned.&lt;/p&gt;
     * &lt;p&gt;Returning &lt;code&gt;false&lt;/code&gt; to this event signals that the drop gesture was invalid, and if the drag proxy
     * will animate back to the point from which the drag began.&lt;/p&gt;
     * &lt;p&gt;Returning &lt;code&gt;0&lt;/code&gt; To this event signals that the data transfer operation should not take place, but
     * that the gesture was valid, and that the repair operation should not take place.&lt;/p&gt;
     * &lt;p&gt;Any other return value continues with the data transfer operation.&lt;/p&gt;
     * @param {Object} data The data object gathered at mousedown time by the cooperating {@link Ext.dd.DragZone DragZone}&#39;s
     * {@link Ext.dd.DragZone#getDragData getDragData} method it contains the following properties:&lt;ul&gt;
     * &lt;li&gt;copy : Boolean
     *  &lt;div class=&quot;sub-desc&quot;&gt;The value of the TreeView&#39;s &lt;code&gt;copy&lt;/code&gt; property, or &lt;code&gt;true&lt;/code&gt; if the TreeView was configured
     *  with &lt;code&gt;allowCopy: true&lt;/code&gt; and the control key was pressed when the drag operation was begun&lt;/div&gt;&lt;/li&gt;
     * &lt;li&gt;view : TreeView
     *  &lt;div class=&quot;sub-desc&quot;&gt;The source TreeView from which the drag originated.&lt;/div&gt;&lt;/li&gt;
     * &lt;li&gt;ddel : HtmlElement
     *  &lt;div class=&quot;sub-desc&quot;&gt;The drag proxy element which moves with the mouse&lt;/div&gt;&lt;/li&gt;
     * &lt;li&gt;item : HtmlElement
     *  &lt;div class=&quot;sub-desc&quot;&gt;The TreeView node upon which the mousedown event was registered.&lt;/div&gt;&lt;/li&gt;
     * &lt;li&gt;records : Array
     *  &lt;div class=&quot;sub-desc&quot;&gt;An Array of {@link Ext.data.Model Model}s representing the selected data being dragged from the source TreeView.&lt;/div&gt;&lt;/li&gt;
     * &lt;/ul&gt;
     * @param {Ext.data.Model} overModel The Model over which the drop gesture took place.
     * @param {String} dropPosition &lt;code&gt;&quot;before&quot;&lt;/code&gt;, &lt;code&gt;&quot;after&quot;&lt;/code&gt; or &lt;code&gt;&quot;append&quot;&lt;/code&gt; depending on whether the mouse is above or below the midline of the node,
     * or the node is a branch node which accepts new child nodes.
     * @param {Function} dropFunction &lt;p&gt;A function to call to complete the data transfer operation and either move or copy Model instances from the source
     * View&#39;s Store to the destination View&#39;s Store.&lt;/p&gt;
     * &lt;p&gt;This is useful when you want to perform some kind of asynchronous processing before confirming
     * the drop, such as an {@link Ext.Msg#confirm confirm} call, or an Ajax request.&lt;/p&gt;
     * &lt;p&gt;Return &lt;code&gt;0&lt;/code&gt; from this event handler, and call the &lt;code&gt;dropFunction&lt;/code&gt; at any time to perform the data transfer.&lt;/p&gt;
     */

    <a name="event-Ext.tree.TreeViewDDPlugin-drop"></a>/**
     * @event drop
     * &lt;b&gt;This event is fired through the TreeView. Add listeners to the TreeView object&lt;/b&gt;
     * Fired when a drop operation has been completed and the data has been moved or copied.
     * @param {HtmlElement} node The TreeView node &lt;b&gt;if any&lt;/b&gt; over which the mouse was positioned.
     * @param {Object} data The data object gathered at mousedown time by the cooperating {@link Ext.dd.DragZone DragZone}&#39;s
     * {@link Ext.dd.DragZone#getDragData getDragData} method it contains the following properties:&lt;ul&gt;
     * &lt;li&gt;copy : Boolean
     *  &lt;div class=&quot;sub-desc&quot;&gt;The value of the TreeView&#39;s &lt;code&gt;copy&lt;/code&gt; property, or &lt;code&gt;true&lt;/code&gt; if the TreeView was configured
     *  with &lt;code&gt;allowCopy: true&lt;/code&gt; and the control key was pressed when the drag operation was begun&lt;/div&gt;&lt;/li&gt;
     * &lt;li&gt;view : TreeView
     *  &lt;div class=&quot;sub-desc&quot;&gt;The source TreeView from which the drag originated.&lt;/div&gt;&lt;/li&gt;
     * &lt;li&gt;ddel : HtmlElement
     *  &lt;div class=&quot;sub-desc&quot;&gt;The drag proxy element which moves with the mouse&lt;/div&gt;&lt;/li&gt;
     * &lt;li&gt;item : HtmlElement
     *  &lt;div class=&quot;sub-desc&quot;&gt;The TreeView node upon which the mousedown event was registered.&lt;/div&gt;&lt;/li&gt;
     * &lt;li&gt;records : Array
     *  &lt;div class=&quot;sub-desc&quot;&gt;An Array of {@link Ext.data.Model Model}s representing the selected data being dragged from the source TreeView.&lt;/div&gt;&lt;/li&gt;
     * &lt;/ul&gt;
     * @param {Ext.data.Model} overModel The Model over which the drop gesture took place.
     * @param {String} dropPosition &lt;code&gt;&quot;before&quot;&lt;/code&gt;, &lt;code&gt;&quot;after&quot;&lt;/code&gt; or &lt;code&gt;&quot;append&quot;&lt;/code&gt; depending on whether the mouse is above or below the midline of the node,
     * or the node is a branch node which accepts new child nodes.
     */

    dragText : &#39;{0} selected node{1}&#39;,

    <a name="cfg-Ext.tree.TreeViewDDPlugin-allowParentInsert"></a>/**
     * @cfg {Boolean} allowParentInsert
     * Allow inserting a dragged node between an expanded parent node and its first child that will become a
     * sibling of the parent when dropped (defaults to false)
     */
    allowParentInserts: false,

    <a name="cfg-Ext.tree.TreeViewDDPlugin-allowContainerDrop"></a>/**
     * @cfg {String} allowContainerDrop
     * True if drops on the tree container (outside of a specific tree node) are allowed (defaults to false)
     */
    allowContainerDrops: false,

    <a name="cfg-Ext.tree.TreeViewDDPlugin-appendOnly"></a>/**
     * @cfg {String} appendOnly
     * True if the tree should only allow append drops (use for trees which are sorted, defaults to false)
     */
    appendOnly: false,

    <a name="cfg-Ext.tree.TreeViewDDPlugin-ddGroup"></a>/**
     * @cfg {String} ddGroup
     * A named drag drop group to which this object belongs.  If a group is specified, then both the DragZones and DropZone
     * used by this plugin will only interact with other drag drop objects in the same group (defaults to &#39;TreeDD&#39;).
     */
    ddGroup : &quot;TreeDD&quot;,

    <a name="cfg-Ext.tree.TreeViewDDPlugin-dragGroup"></a>/**
     * @cfg {String} dragGroup
     * &lt;p&gt;The ddGroup to which the DragZone will belong.&lt;/p&gt;
     * &lt;p&gt;This defines which other DropZones the DragZone will interact with. Drag/DropZones only interact with other Drag/DropZones
     * which are members of the same ddGroup.&lt;/p&gt;
     */

    <a name="cfg-Ext.tree.TreeViewDDPlugin-dropGroup"></a>/**
     * @cfg {String} dropGroup
     * &lt;p&gt;The ddGroup to which the DropZone will belong.&lt;/p&gt;
     * &lt;p&gt;This defines which other DragZones the DropZone will interact with. Drag/DropZones only interact with other Drag/DropZones
     * which are members of the same ddGroup.&lt;/p&gt;
     */

    <a name="cfg-Ext.tree.TreeViewDDPlugin-expandDelay"></a>/**
     * @cfg {String} expandDelay
     * The delay in milliseconds to wait before expanding a target tree node while dragging a droppable node
     * over the target (defaults to 1000)
     */
    expandDelay : 1000,

    <a name="cfg-Ext.tree.TreeViewDDPlugin-enableDrop"></a>/**
     * @cfg {Boolean} enableDrop
     * &lt;p&gt;Defaults to &lt;code&gt;true&lt;/code&gt;&lt;/p&gt;
     * &lt;p&gt;Set to &lt;code&gt;false&lt;/code&gt; to disallow the View from accepting drop gestures&lt;/p&gt;
     */
    enableDrop: true,

    <a name="cfg-Ext.tree.TreeViewDDPlugin-enableDrag"></a>/**
     * @cfg {Boolean} enableDrag
     * &lt;p&gt;Defaults to &lt;code&gt;true&lt;/code&gt;&lt;/p&gt;
     * &lt;p&gt;Set to &lt;code&gt;false&lt;/code&gt; to disallow dragging items from the View &lt;/p&gt;
     */
    enableDrag: true,

    init : function(view) {
        view.on(&#39;render&#39;, this.onViewRender, this, {single: true});
    },

    onViewRender : function(view) {
        var me = this;

        if (me.enableDrag) {
            me.dragZone = Ext.create(&#39;Ext.tree.TreeViewDragZone&#39;, {
                view: view,
                ddGroup: me.dragGroup || me.ddGroup,
                dragText: me.dragText
            });
        }

        if (me.enableDrop) {
            me.dropZone = Ext.create(&#39;Ext.tree.TreeViewDropZone&#39;, {
                view: view,
                ddGroup: me.dropGroup || me.ddGroup,
                allowContainerDrops: me.allowContainerDrops,
                appendOnly: me.appendOnly,
                allowParentInserts: me.allowParentInserts,
                expandDelay: me.expandDelay
            });
        }
    }
});ï¿¿</pre></pre></body></html>